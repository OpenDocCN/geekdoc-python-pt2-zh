<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="headerappb01" class="chapter" epub:type="appendix" id="appb" role="doc-appendix">
<header id="headerappb01">
<h1 class="cn"><span aria-label=" Page 399. " class="page" epub:type="pagebreak" id="p399" role="doc-pagebreak"/><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rappb">B</a></h1>
<h1 class="ctbm">Raspberry Pi Setup</h1>
</header>
<figure class="figure">
<p class="fig"><img alt="" height="100" src="images/nsp-venkitachalam503045-circle-image.jpg" width="100"/></p>
</figure>
<p class="pf">This appendix covers setting up a Raspberry Pi so you can use it for the projects in <a class="xref" href="nsp-venkitachalam503045-0028.xhtml#ch13">Chapters 13</a>, <a class="xref" href="nsp-venkitachalam503045-0029.xhtml#ch14">14</a>, and <a class="xref" href="nsp-venkitachalam503045-0030.xhtml#ch15">15</a>. The projects work with a Raspberry Pi 3 Model B+ or Raspberry Pi 4 Model B. The setup instructions are the same for both. In addition to the board, you’ll need a compatible power supply and a micro SD card with a 16GB capacity or higher.</p>
<section>
<h2 class="ah" id="ah1901"><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rah1901"><span class="idx" data-level1="setting up" data-term="Raspberry Pi"/>Setting Up the Software</a></h2>
<p class="paft">There are several ways to set up your Pi. These steps outline one of the simplest methods, using Raspberry Pi Imager:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Download the <span class="idx" data-term="Raspberry Pi Imager"/>Raspberry Pi Imager from the Raspberry Pi website at <a class="url-i" href="https://www.raspberrypi.com/software/">https://www.raspberrypi.com/software</a>.</li>
<li class="nl"><span aria-label=" Page 400. " class="page" epub:type="pagebreak" id="p400" role="doc-pagebreak"/>2. Insert your SD card into your computer. (Depending on your system, you may need a micro SD card adapter for this.)</li>
<li class="nl">3. Open Pi Imager and click the <b>Choose OS</b> button. <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb001">Figure B-1</a> shows the resulting dialog.
            <figure class="figure" id="fb001">
<p class="fig"><img alt="" height="593" src="images/nsp-venkitachalam503045-fb001.jpg" style="width:95%; height:auto;" width="915"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure B-1:</span> The Choose OS dialog in Raspberry Pi Imager</p>
</figcaption>
</figure>
</li>
<li class="nl">4. Click the <b>Raspberry Pi OS</b> option.</li>
<li class="nl">5. Click the <b>Choose Storage</b> button. You should get a screen like the one in <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb002">Figure B-2</a>.
            <figure class="figure" id="fb002">
<p class="fig"><img alt="" height="592" src="images/nsp-venkitachalam503045-fb002.jpg" style="width:95%; height:auto;" width="912"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure B-2:</span> The Choose Storage dialog in Raspberry Pi Imager</p>
</figcaption>
</figure>
</li>
<li class="nl">6. The screen should list your SD card. Click it.</li>
<li class="nl">7. Click the gear icon to open the Advanced Options dialog, as shown in <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb003">Figure B-3</a>.
            <figure class="figure" id="fb003">
<p class="fig"><span aria-label=" Page 401. " class="page" epub:type="pagebreak" id="p401" role="doc-pagebreak"/><img alt="" height="596" src="images/nsp-venkitachalam503045-fb003.jpg" style="width:95%; height:auto;" width="912"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure B-3:</span> The Advanced Options dialog in Raspberry Pi Imager</p>
</figcaption>
</figure>
</li>
<li class="nl">8. Enter a name for your Pi in the Set <span class="idx" data-level1="hostname" data-term="Raspberry Pi"/>Hostname box. I’ve set the name to <code>audioml</code> in <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb003">Figure B-3</a>. Thanks to a service called Avahi that’s enabled on the Raspberry Pi OS installation by default, you’ll be able to reach your Pi over the <span class="idx" data-level1="local" data-term="Raspberry Pi"/>local network by appending <code>.local</code> to the device name you choose—for example, <code>audioml.local</code>. This is much more convenient than remembering and using an IP address.</li>
<li class="nl">9. In the same dialog, set your username and password, and enable SSH. Then scroll down to see the Wi-Fi connection options, as shown in <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb004">Figure B-4</a>.
            <figure class="figure" id="fb004">
<p class="fig"><img alt="" height="592" src="images/nsp-venkitachalam503045-fb004.jpg" style="width:95%; height:auto;" width="912"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure B-4:</span> The Wi-Fi details in Raspberry Pi Imager</p>
</figcaption>
</figure>
</li>
<li class="nl">10. Enter your Wi-Fi details, similar to what’s shown in <a class="xref" href="nsp-venkitachalam503045-0032.xhtml#fb004">Figure B-4</a>. Once you’re done, click <b>Save</b>, and then click the <b>Write</b> button to write all this information to your SD card.</li>
<li class="nll">11. When the SD card is ready, insert it into your Pi. Then boot up your Pi and it will automatically connect to your Wi-Fi network.</li>
</ol>
<p><span aria-label=" Page 402. " class="page" epub:type="pagebreak" id="p402" role="doc-pagebreak"/>Now you should be able to log in to your Pi remotely using Secure Shell (SSH), as we’ll discuss soon.</p>
</section>
<section>
<h2 class="ah" id="ah1902"><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rah1902">Testing Your Connection</a></h2>
<p class="paft">To check whether your Pi is connected to the local network, enter <span class="idx" data-level1="ping" data-term="Raspberry Pi"/><code class="b">ping</code> at the command line on your computer, followed by your Pi’s device name. For example, here’s what a <code>ping</code> session looks like from a Windows command shell:</p>
<div class="codeline">
<p class="clf">$ <code class="b">ping audioml.local</code></p>
<p class="clf">Pinging audioml.local [fe80::e3e0:1223:9b20:2d6f%6] with 32 bytes of data:</p>
<p class="cl">Reply from fe80::e3e0:1223:9b20:2d6f%6: time=66ms</p>
<p class="cl">Reply from fe80::e3e0:1223:9b20:2d6f%6: time=3ms</p>
<p class="cl">Reply from fe80::e3e0:1223:9b20:2d6f%6: time=2ms</p>
<p class="cl">Reply from fe80::e3e0:1223:9b20:2d6f%6: time=3ms</p>
<p class="clf">Ping statistics for fe80::e3e0:1223:9b20:2d6f%6:</p>
<p class="cl">    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),</p>
<p class="cl">Approximate round trip times in milli-seconds:</p>
<p class="cll">    Minimum = 2ms, Maximum = 66ms, Average = 18ms</p>
</div>
<p>This <code>ping</code> output shows the number of bytes sent and the time it took to get a reply. If you see the message <code>Request timeout...</code> instead, then you know your Pi isn’t connected to the network. In this case, try searching the internet for troubleshooting strategies. On a Windows computer, for example, you might try opening a command prompt as an administrator and entering the <code class="b">arp -d</code> command. This clears the ARP cache. (ARP is a protocol for detecting other computers over a network.) Then try the <code>ping</code> command again. If that fails, it might be a good idea to hook up a monitor and keyboard to your Pi to check if it’s really able to connect to the internet.</p>
</section>
<section>
<h2 class="ah" id="ah1903"><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rah1903"><span class="idx" data-level1="logging in with SSH" data-term="Raspberry Pi"/>Logging in to Your Pi with SSH</a></h2>
<p class="paft">You can hook up a keyboard, mouse, and monitor to your Pi to work with it directly, but for the purposes of this book, the most convenient way to work is to use <span class="idx" data-term="SSH"/>SSH to log in to your Pi remotely from your desktop or laptop computer. If you do this not only frequently but also from the same computer, you’ll probably find it annoying to enter the password every single time. With the <span class="idx" data-term="ssh-keygen"/><code>ssh-keygen</code> utility that comes with SSH, you can set up a <span class="idx" data-term="public/private key"/>public/private key scheme so you can securely log in to your Pi without entering the password. For macOS and Linux users, follow the next procedure. (For Windows users, <span class="idx" data-term="PuTTY"/>PuTTY lets you do something similar. Search for “Generating an SSH key with PuTTY” to learn more.)</p>
<ol style="list-style-type:none">
<li class="nlf"><span aria-label=" Page 403. " class="page" epub:type="pagebreak" id="p403" role="doc-pagebreak"/>1. From a terminal on your computer, enter the following to generate a key file:</li>
</ol>
<div class="codeline">
<p class="cl3f">$ <code class="b">ssh-keygen</code></p>
<p class="cl3">Generating public/private rsa key pair.</p>
<p class="cl3">Enter file in which to save the key (/Users/<code class="i">xxx</code>/.ssh/id_rsa):</p>
<p class="cl3">Enter passphrase (empty for no passphrase):</p>
<p class="cl3">Enter same passphrase again:</p>
<p class="cl3">Your identification has been saved in /Users/<code class="i">xxx</code>/.ssh/id_rsa.</p>
<p class="cl3">Your public key has been saved in /Users/<code class="i">xxx</code>/.ssh/id_rsa.pub.</p>
<p class="cl3">The key fingerprint is:</p>
<p class="cl3l">--<code class="i">snip</code>--</p>
</div>
<ol style="list-style-type:none">
<li class="nl">2. Copy the key file to the Pi. You can use the <span class="idx" data-level1="scp" data-term="Raspberry Pi"/><code>scp</code> command for this, which is part of SSH. Enter the following, replacing your Pi’s IP address as appropriate:</li>
</ol>
<div class="codeline">
<p class="cl3f">$ <code class="b">scp ~/.ssh/id_rsa.pub pi@</code><code class="bi">192.168.4.32</code><code class="b">:.ssh/</code></p>
<p class="cl3">The authenticity of host '192.168.4.32 (192.168.4.32)' can't</p>
<p class="cl3">be established.</p>
<p class="cl3">RSA key fingerprint is f1:ab:07:e7:dc:2e:f1:37:1b:6f:9b:66:85:2a:33:a7.</p>
<p class="cl3">Are you sure you want to continue connecting (yes/no)? <code class="b">yes</code></p>
<p class="cl3">Warning: Permanently added '192.168.4.32' (RSA) to the list of</p>
<p class="cl3">known hosts.</p>
<p class="cl3">pi@192.168.4.32's password:</p>
<p class="cl3l">id_rsa.pub                                   100%  398     0.4KB/s   00:00</p>
</div>
<ol style="list-style-type:none">
<li class="nl">3. Log in to the Pi and verify the key file was copied over, again substituting your Pi’s IP address:</li>
</ol>
<div class="codeline">
<p class="cl3f">$ <code class="b">ssh pi@</code><code class="bi">192.168.4.32</code></p>
<p class="cl3">pi@192.168.4.32's password:</p>
<p class="cl3f">$ <code class="b">cd .ssh</code></p>
<p class="cl3">$ <code class="b">ls</code></p>
<p class="cl3">id_rsa.pub  known_hosts</p>
<p class="cl3f">$ <code class="b">cat id_rsa.pub &gt;&gt; authorized_keys</code></p>
<p class="cl3">$ <code class="b">ls</code></p>
<p class="cl3">authorized_keys  id_rsa.pub  known_hosts</p>
<p class="cl3l">$ <code class="b">logout</code></p>
</div>
<p>The next time you log in to the Pi, you won’t be asked for a password. Also, note that I used an empty passphrase in <code>ssh-keygen</code> in this example, which isn’t secure. This setup may be fine for Raspberry Pi hardware projects in which you aren’t very concerned about security, but you may want to consider using a passphrase.</p>
</section>
<section>
<h2 class="ah" id="ah1904"><span aria-label=" Page 404. " class="page" epub:type="pagebreak" id="p404" role="doc-pagebreak"/><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rah1904"><span class="idx" data-level1="installing Python modules" data-term="Raspberry Pi"/>Installing Python Modules</a></h2>
<p class="paft">Most of the Python modules you need for the projects in <a class="xref" href="nsp-venkitachalam503045-0028.xhtml#ch13">Chapters 13</a>, <a class="xref" href="nsp-venkitachalam503045-0029.xhtml#ch14">14</a>, and <a class="xref" href="nsp-venkitachalam503045-0030.xhtml#ch15">15</a> are already part of the Raspberry Pi installation. For the rest, install them by running the following commands one by one after you SSH into your Pi:</p>
<div class="codeline">
<p class="clf">$ <code class="b">sudo pip3 install bottle</code></p>
<p class="cl">$ <code class="b">sudo apt install python3-matplotlib</code></p>
<p class="cl">$ <code class="b">sudo apt-get install python3-scipy</code></p>
<p class="cl">$ <code class="b">sudo apt-get install python3-pyaudio</code></p>
<p class="cll">$ <code class="b">sudo pip3 install tflite-runtime</code></p>
</div>
<p>This should get you going with all the projects that use the Raspberry Pi in the book.</p>
</section>
<section>
<h2 class="ah" id="ah1905"><a class="xref" href="nsp-venkitachalam503045-0008.xhtml#rah1905"><span class="idx" data-level1="Visual Studio Code" data-term="Raspberry Pi"/>Working Remotely with Visual Studio Code</a></h2>
<p class="paft">Once you have SSH access to your Pi, you could edit your source code on your computer and transfer it to the Pi via the <code>scp</code> command, but this gets cumbersome quickly. There’s a better way. Visual Studio Code (VS Code) is a popular code editor from Microsoft. This software supports a huge number of plug-ins or extensions to enhance its capabilities. One of them, the Visual Studio Code Remote - SSH extension, will let you connect to your Pi and edit your files directly from your computer. You can find the installation details for this extension at <a class="url-i" href="https://code.visualstudio.com/docs/remote/ssh">https://code.visualstudio.com/docs/remote/ssh</a>.</p>
</section>
</section>
</div></body></html>