<html><head></head><body>
<h2 class="h2" id="intro"><span epub:type="pagebreak" id="page_1"/>INTRODUCTION</h2>
<div class="image1"><img src="../images/common01.jpg" alt="image"/></div>
<p class="noindent">Air is running out. There’s a leak in the space station, so you’ve got to act fast. Can you find your way to safety? You’ll need to navigate your way around the space station, find access cards to unlock doors, and fix your damaged space suit. The adventure has begun!</p>
<p class="indent">And it starts here: on Earth, at mission command, also known as your computer. This book shows you how to use Python to build a space station on Mars, explore the station, and escape danger in an adventure game complete with graphics. Can you think like an astronaut to make it to safety?</p>
<h3 class="h3" id="lev1"><strong>HOW TO USE THIS BOOK</strong></h3>
<p class="noindent">By following the instructions in this book, you can build a game called <em>Escape</em> with a map to explore and puzzles to solve. It’s written in Python, a popular programming language that is easy to read. It also uses Pygame Zero, which adds some instructions for managing images and sounds, among other things. Bit by bit, I’ll show you how to make the game and how the main <span epub:type="pagebreak" id="page_2"/>parts of the code work, so you can customize it or build your own games based on my game code. You can also download all the code you need. If you get stuck or just want to jump straight into playing the game and seeing it work, you can do so. All the software you need is free, and I’ve provided instructions for Windows PCs and the Raspberry Pi. I recommend you use the Raspberry Pi 3 or Raspberry Pi 2. The game may run too slowly to enjoy on the Pi Zero, original Model B+, and older models.</p>
<p class="indent">There are several different ways you can use the book and the game:</p>
<ul>
<li class="noindent"><strong>Download the game, play it first, and then use the book to understand how it works.</strong> This way, you eliminate the risk of seeing any spoilers in the book before you play the game! Although I’ve kept them to a minimum, you might notice a few clues in the code as you read the book. If you get really stuck on a problem in the game, you can try reading the code to work out the solution. In any case, I recommend you run the game at least once to see what you’ll be building and learn how to run your programs.</li>
<li class="noindent"><strong>Build the game, and then play it.</strong> This book guides you through creating the game from start to finish. As you work your way through the chapters, you’ll add new sections to the game and see how they work. If you can’t get the code working at any point, you can just use my version of the code listing and continue building from there. If you choose this route, avoid making any custom changes to the game until you’ve built it, played it, and finished it. Otherwise, you might accidentally make the game impossible to complete. (It’s okay to make any changes I suggest in the exercises.)</li>
<li class="noindent"><strong>Customize the game.</strong> When you understand how the program works, you can change it by using your own maps, graphics, objects, and puzzles. The <em>Escape</em> game is set on a space station, but yours could be in the jungle, under the sea, or almost anywhere. You could use the book to build your own version of <em>Escape</em> first, or use my version of the final game and customize that. I’d love to see what you make using the program as a starting point! You can find me on Twitter at @musicandwords or visit my website at <em><a href="http://www.sean.co.uk">www.sean.co.uk</a></em>.</li>
</ul>
<h3 class="h3" id="lev2"><strong>WHAT’S IN THIS BOOK?</strong></h3>
<p class="noindent">Here’s a briefing on what’s in store for you as you embark on your mission.</p>
<ul>
<li class="noindent"><strong><a href="ch01.xhtml#ch01">Chapter 1</a></strong> shows you how to go on a spacewalk. You’ll learn how to use graphics in your Python programs using Pygame Zero and discover some of the basics of making Python programs.</li>
<li class="noindent"><strong><a href="ch02.xhtml#ch02">Chapter 2</a></strong> introduces <em>lists</em>, which store much of the information in the <em>Escape</em> game. You’ll see how to use lists to make a map.</li>
<li class="noindent"><strong><a href="ch03.xhtml#ch03">Chapter 3</a></strong> shows you how to get parts of a program to repeat and how to use that knowledge to display a map. You’ll also design a room layout for the space station, using wall pillars and floor tiles.</li>
<li class="noindent"><span epub:type="pagebreak" id="page_3"/>In <strong><a href="ch04.xhtml#ch04">Chapter 4</a></strong>, you’ll start to build the <em>Escape</em> game, laying down the blueprints for the station. You’ll see how the program understands the station layout and uses it to create the fabric for the rooms, putting the walls and floor in place.</li>
<li class="noindent">In <strong><a href="ch05.xhtml#ch05">Chapter 5</a></strong>, you’ll learn how to use <em>dictionaries</em> in Python, which are another important way of storing information. You’ll add information for all the objects the game uses, and you’ll see how to create a preview of your own room design. When you extend the program in <strong><a href="ch06.xhtml#ch06">Chapter 6</a></strong>, you’ll see all the scenery in place and will be able to look at all the rooms.</li>
<li class="noindent">After building the space station, you can move in. In <strong><a href="ch07.xhtml#ch07">Chapter 7</a></strong>, you’ll add your astronaut character and discover how to move around the rooms and animate movements.</li>
<li class="noindent"><strong><a href="ch08.xhtml#ch08">Chapter 8</a></strong> shows you how to polish the game’s graphics with shadows, fading walls, and a new function to draw the rooms that fixes the remaining graphical glitches.</li>
<li class="noindent">When the space station is operational, you can unpack your personal effects. In <strong><a href="ch09.xhtml#ch09">Chapter 9</a></strong>, you’ll position items the player can examine, pick up, and drop. In <strong><a href="ch10.xhtml#ch10">Chapter 10</a></strong>, you’ll see how to use and combine items, so you can solve puzzles in the game.</li>
<li class="noindent">The space station is nearly complete. <strong><a href="ch11.xhtml#ch11">Chapter 11</a></strong> adds safety doors that restrict access to certain zones. Just as you’re putting your feet up and celebrating a job well done, there’s danger around the corner, as you’ll add moving hazards in <strong><a href="ch12.xhtml#ch12">Chapter 12</a></strong>.</li>
</ul>
<p class="indent">As you work through the book, you’ll complete training missions that give you an opportunity to test your programs and your coding skills. The answers, if you need them, are at the end of each chapter.</p>
<p class="indent">The appendixes at the back of the book will help you, too. <strong><a href="appa.xhtml#appa">Appendix A</a></strong> contains the listing for the whole game. If you’re not sure where to add a new chunk of code, you can check here. <strong><a href="appb.xhtml#appb">Appendix B</a></strong> contains a table of the most important variables, lists, and dictionaries if you can’t remember what’s stored where, and <strong><a href="appc.xhtml#appc">Appendix C</a></strong> has some debugging tips if a program doesn’t work for you.</p>
<p class="indent">For more information and supporting resources for the book, visit the book’s website at <em><a href="http://www.sean.co.uk/books/mission-python/">www.sean.co.uk/books/mission-python/</a></em>. You can also find information and resources at <em><a href="https://nostarch.com/missionpython/">https://nostarch.com/missionpython/</a></em>.</p>
<h3 class="h3" id="lev3"><strong>INSTALLING THE SOFTWARE</strong></h3>
<p class="noindent">The game uses the Python programming language and Pygame Zero, which is software that makes it easier to handle graphics and sound. You need to install both of these before you begin.</p>
<div class="note">
<p class="notet"><strong>NOTE</strong></p>
<p class="notep"><em>For updated installation instructions, visit the book’s web page at</em> <a href="https://nostarch.com/missionpython/">https://nostarch.com/missionpython/</a>.</p>
</div>
<h4 class="h4" id="lev4"><span epub:type="pagebreak" id="page_4"/><strong>INSTALLING THE SOFTWARE ON RASPBERRY PI</strong></h4>
<p class="noindent">If you’re using a Raspberry Pi, Python and Pygame Zero are already installed. You can skip ahead to “<a href="intro.xhtml#lev8">Downloading the Game Files</a>” on <a href="intro.xhtml#page_7">page 7</a>.</p>
<h4 class="h4" id="lev5"><strong>INSTALLING PYTHON ON WINDOWS</strong></h4>
<p class="noindent">To install the software on a Windows PC, follow these steps:</p>
<ol>
<li class="noindent">Open your web browser and visit <em><a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></em>.</li>
<li class="noindent"><p class="list">At the time of this writing, 3.7 is the latest version of Python, but Pygame isn’t available for easy installation on it yet. I recommend you use the latest version of Python 3.6 instead (3.6.6 at the time of writing). You can find old versions of Python farther down the screen on the downloads page (see <a href="intro.xhtml#introfig1">Figure 1</a>). Save the file on your desktop or somewhere else you can easily find it. (Pygame Zero works only with Python 3, so if you usually use Python 2, you’ll need to switch to Python 3 for this book.)</p>
<div class="image"><a id="introfig1"/><img src="../images/fig1.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1: The Python downloads page</em></p></li>
<li class="noindent">When the file has downloaded, double-click it to run it.</li>
<li class="noindent">In the window that opens, select the checkbox to Add Python 3.6 to PATH (see <a href="intro.xhtml#introfig2">Figure 2</a>).</li>
<li class="noindent"><p class="list">Click <strong>Install Now</strong>.</p>
<div class="image"><span epub:type="pagebreak" id="page_5"/><a id="introfig2"/><img src="../images/fig2.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 2: The Python installer</em></p></li>
<li class="noindent">If you’re asked whether you want to allow this application to make changes to your device, click <strong>Yes</strong>.</li>
<li class="noindent">Python will take a few minutes to install. When it finishes, click <strong>Close</strong> to complete the installation.</li>
</ol>
<h4 class="h4" id="lev6"><strong>INSTALLING PYGAME ZERO ON WINDOWS</strong></h4>
<p class="noindent">Now that you have Python installed on your computer, you can install Pygame Zero. Follow these steps:</p>
<ol>
<li class="noindent">Hold down the <strong>Windows Start key</strong> and press <strong>R</strong>. The Run window should open (see <a href="intro.xhtml#introfig3">Figure 3</a>).</li>
<li class="noindent"><p class="list">Enter <span class="codestrong">cmd</span> (see <a href="intro.xhtml#introfig3">Figure 3</a>). Press <small>ENTER</small> or click <strong>OK</strong>.</p>
<div class="image"><a id="introfig3"/><img src="../images/fig3.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 3: The Windows Run dialog box</em></p></li>
<li class="noindent"><p class="list">The command line window should open, as shown in <a href="intro.xhtml#introfig4">Figure 4</a>. Here you can enter instructions for managing files or starting programs. Enter <span class="codestrong">pip install pgzero</span> and press <small>ENTER</small> at the end of the line.</p>
<div class="image"><span epub:type="pagebreak" id="page_6"/><a id="introfig4"/><img src="../images/fig4.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 4: The command line window</em></p></li>
<li class="noindent">Pygame Zero should start to install. It will take a few moments, and you’ll know it’s finished when your <code>&gt;</code> prompt appears again.</li>
<li class="noindent">If you get an error message saying that pip is not recognized, try installing Python again. You can uninstall Python first by running the installation program again or using the Windows Control panel. Make sure you select the box for the PATH when installing Python (see <a href="intro.xhtml#introfig2">Figure 2</a>). After you have reinstalled Python, try installing Pygame Zero again.</li>
<li class="noindent"><p class="list">When Pygame Zero has finished downloading and you can type again, enter the following:</p>
<pre><span class="codestrong1">echo print("Hello!") &gt; test.py</span></pre></li>
<li class="noindent">This line creates a new file called <em>test.py</em> that contains the instruction <code>print("Hello!")</code>. I’ll explain the <code>print()</code> instruction in <a href="ch01.xhtml#ch01">Chapter 1</a>, but for now, this is just a quick way to make a test file. Be careful when you enter the parentheses (curved brackets) and quotation marks: if you miss one, the file won’t work properly.</li>
<li class="noindent"><p class="list">Open the test file by entering the following:</p>
<pre><span class="codestrong1">pgzrun test.py</span></pre></li>
<li class="noindent">After a short delay, a blank window should open with the title <em>Pygame Zero Game</em>. Click the command line window again to bring it to the front: you should see the text <code>Hello!</code> Press <small>CTRL</small>-C in the command line window to stop the program.</li>
<li class="noindent">If you want to delete your test program, enter <span class="codestrong">del test.py</span>.</li>
</ol>
<h4 class="h4" id="lev7"><strong>INSTALLING THE SOFTWARE ON OTHER MACHINES</strong></h4>
<p class="noindent">Python and Pygame Zero are available for other computer systems. Pygame Zero has been designed in part to enable games to work across different computers, so the <em>Escape</em> code should run wherever Pygame Zero runs. This book only provides guidance for users of Windows and Raspberry Pi computers. But if you have a different computer, you can download Python at <em><a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></em> and can find advice on installing Pygame Zero at <em><a href="http://pygame-zero.readthedocs.io/en/latest/installation.html">http://pygame-zero.readthedocs.io/en/latest/installation.html</a></em>.</p>
<h3 class="h3" id="lev8"><span epub:type="pagebreak" id="page_7"/><strong>DOWNLOADING THE GAME FILES</strong></h3>
<p class="noindent">I’ve provided all the program files, sounds, and images you need for the <em>Escape</em> game. You can also download all the listings in the book, so if you can’t get one to work, you can use mine instead. All the book’s content downloads as a single ZIP file called <em>escape.zip</em>.</p>
<h4 class="h4" id="lev9"><strong>DOWNLOADING AND UNZIPPING THE FILES ON A RASPBERRY PI</strong></h4>
<p class="noindent">To download the game files on a Raspberry Pi, follow these steps, and refer to <a href="intro.xhtml#introfig5">Figure 5</a>. The numbers in <a href="intro.xhtml#introfig5">Figure 5</a> show you where to do each step.</p>
<p class="numlist"><span class="ent">➊</span> Open your web browser and visit <em><a href="https://nostarch.com/missionpython/">https://nostarch.com/missionpython/</a></em>. Click the link to download the files.</p>
<p class="numlist"><span class="ent">➋</span> From your desktop, click the File Manager icon on the taskbar at the top of the screen.</p>
<p class="numlist"><span class="ent">➌</span> Double-click your Downloads folder to open it</p>
<p class="numlist"><span class="ent">➍</span> Double-click the <em>escape.zip</em> file.</p>
<p class="numlist"><span class="ent">➎</span> Click the <strong>Extract Files</strong> button to open the Extract Files dialog box.</p>
<p class="numlist"><span class="ent">➏</span> Change the folder that you’ll extract to so it reads <em>/home/pi/escape</em>.</p>
<p class="numlist"><span class="ent">➐</span> Ensure that the option is selected to Extract files with full path.</p>
<p class="numlist"><span class="ent">➑</span> Click <strong>Extract</strong>.</p>
<div class="image"><a id="introfig5"/><img src="../images/fig5.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 5: The steps you should take to unzip your files</em></p>
<h4 class="h4" id="lev10"><span epub:type="pagebreak" id="page_8"/><strong>UNZIPPING THE FILE ON A WINDOWS PC</strong></h4>
<p class="noindent">To unzip the files on a Windows PC, follow these steps.</p>
<ol>
<li class="noindent">Open your web browser and visit <em><a href="https://nostarch.com/missionpython/">https://nostarch.com/missionpython/</a></em>. Click the link to download the files. Save the ZIP file on your desktop, in your <em>Documents</em> folder, or somewhere else you can easily find it.</li>
<li class="noindent">Depending on the browser you’re using, the ZIP file might open automatically, or there might be an option to open it at the bottom of the screen. If not, hold down the <strong>Windows Start key</strong> and press <strong>E</strong>. The Windows Explorer window should open. Go to the folder where you saved the ZIP file. Double-click the ZIP file.</li>
<li class="noindent">Click <strong>Extract All</strong> at the top of the window.</li>
<li class="noindent">I recommend that you create a folder called <em>escape</em> in your <em>Documents</em> folder and extract the files there. My documents folder is <em>C:\Users\Sean\Documents</em>, so I just typed <em>\escape</em> at the end of the folder name to create a new folder in that folder (see <a href="intro.xhtml#introfig6">Figure 6</a>). You can use the <strong>Browse</strong> button to get to your <em>Documents</em> folder first if necessary.</li>
<li class="noindent"><p class="list">Click <strong>Extract</strong>.</p>
<div class="image"><a id="introfig6"/><img src="../images/fig6.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 6: Setting the folder to unzip the game files into</em></p></li>
</ol>
<h4 class="h4" id="lev11"><strong>WHAT’S IN THE ZIP FILE</strong></h4>
<p class="noindent">The ZIP file you’ve just downloaded contains three folders and a Python program, <em>escape.py</em> (see <a href="intro.xhtml#introfig7">Figure 7</a>). The Python program is the final version of the <em>Escape</em> game, so you can start playing it right away. The <em>images</em> folder contains all the images you’ll need for the game and other projects in this book. The <em>sounds</em> folder contains the sound effects.</p>
<p class="indent"><span epub:type="pagebreak" id="page_9"/>In the <em>listings</em> folder, you’ll find all the numbered listings in this book. If you can’t get a program to work, try my version from this folder. You’ll need to copy it from the listings folder first, and then paste it in the <em>escape</em> folder where the <em>escape.py</em> program is now. The reason you do this is because the program needs be alongside the <em>images</em> and <em>sounds</em> folders to work correctly.</p>
<div class="image"><a id="introfig7"/><img src="../images/fig7.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 7: The contents of the ZIP file as they might appear in Windows</em></p>
<h3 class="h3" id="lev12"><strong>RUNNING THE GAME</strong></h3>
<p class="noindent">When you downloaded Python, another program called IDLE will have been downloaded with it. IDLE is an integrated development environment (IDE), which is software you can use to write programs in Python. You can run some of the listings in this book from the IDLE Python editor using the instructions provided. Most of the programs, though, use Pygame Zero, and you have to run those programs from the command line. Follow the instructions here to run the <em>Escape</em> game and any other Pygame Zero programs.</p>
<h4 class="h4" id="lev13"><strong>RUNNING PYGAME ZERO PROGRAMS ON THE RASPBERRY PI</strong></h4>
<p class="noindent">If you’re using a Raspberry Pi, follow these steps to run the <em>Escape</em> game:</p>
<ol>
<li class="noindent">Using the File Manager, go to your <em>escape</em> folder in your <em>pi</em> folder.</li>
<li class="noindent"><p class="list">Click <strong>Tools</strong> on the menu and select <strong>Open Current Folder in Terminal</strong>, or you can press F4. The command line window (also known as the <em>shell</em>) should open, as shown in <a href="intro.xhtml#introfig8">Figure 8</a>. You can enter instructions here for managing files or starting programs.</p>
<div class="image"><a id="introfig8"/><img src="../images/fig8.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 8: The command line window on the Raspberry Pi</em></p></li>
<li class="noindent"><p class="list">Type in the following command and press <small>ENTER</small>. The game begins!</p>
<pre><span class="codestrong1">pgzrun escape.py</span></pre></li>
</ol>
<p class="indent"><span epub:type="pagebreak" id="page_10"/>This is how you run a Pygame Zero program on the Pi. To run the same program again, repeat the last step. To run a different program that’s saved in the same folder, repeat the last step but change the name of the filename after <code>pgzrun</code>. To run a Pygame Zero program in a different folder, follow the steps starting from step 1, but open the command line from the folder with the program you want to run.</p>
<h4 class="h4" id="lev14"><strong>RUNNING PYGAME ZERO PROGRAMS IN WINDOWS</strong></h4>
<p class="noindent">If you’re using Windows, follow these steps to run the program:</p>
<ol>
<li class="noindent">Go to your <em>escape</em> folder. (Hold down the <strong>Windows Start key</strong> and press <strong>E</strong> to open the Windows Explorer again.)</li>
<li class="noindent"><p class="list">Click the long bar above your files, as shown in <a href="intro.xhtml#introfig9">Figure 9</a>. Type <span class="codestrong">cmd</span> into this bar and press <small>ENTER</small>.</p>
<div class="image"><a id="introfig9"/><img src="../images/fig9.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 9: Finding the path to your Pygame files</em></p></li>
<li class="noindent"><p class="list">The command line window will open. Your folder named <em>escape</em> will appear just before the <code>&gt;</code> on the last line, as shown in <a href="intro.xhtml#introfig10">Figure 10</a>.</p>
<div class="image"><a id="introfig10"/><img src="../images/fig10.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 10: The command line window in Windows</em></p></li>
<li class="noindent">Type <span class="codestrong">pgzrun escape.py</span> in the command line window. Press <small>ENTER</small>, and the <em>Escape</em> game begins.</li>
</ol>
<p class="indent">This is how you run a Pygame Zero program on a Windows computer. You can run the program again by repeating the last step. To run a different program that’s saved in the same folder, repeat the last step but change the name of the filename after <code>pgzrun</code>. To run a Pygame Zero program in a different folder, follow the steps starting from step 1, but open the command line from the folder with the program you want to run.</p>
<h3 class="h3" id="lev15"><span epub:type="pagebreak" id="page_11"/><strong>PLAYING THE GAME</strong></h3>
<p class="noindent">You’re working alone on the space station on Mars, many millions of kilometers from home. The rest of the crew is on a long-distance mission, exploring a canyon for signs of life, and won’t be back for days. The murmuring hum of the life support systems surrounds you.</p>
<p class="indent">You’re startled when the alarm sounds! There’s a breach in the space station wall, and your air is slowly venting into the Martian atmosphere. You climb quickly but carefully into your space suit, but the computer tells you the suit is damaged. Your life is at risk.</p>
<p class="indent">Your first priority is to repair your suit and ensure a reliable air supply. Your second priority is to radio for help, but the space station’s radio systems are malfunctioning. Last night the Poodle lander, sent from Earth, crash-landed in the Martian dust. If you can find it, perhaps you can use its radio to issue a distress signal.</p>
<p class="indent">Use the arrow keys to move around the space station. To examine an object, stand on it and press the spacebar. Alternatively, if the object is something you can’t walk on, press the spacebar while walking into it.</p>
<p class="indent">To pick up an object, walk onto it and press the G key (for <em>get</em>).</p>
<p class="indent">To select an object in your inventory, shown at the top of the screen (see <a href="intro.xhtml#introfig11">Figure 11</a>), press the <small>TAB</small> key to move through the items. To drop the selected object, press D.</p>
<div class="image"><a id="introfig11"/><img src="../images/fig11.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 11: Your adventure begins!</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_12"/>To use an object, either select it in your inventory or walk onto or into it and press U. You can combine objects or use them together when you press U while you carry one object and stand on the other or while you carry one and walk into the other.</p>
<p class="indent">You’ll need to work out how to use your limited resources creatively to overcome obstacles and get to safety. Good luck!</p>
</body></html>