<html><head></head><body>
<h2 class="h2" id="ch10"><span epub:type="pagebreak" id="page_171"/><strong><span class="blue"><span class="big">10</span></span><br/>MAKE YOURSELF USEFUL</strong></h2>
<div class="image1"><img src="../images/common01.jpg" alt="image"/></div>
<p class="noindent">You’ve added the props to the game, so in this chapter, you’ll add the code to enable astronauts to <em>use</em> objects and combine them to make new objects. These skills will be essential for your mission. You’ll get a chance to rehearse them, so you’re ready for any situation.</p>
<p class="indent">The code in this chapter is simpler than some of the listings you’ve seen recently and contains the answers for many of the puzzles in the <em>Escape</em> game. So I don’t give away too many spoilers, I won’t explain every item and solution here. For example, sometimes you might see an object number in the code, but I won’t tell you the name of that object.</p>
<p class="indent">If you get stuck playing the game, you could read this code and use it to work out which objects are which by referring to the <code>objects</code> dictionary (see <a href="ch05.xhtml#ch05list6">Listing 5-6</a> and <a href="ch05.xhtml#ch05list8">Listing 5-8</a> in <a href="ch05.xhtml#ch05">Chapter 5</a>). That should be a last resort, though. You can solve all the puzzles by thinking like an astronaut. Ask yourself: What do you have access to that could be useful? How could you make something more useful?</p>
<h3 class="h3" id="lev130"><span epub:type="pagebreak" id="page_172"/><strong>ADDING THE KEYBOARD CONTROL FOR USING OBJECTS</strong></h3>
<p class="noindent">We’ll start by adding the keyboard control in the <code>game_loop()</code> function. Open <em>listing9-10.py</em>, your last listing in <a href="ch09.xhtml#ch09">Chapter 9</a>. We’ll build on this listing.</p>
<p class="indent">Listing 10-1 shows the new instructions to add inside the <code>game_loop()</code> function. Add them after the keyboard controls for <em>drop</em> and <em>examine</em>, which you added in the previous chapter. These instructions start the <code>use_object()</code> function when the player presses the U key. Save the program as <em>listing10-1.py</em>. Don’t try running the program yet: it won’t do anything new, but it will crash if you press the U key.</p>
<p class="margin"><em>listing10-1.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/><br/>        <br/>    <span class="gray">if keyboard.space:</span><br/>        <span class="gray">examine_object()</span><br/><br/>    <span class="orange">if</span> keyboard.u:<br/>        use_object()<br/>--<span class="codeitalic1">snip</span>--</pre>
<p class="listing" id="ch10list1"><em>Listing 10-1: Adding the keyboard control for using objects</em></p>
<h3 class="h3" id="lev131"><strong>ADDING STANDARD MESSAGES FOR USING OBJECTS</strong></h3>
<p class="noindent">The function for using objects is long, so I’ve given it its own section in the program. Place the new <code>USE OBJECTS</code> section after the <code>PROP INTERACTIONS</code> section that you added in <a href="ch09.xhtml#ch09">Chapter 9</a>. <a href="ch10.xhtml#ch10list2">Listing 10-2</a> shows the start of this new section. Add this code after the <code>examine_object()</code> function ends but before the <code>START</code> section.</p>
<p class="margin"><em>listing10-2.py</em></p>
<pre>   <span class="gray">--<span class="codeitalic1">snip</span>--</span><br/>       <span class="gray">show_text(description, 0)</span><br/>       <span class="gray">time.sleep(0.5)</span><br/><br/>   <span class="red">#################</span><br/>   <span class="red">## USE OBJECTS ##</span><br/>   <span class="red">#################</span><br/><br/>   <span class="orange">def</span> <span class="blue">use_object</span>():<br/>       <span class="orange">global</span> room_map, props, item_carrying, air, selected_item, energy<br/>       <span class="orange">global</span> in_my_pockets, suit_stitched, air_fixed, game_over<br/><br/><span class="ent">➊</span>     use_message = <span class="green">"You fiddle around with it but don't get anywhere."</span><br/><span class="ent">➋</span>     standard_responses = {<br/>           4: <span class="green">"Air is running out! You can't take this lying down!"</span>,<br/>           6: <span class="green">"This is no time to sit around!"</span>,<br/>           7: <span class="green">"This is no time to sit around!"</span>,<br/>           32: <span class="green">"It shakes and rumbles, but nothing else happens."</span>,<br/><span epub:type="pagebreak" id="page_173"/>           34: <span class="green">"Ah! That's better. Now wash your hands."</span>,<br/>           35: <span class="green">"You wash your hands and shake the water off."</span>,<br/>           37: <span class="green">"The test tubes smoke slightly as you shake them."</span>,<br/>           54: <span class="green">"You chew the gum. It's sticky like glue."</span>,<br/>           55: <span class="green">"The yoyo bounces up and down, slightly slower than on Earth"</span>,<br/>           56: <span class="green">"It's a bit too fiddly. Can you thread it on something?"</span>,<br/>           59: <span class="green">"You need to fix the leak before you can use the canister"</span>,<br/>           61: <span class="green">"You try signalling with the mirror, but nobody can see you."</span>,<br/>           62: <span class="green">"Don't throw resources away. Things might come in handy..."</span>,<br/>           67: <span class="green">"To enjoy yummy space food, just add water!"</span>,<br/>           75: <span class="green">"You are at Sector: "</span> + <span class="purple">str</span>(current_room) + <span class="green">" // X: "</span> \<br/>               + <span class="purple">str</span>(player_x) + <span class="green">" // Y: "</span> + <span class="purple">str</span>(player_y)    <br/>           }<br/><br/>       <span class="red"># Get object number at player's location.</span><br/><span class="ent">➌</span>     item_player_is_on = get_item_under_player()<br/><span class="ent">➍</span>     <span class="orange">for</span> this_item <span class="orange">in</span> [item_player_is_on, item_carrying]:<br/><span class="ent">➎</span>         <span class="orange">if</span> this_item <span class="orange">in</span> standard_responses:<br/><span class="ent">➏</span>             use_message = standard_responses[this_item]<br/><span class="ent">➐</span>     show_text(use_message, 0)<br/>       time.sleep(0.5)<br/><br/>   <span class="gray">###############</span><br/>   <span class="gray">##   START   ##</span><br/>   <span class="gray">###############</span><br/>   <span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list2"><em>Listing 10-2: Adding the first instructions for using objects</em></p>
<p class="indent"><a href="ch10.xhtml#ch10list2">Listing 10-2</a> shows the first part of the <code>use_object()</code> function. We’ll flesh this out in further listings in this chapter. At the end of the function, the program shows players a message to tell them what happened when they tried to use the object <span class="ent">➐</span>. That message will be in the <code>use_message</code> variable. At the start of this function, we set it up as an error message <span class="ent">➊</span>. Later on, it will be changed to a message of success if they used an object.</p>
<p class="indent">Some of the objects have no real function in the game but will reward the player with a message when they try to use them. These messages could include clues as well as add to the game story. The dictionary <code>standard_responses</code> contains messages to show players when they use certain objects <span class="ent">➋</span>. The dictionary key is the object number. For example, if they want to use the bed (lazy bones!), which is object 4, they see a message that says, “You can’t take this lying down!”</p>
<p class="indent">The variable <code>item_the_player_is_on</code> stores the object number at the player’s position in the room <span class="ent">➌</span>. Players can use objects they are carrying or standing on. We set up a loop that goes through a list that contains two items: the item number the player is standing on and the item number the player is carrying <span class="ent">➍</span>. If either of them is a key for the <code>standard_responses</code> dictionary <span class="ent">➎</span>, the <code>use_message</code> is updated to the object’s message from that dictionary <span class="ent">➏</span>. The program prioritizes items you’re carrying over items you’re standing on if they both have standard messages.</p>
<p class="indent"><span epub:type="pagebreak" id="page_174"/>Save your file as <em>listing10-2.py</em>. Run it using <span class="codestrong">pgzrun listing10-2.py</span>. To test that it works, press U to use the yoyo you’re carrying.</p>
<h3 class="h3" id="lev132"><strong>ADDING THE GAME PROGRESS VARIABLES</strong></h3>
<p class="noindent">There are a few new variables we need to add to the program to store important data about the player’s progress in the game:</p>
<ul>
<li class="noindent"><code>air</code>, which stores how much air you have available, as a percentage</li>
<li class="noindent"><code>energy</code>, which stores your energy, as a percentage, and will be reduced if you injure yourself</li>
<li class="noindent"><code>suit_stitched</code>, which stores a <code>True</code> or <code>False</code> value, depending on whether the suit has been repaired</li>
<li class="noindent"><code>air_fixed</code>, which stores a <code>True</code> or <code>False</code> value, depending on whether the air tank has been fixed</li>
</ul>
<p class="indent">Add the variables to the end of the <code>VARIABLES</code> section, as shown in <a href="ch10.xhtml#ch10list3">Listing 10-3</a>. Save your updated program as <em>listing10-3.py</em>. This program won’t do anything new if you run it: we’ve set up some variables but aren’t doing anything with them yet.</p>
<p class="margin"><em>listing10-3.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/><span class="gray">GREEN = (0, 255, 0)</span><br/><span class="gray">RED = (128, 0, 0)</span><br/><br/>air, energy = 100, 100<br/>suit_stitched, air_fixed = <span class="orange">False</span>, <span class="orange">False</span><br/>launch_frame = 0<br/><br/><br/><span class="gray">###############</span><br/><span class="gray">##    MAP    ##</span><br/><span class="gray">###############</span><br/><span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list3"><em>Listing 10-3: Adding the game progress variables</em></p>
<h3 class="h3" id="lev133"><strong>ADDING THE ACTIONS FOR SPECIFIC OBJECTS</strong></h3>
<p class="noindent">The next stage in the <code>use_object()</code> function is to check particular objects to see if they have actions that can be performed with them. These checks will override any standard messages that might have been set up earlier and are shown in <a href="ch10.xhtml#ch10list4">Listing 10-4</a>. Because these instructions are inside the <code>use_object()</code> function, they are indented by at least four spaces. Save your program as <em>listing10-4.py</em>. Run it using <span class="codestrong">pgzrun listing10-4.py</span>.</p>
<p class="margin"><span epub:type="pagebreak" id="page_175"/><em>listing10-4.py</em></p>
<pre>   <span class="gray">--<span class="codeitalic1">snip</span>--</span><br/>           <span class="gray">if this_item in standard_responses:</span><br/>               <span class="gray">use_message = standard_responses[this_item]</span><br/><br/><span class="ent">➊</span>     <span class="orange">if</span> item_carrying == 70 <span class="orange">or</span> item_player_is_on == 70:<br/>           use_message = <span class="green">"Banging tunes!"</span><br/>           sounds.steelmusic.play(2)<br/><br/><span class="ent">➋</span>     <span class="orange">elif</span> item_player_is_on == 11:<br/><span class="ent">➌</span>         use_message = <span class="green">"AIR: "</span> + <span class="purple">str</span>(air) + \<br/>                         <span class="green">"% / ENERGY "</span> + <span class="purple">str</span>(energy) + <span class="green">"% / "</span><br/>           <span class="orange">if</span> <span class="orange">not</span> suit_stitched:<br/>               use_message += <span class="green">"*ALERT* SUIT FABRIC TORN / "</span><br/>           <span class="orange">if</span> <span class="orange">not</span> air_fixed:<br/>               use_message += <span class="green">"*ALERT* SUIT AIR BOTTLE MISSING"</span><br/>           <span class="orange">if</span> suit_stitched <span class="orange">and</span> air_fixed:<br/>               use_message += <span class="green">" SUIT OK"</span><br/>           show_text(use_message, 0)<br/>           sounds.say_status_report.play()<br/>           time.sleep(0.5)<br/>           <span class="red"># If "on" the computer, player intention is clearly status update.</span><br/>           <span class="red"># Return to stop another object use accidentally overriding this.</span><br/><span class="ent">➍</span>         <span class="orange">return</span><br/><br/>       <span class="orange">elif</span> item_carrying == 60 <span class="orange">or</span> item_player_is_on == 60:<br/><span class="ent">➎</span>         use_message = <span class="green">"You fix "</span> + objects[60][3] + <span class="green">" to the suit"</span><br/>           air_fixed = <span class="orange">True</span><br/>           air = 90<br/>           air_countdown()<br/>           remove_object(60)<br/><br/>       <span class="orange">elif</span> (item_carrying == 58 <span class="orange">or</span> item_player_is_on == 58) \<br/>          <span class="orange">and not</span> suit_stitched:<br/>           use_message = <span class="green">"You use "</span> + objects[56][3] + \<br/>                         <span class="green">" to repair the suit fabric"</span><br/>           suit_stitched = <span class="orange">True</span><br/>           remove_object(58)<br/><br/>       <span class="orange">elif</span> item_carrying == 72 <span class="orange">or</span> item_player_is_on == 72:<br/>           use_message = <span class="green">"You radio for help. A rescue ship is coming. \</span><br/>   <span class="green">Rendezvous Sector 13, outside."</span><br/>           props[40][0] = 13<br/><br/>       <span class="orange">elif</span> (item_carrying == 66 <span class="orange">or</span> item_player_is_on == 66) \<br/>               <span class="orange">and</span> current_room <span class="orange">in</span> outdoor_rooms:<br/>           use_message = <span class="green">"You dig..."</span><br/>           <span class="orange">if</span> (current_room == LANDER_SECTOR<br/>               <span class="orange">and</span> player_x == LANDER_X<br/>               <span class="orange">and</span> player_y == LANDER_Y):<br/>               add_object(71)<br/>               use_message = <span class="green">"You found the Poodle lander!"</span><br/><br/><span epub:type="pagebreak" id="page_176"/>       <span class="orange">elif</span> item_player_is_on == 40:<br/>           clock.unschedule(air_countdown)<br/>           show_text(<span class="green">"Congratulations, "</span>+ PLAYER_NAME +<span class="green">"!"</span>, 0)<br/>           show_text(<span class="green">"Mission success! You have made it to safety."</span>, 1)<br/>           game_over = <span class="orange">True</span><br/>           sounds.take_off.play()<br/>           game_completion_sequence()<br/><br/>       <span class="orange">elif</span> item_player_is_on == 16:<br/>           energy += 1<br/>           if energy &gt; 100:<br/>               energy = 100<br/>           use_message = <span class="green">"You munch the lettuce and get a little energy back"</span><br/>           draw_energy_air()<br/><br/>       <span class="orange">elif</span> item_carrying == 68 <span class="orange">or</span> item_player_is_on == 68:<br/>           energy = 100<br/>           use_message = <span class="green">"You use the food to restore your energy"</span><br/>           remove_object(68)<br/>           draw_energy_air()<br/><br/>       <span class="orange">if</span> suit_stitched <span class="orange">and</span> air_fixed: <span class="red"># open airlock access</span><br/>           <span class="orange">if</span> current_room == 31 <span class="orange">and</span> props[20][0] == 31:<br/>               open_door(20) <span class="red"># which includes removing the door</span><br/>               sounds.say_airlock_open.play()<br/>               show_text(<span class="green">"The computer tells you the airlock is now open."</span>, 1)<br/>           <span class="orange">elif</span> props[20][0] == 31:<br/>               props[20][0] = 0 <span class="red"># remove door from map</span><br/>               sounds.say_airlock_open.play()<br/>               show_text(<span class="green">"The computer tells you the airlock is now open."</span>, 1)<br/><br/>       <span class="gray">show_text(use_message, 0)</span><br/>       <span class="gray">time.sleep(0.5)</span><br/>       <br/><br/>   <span class="gray">###############</span><br/>   <span class="gray">##   START   ##</span><br/>   <span class="gray">###############</span><br/>   <span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list4"><em>Listing 10-4: Adding the ability to use certain objects</em></p>
<p class="indent"><a href="ch10.xhtml#ch10list4">Listing 10-4</a> includes a series of instructions that check whether the object that’s being used is a particular object number. If so, the instructions for that object are carried out.</p>
<p class="indent">For example, if the player is carrying or standing on object 70 <span class="ent">➊</span>, which is an MP3 player, they’ll see a message that says “Banging tunes!” and hear some music. If the player is using the computer <span class="ent">➋</span>, the message shown is made by combining information from the <code>air</code> and <code>energy</code> variables, and adding an alert if the suit or air bottle is faulty. There’s also a computer speech sound effect here that says “status report!”</p>
<p class="indent"><span epub:type="pagebreak" id="page_177"/>I’ve included a <code>return</code> instruction at the end of this set of instructions <span class="ent">➍</span>, which prevents the player from accidentally using another object when they intended to use the computer. If we didn’t include this <code>return</code> instruction, the player might end up using another prop that they’re carrying instead of the computer. Keeping the controls simple means there can be some ambiguity about what the player intended to use, but the game is designed to prioritize results that help the player complete the game.</p>
<p class="indent">In a couple of places, I’ve used the short description from the <code>objects</code> dictionary instead of typing the name of the object into the string <span class="ent">➎</span>. That’s to prevent you from seeing any spoilers in the code!</p>
<p class="indent">The <code>\</code> symbol at the end of a line <span class="ent">➌</span> tells Python that the code continues on the next line. Some of the lines here are quite long, so I’ve used this symbol to break them up and to fit them on the book page.</p>
<p class="indent">Try out some of the new code by walking into one of the computer terminals and pressing the U key. You’ll see a status update. If you can find the MP3 player, you can listen to that too.</p>
<div class="note">
<p class="notet"><strong><span class="notes">RED ALERT</span></strong></p>
<p class="notep"><em>Be particularly careful when you’re entering the object numbers and the rest of the code in <a href="ch10.xhtml#ch10list4">Listing 10-4</a>. If you make a mistake here, you might not be able to complete the puzzles in the game!</em></p>
</div>
<h3 class="h3" id="lev134"><strong>COMBINING OBJECTS</strong></h3>
<p class="noindent">Some of the puzzles in the game require you to use objects together. For example, you might use one object as a tool to do something to the other object, or you might join two objects together. For instance, one of the puzzles requires you to insert a GPS module into a positioning system. When you find the two parts, you need to combine them to make a working positioning system. To use two objects together, you select one in your inventory and walk on or into the other one. You might need to drop an object from your inventory onto the floor so you can work on it with another object you’re carrying.</p>
<p class="indent">In the <em>Escape</em> game engine, combinations are called <em>recipes</em>. A single recipe contains three object numbers in a list. The first two are the items that are combined, and the third one is the object number they make when they’re combined. Here’s an example:</p>
<pre>[73, 74, 75]</pre>
<p class="indent">Object 73 (a GPS module) plus object 74 (a positioning system) makes object 75 (a working positioning system).</p>
<p class="indent">When you combine objects, the new object goes into your inventory. The objects you combined are removed from the game if they’re props. Sometimes one will be a piece of scenery and so will remain in the game.</p>
<p class="indent"><span epub:type="pagebreak" id="page_178"/><a href="ch10.xhtml#ch10list5">Listing 10-5</a> shows you the list of recipes. Add it to the end of the <code>PROPS</code> part of your program where the information for props is set up. Save your file as <em>listing10-5.py</em>. The listing shouldn’t do anything new yet if you run it, but it will check that the new data is correct.</p>
<p class="margin"><em>listing10-5.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/><span class="gray">in_my_pockets = [55]</span><br/><span class="gray">selected_item = 0 # the first item</span><br/><span class="gray">item_carrying = in_my_pockets[selected_item]</span><br/><br/>RECIPES = [<br/>    [62, 35, 63], [76, 28, 77], [78, 38, 54], [73, 74, 75],<br/>    [59, 54, 60], [77, 55, 56], [56, 57, 58], [71, 65, 72],<br/>    [88, 58, 89], [89, 60, 90], [67, 35, 68]<br/>    ]<br/><br/>checksum = 0<br/>check_counter = 1<br/><span class="orange">for</span> recipe <span class="orange">in</span> RECIPES:<br/>    checksum += (recipe[0] * check_counter<br/>                 + recipe[1] * (check_counter + 1)<br/>                 + recipe[2] * (check_counter + 2))<br/>    check_counter += 3<br/><span class="purple">print</span>(<span class="purple">len</span>(RECIPES), <span class="green">"recipes"</span>)<br/><span class="orange">assert</span> <span class="purple">len</span>(RECIPES) == 11, <span class="green">"Expected 11 recipes"</span><br/><span class="orange">assert</span> checksum == 37296, <span class="green">"Error in recipes data"</span><br/><span class="purple">print</span>(<span class="green">"Recipe checksum:"</span>, checksum)<br/><br/><br/><span class="gray">#######################</span><br/><span class="gray">## PROP INTERACTIONS ##</span><br/><span class="gray">#######################</span><br/><span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list5"><em>Listing 10-5: Adding recipes to the</em> Escape <em>game</em></p>
<p class="indent">Now add the code to use the recipes near the end of the <code>use_object()</code> function, as shown in <a href="ch10.xhtml#ch10list6">Listing 10-6</a>. Add it to your <code>use_object()</code> function, and save the program as <em>listing10-5.py</em>. When you run the program, using <span class="codestrong">pgzrun listing10-5.py</span>, you’ll be able to combine objects.</p>
<p class="margin"><em>listing10-6.py</em></p>
<pre>   <span class="gray">--<span class="codeitalic1">snip</span>--</span><br/>               <span class="gray">sounds.say_airlock_open.play()</span><br/>               <span class="gray">show_text("The computer tells you the airlock is now open.", 1)</span><br/><br/><span class="ent">➊</span>     <span class="orange">for</span> recipe <span class="orange">in</span> RECIPES:<br/><span class="ent">➋</span>         ingredient1 = recipe[0]<br/>           ingredient2 = recipe[1]<br/>           combination = recipe[2]<br/><span class="ent">➌</span>         <span class="orange">if</span> (item_carrying == ingredient1<br/>               <span class="orange">and</span> item_player_is_on == ingredient2) \<br/><span class="ent">➍</span>             <span class="orange">or</span> (item_carrying == ingredient2<br/>                   <span class="orange">and</span> item_player_is_on == ingredient1):<br/><span epub:type="pagebreak" id="page_179"/><span class="ent">➎</span>             use_message = <span class="green">"You combine "</span> + objects[ingredient1][3] \<br/>                             + <span class="green">" and "</span> + objects[ingredient2][3] \<br/>                             + <span class="green">" to make "</span> + objects[combination][3]<br/><span class="ent">➏</span>             <span class="orange">if</span> item_player_is_on <span class="orange">in</span> props.keys():<br/><span class="ent">➐</span>                 props[item_player_is_on][0] = 0<br/><span class="ent">➑</span>                 room_map[player_y][player_x] = get_floor_type()<br/><span class="ent">➒</span>             in_my_pockets.remove(item_carrying)<br/><span class="ent">➓</span>             add_object(combination)<br/>               sounds.combine.play()<br/><br/>       <span class="gray">show_text(use_message, 0)</span><br/>       <span class="gray">time.sleep(0.5)</span><br/>   <span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list6"><em>Listing 10-6: Combining objects in the game</em></p>
<p class="indent">You might find you can work out what’s going on in this new code: it mostly combines ideas you’ve seen before. We use a loop to go through all the items in the <code>RECIPES</code> list <span class="ent">➊</span>, and a new recipe goes into the <code>recipe</code> list each time. We put the ingredients and combination object numbers into variables to make the function easier to understand <span class="ent">➋</span>.</p>
<p class="indent">The program checks whether the player is carrying the first ingredient and standing on the second one <span class="ent">➌</span>, or the other way around <span class="ent">➍</span>. If so, the use message is updated to tell them what they combined and what they made <span class="ent">➎</span>.</p>
<p class="indent">When the combined object is made, it usually replaces the ingredient objects. If one of the objects is scenery instead of a prop, though, it remains in the game. So the program checks whether the item the player is on is a prop <span class="ent">➏</span>, and if so, its room number is set to 0, removing it from the game <span class="ent">➐</span>. If it’s a prop, it’s also deleted from the room map for the current room <span class="ent">➑</span>.</p>
<p class="indent">The object that was being carried is removed from the player’s inventory <span class="ent">➒</span>, and the newly created object is added to it <span class="ent">➓</span>.</p>
<div class="sidebar">
<p class="sidebart" id="ch10sb1"><strong>TRAINING MISSION #1</strong></p>
<p class="spara">Let’s do a simple test to check that the combination code is working. We’ll need to hack the code a bit for this test. In the <code>PROPS</code> section, change the line that sets up <code>in_my_pockets</code> so you’re carrying items 73 and 74:</p>
<pre>in_my_pockets = [55, 73, 74]</pre>
<p class="spara1">Now run the program: you’ll be carrying the GPS module and the positioning system. Drop one of them and stand on it. Select the other one in your inventory, and press U. The items should be combined into a working GPS system! You can use it to see your location in the game. To be certain the code is working, try switching the objects so you’re standing on the other one this time.</p>
<p class="spara1">Make sure you change the code back again afterward:</p>
<pre>in_my_pockets = [55]</pre>
</div>
<h3 class="h3" id="lev135"><span epub:type="pagebreak" id="page_180"/><strong>ADDING THE GAME COMPLETION SEQUENCE</strong></h3>
<p class="noindent">There is one final function in the <code>USE OBJECTS</code> part of the program, which is a short animation that plays when the player completes the game: the astronaut takes off in the rescue ship. Add this function to the end of your <code>USE OBJECTS</code> section, as shown in <a href="ch10.xhtml#ch10list7">Listing 10-7</a>:</p>
<p class="margin"><em>listing10-7.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/>    <span class="gray">show_text(use_message, 0)</span><br/>    <span class="gray">time.sleep(0.5)</span><br/><br/><span class="orange">def</span> <span class="blue">game_completion_sequence</span>():<br/>    <span class="orange">global</span> launch_frame <span class="red">#(initial value is 0, set up in VARIABLES section)</span><br/>    box = Rect((0, 150), (800, 600))<br/>    screen.draw.filled_rect(box, (128, 0, 0))<br/>    box = Rect ((0, top_left_y - 30), (800, 390))<br/>    screen.surface.set_clip(box)<br/><br/>    <span class="orange">for</span> y <span class="orange">in</span> <span class="purple">range</span>(0, 13):<br/>        <span class="orange">for</span> x <span class="orange">in</span> <span class="purple">range</span>(0, 13):<br/>            draw_image(images.soil, y, x)<br/><br/>    launch_frame += 1<br/>    <span class="orange">if</span> launch_frame &lt; 9:<br/>        draw_image(images.rescue_ship, 8 - launch_frame, 6)<br/>        draw_shadow(images.rescue_ship_shadow, 8 + launch_frame, 6)<br/>        clock.schedule(game_completion_sequence, 0.25)<br/>    <span class="orange">else</span>:<br/>        screen.surface.set_clip(<span class="orange">None</span>)<br/>        screen.draw.text(<span class="green">"MISSION"</span>, (200, 380), color = <span class="green">"white"</span>,<br/>                     fontsize = 128, shadow = (1, 1), scolor = <span class="green">"black"</span>)<br/>        screen.draw.text(<span class="green">"COMPLETE"</span>, (145, 480), color = <span class="green">"white"</span>,<br/>                     fontsize = 128, shadow = (1, 1), scolor = <span class="green">"black"</span>)<br/>        sounds.completion.play()<br/>        sounds.say_mission_complete.play()<br/><br/><span class="gray">###############</span><br/><span class="gray">##   START   ##</span><br/><span class="gray">###############</span><br/><span class="gray">--<span class="codeitalic1">snip</span>--</span></pre>
<p class="listing" id="ch10list7"><em>Listing 10-7: Blast off!</em></p>
<h3 class="h3" id="lev136"><strong>EXPLORING THE OBJECTS</strong></h3>
<p class="noindent">Now you can explore the objects you find in the space station and try using them to see what they do. Before you can find all the props, though, and get to work on the space station, you’ll need to work out how to open the safety doors that seal off parts of the space station. In the next chapter, you’ll complete the space station setup by engineering the door mechanism to open when you use the correct access pass.</p>
<p class="indent"><span epub:type="pagebreak" id="page_181"/>You can also use what you’ve learned in this chapter to add your own puzzles to the <em>Escape</em> game code. The simplest approach is to use standard messages (<a href="ch10.xhtml#ch10list2">Listing 10-2</a>) for clues and to use recipes (<a href="ch10.xhtml#ch10list5">Listing 10-5</a>) to combine objects. You can also add simple instructions (<a href="ch10.xhtml#ch10list4">Listing 10-4</a>) to see whether the player is carrying a particular object, and then increase their <code>air</code> or <code>energy</code> variables, display a message, or do something else in the game. Happy adventuring!</p>
<h3 class="h3" id="lev137"><strong>ARE YOU FIT TO FLY?</strong></h3>
<p class="noindentb">Check the following boxes to confirm that you’ve learned the key lessons in this chapter.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  The instructions for using objects go into the <code>use_object()</code> function.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  The <code>standard_responses</code> dictionary contains messages for when the player uses a particular object.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  For many objects, there are specific instructions to update different lists or variables when the player uses them.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  The <code>RECIPES</code> list stores the details of how the player can combine objects in the game.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  In a recipe, the first two items are ingredients, and the third item is what they make.<span epub:type="pagebreak" id="page_182"/></p>
</body></html>