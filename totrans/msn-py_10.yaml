- en: '**10'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: MAKE YOURSELF USEFUL**
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/common01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You’ve added the props to the game, so in this chapter, you’ll add the code
    to enable astronauts to *use* objects and combine them to make new objects. These
    skills will be essential for your mission. You’ll get a chance to rehearse them,
    so you’re ready for any situation.
  prefs: []
  type: TYPE_NORMAL
- en: The code in this chapter is simpler than some of the listings you’ve seen recently
    and contains the answers for many of the puzzles in the *Escape* game. So I don’t
    give away too many spoilers, I won’t explain every item and solution here. For
    example, sometimes you might see an object number in the code, but I won’t tell
    you the name of that object.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you get stuck playing the game, you could read this code and use it to work
    out which objects are which by referring to the objects dictionary (see [Listing
    5-6](ch05.xhtml#ch05list6) and [Listing 5-8](ch05.xhtml#ch05list8) in [Chapter
    5](ch05.xhtml#ch05)). That should be a last resort, though. You can solve all
    the puzzles by thinking like an astronaut. Ask yourself: What do you have access
    to that could be useful? How could you make something more useful?'
  prefs: []
  type: TYPE_NORMAL
- en: '**ADDING THE KEYBOARD CONTROL FOR USING OBJECTS**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We’ll start by adding the keyboard control in the game_loop() function. Open
    *listing9-10.py*, your last listing in [Chapter 9](ch09.xhtml#ch09). We’ll build
    on this listing.
  prefs: []
  type: TYPE_NORMAL
- en: 'Listing 10-1 shows the new instructions to add inside the game_loop() function.
    Add them after the keyboard controls for *drop* and *examine*, which you added
    in the previous chapter. These instructions start the use_object() function when
    the player presses the U key. Save the program as *listing10-1.py*. Don’t try
    running the program yet: it won’t do anything new, but it will crash if you press
    the U key.'
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-1.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: 'if keyboard.space:'
  prefs: []
  type: TYPE_NORMAL
- en: examine_object()
  prefs: []
  type: TYPE_NORMAL
- en: 'if keyboard.u:'
  prefs: []
  type: TYPE_NORMAL
- en: use_object()
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-1: Adding the keyboard control for using objects*'
  prefs: []
  type: TYPE_NORMAL
- en: '**ADDING STANDARD MESSAGES FOR USING OBJECTS**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The function for using objects is long, so I’ve given it its own section in
    the program. Place the new USE OBJECTS section after the PROP INTERACTIONS section
    that you added in [Chapter 9](ch09.xhtml#ch09). [Listing 10-2](ch10.xhtml#ch10list2)
    shows the start of this new section. Add this code after the examine_object()
    function ends but before the START section.
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-2.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: show_text(description, 0)
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: '#################'
  prefs: []
  type: TYPE_NORMAL
- en: '## USE OBJECTS ##'
  prefs: []
  type: TYPE_NORMAL
- en: '#################'
  prefs: []
  type: TYPE_NORMAL
- en: 'def use_object():'
  prefs: []
  type: TYPE_NORMAL
- en: global room_map, props, item_carrying, air, selected_item, energy
  prefs: []
  type: TYPE_NORMAL
- en: global in_my_pockets, suit_stitched, air_fixed, game_over
  prefs: []
  type: TYPE_NORMAL
- en: ➊     use_message = "You fiddle around with it but don't get anywhere."
  prefs: []
  type: TYPE_NORMAL
- en: ➋     standard_responses = {
  prefs: []
  type: TYPE_NORMAL
- en: '4: "Air is running out! You can''t take this lying down!",'
  prefs: []
  type: TYPE_NORMAL
- en: '6: "This is no time to sit around!",'
  prefs: []
  type: TYPE_NORMAL
- en: '7: "This is no time to sit around!",'
  prefs: []
  type: TYPE_NORMAL
- en: '32: "It shakes and rumbles, but nothing else happens.",'
  prefs: []
  type: TYPE_NORMAL
- en: '34: "Ah! That''s better. Now wash your hands.",'
  prefs: []
  type: TYPE_NORMAL
- en: '35: "You wash your hands and shake the water off.",'
  prefs: []
  type: TYPE_NORMAL
- en: '37: "The test tubes smoke slightly as you shake them.",'
  prefs: []
  type: TYPE_NORMAL
- en: '54: "You chew the gum. It''s sticky like glue.",'
  prefs: []
  type: TYPE_NORMAL
- en: '55: "The yoyo bounces up and down, slightly slower than on Earth",'
  prefs: []
  type: TYPE_NORMAL
- en: '56: "It''s a bit too fiddly. Can you thread it on something?",'
  prefs: []
  type: TYPE_NORMAL
- en: '59: "You need to fix the leak before you can use the canister",'
  prefs: []
  type: TYPE_NORMAL
- en: '61: "You try signalling with the mirror, but nobody can see you.",'
  prefs: []
  type: TYPE_NORMAL
- en: '62: "Don''t throw resources away. Things might come in handy...",'
  prefs: []
  type: TYPE_NORMAL
- en: '67: "To enjoy yummy space food, just add water!",'
  prefs: []
  type: TYPE_NORMAL
- en: '75: "You are at Sector: " + str(current_room) + " // X: " \'
  prefs: []
  type: TYPE_NORMAL
- en: '+ str(player_x) + " // Y: " + str(player_y)'
  prefs: []
  type: TYPE_NORMAL
- en: '}'
  prefs: []
  type: TYPE_NORMAL
- en: '# Get object number at player''s location.'
  prefs: []
  type: TYPE_NORMAL
- en: ➌     item_player_is_on = get_item_under_player()
  prefs: []
  type: TYPE_NORMAL
- en: '➍     for this_item in [item_player_is_on, item_carrying]:'
  prefs: []
  type: TYPE_NORMAL
- en: '➎         if this_item in standard_responses:'
  prefs: []
  type: TYPE_NORMAL
- en: ➏             use_message = standard_responses[this_item]
  prefs: []
  type: TYPE_NORMAL
- en: ➐     show_text(use_message, 0)
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: '##   START   ##'
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-2: Adding the first instructions for using objects*'
  prefs: []
  type: TYPE_NORMAL
- en: '[Listing 10-2](ch10.xhtml#ch10list2) shows the first part of the use_object()
    function. We’ll flesh this out in further listings in this chapter. At the end
    of the function, the program shows players a message to tell them what happened
    when they tried to use the object ➐. That message will be in the use_message variable.
    At the start of this function, we set it up as an error message ➊. Later on, it
    will be changed to a message of success if they used an object.'
  prefs: []
  type: TYPE_NORMAL
- en: Some of the objects have no real function in the game but will reward the player
    with a message when they try to use them. These messages could include clues as
    well as add to the game story. The dictionary standard_responses contains messages
    to show players when they use certain objects ➋. The dictionary key is the object
    number. For example, if they want to use the bed (lazy bones!), which is object
    4, they see a message that says, “You can’t take this lying down!”
  prefs: []
  type: TYPE_NORMAL
- en: 'The variable item_the_player_is_on stores the object number at the player’s
    position in the room ➌. Players can use objects they are carrying or standing
    on. We set up a loop that goes through a list that contains two items: the item
    number the player is standing on and the item number the player is carrying ➍.
    If either of them is a key for the standard_responses dictionary ➎, the use_message
    is updated to the object’s message from that dictionary ➏. The program prioritizes
    items you’re carrying over items you’re standing on if they both have standard
    messages.'
  prefs: []
  type: TYPE_NORMAL
- en: Save your file as *listing10-2.py*. Run it using pgzrun listing10-2.py. To test
    that it works, press U to use the yoyo you’re carrying.
  prefs: []
  type: TYPE_NORMAL
- en: '**ADDING THE GAME PROGRESS VARIABLES**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'There are a few new variables we need to add to the program to store important
    data about the player’s progress in the game:'
  prefs: []
  type: TYPE_NORMAL
- en: air, which stores how much air you have available, as a percentage
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: energy, which stores your energy, as a percentage, and will be reduced if you
    injure yourself
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: suit_stitched, which stores a True or False value, depending on whether the
    suit has been repaired
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: air_fixed, which stores a True or False value, depending on whether the air
    tank has been fixed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Add the variables to the end of the VARIABLES section, as shown in [Listing
    10-3](ch10.xhtml#ch10list3). Save your updated program as *listing10-3.py*. This
    program won’t do anything new if you run it: we’ve set up some variables but aren’t
    doing anything with them yet.'
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-3.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: GREEN = (0, 255, 0)
  prefs: []
  type: TYPE_NORMAL
- en: RED = (128, 0, 0)
  prefs: []
  type: TYPE_NORMAL
- en: air, energy = 100, 100
  prefs: []
  type: TYPE_NORMAL
- en: suit_stitched, air_fixed = False, False
  prefs: []
  type: TYPE_NORMAL
- en: launch_frame = 0
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: '##    MAP    ##'
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-3: Adding the game progress variables*'
  prefs: []
  type: TYPE_NORMAL
- en: '**ADDING THE ACTIONS FOR SPECIFIC OBJECTS**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The next stage in the use_object() function is to check particular objects to
    see if they have actions that can be performed with them. These checks will override
    any standard messages that might have been set up earlier and are shown in [Listing
    10-4](ch10.xhtml#ch10list4). Because these instructions are inside the use_object()
    function, they are indented by at least four spaces. Save your program as *listing10-4.py*.
    Run it using pgzrun listing10-4.py.
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-4.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: 'if this_item in standard_responses:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message = standard_responses[this_item]
  prefs: []
  type: TYPE_NORMAL
- en: '➊     if item_carrying == 70 or item_player_is_on == 70:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "Banging tunes!"
  prefs: []
  type: TYPE_NORMAL
- en: sounds.steelmusic.play(2)
  prefs: []
  type: TYPE_NORMAL
- en: '➋     elif item_player_is_on == 11:'
  prefs: []
  type: TYPE_NORMAL
- en: '➌         use_message = "AIR: " + str(air) + \'
  prefs: []
  type: TYPE_NORMAL
- en: '"% / ENERGY " + str(energy) + "% / "'
  prefs: []
  type: TYPE_NORMAL
- en: 'if not suit_stitched:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message += "*ALERT* SUIT FABRIC TORN / "
  prefs: []
  type: TYPE_NORMAL
- en: 'if not air_fixed:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message += "*ALERT* SUIT AIR BOTTLE MISSING"
  prefs: []
  type: TYPE_NORMAL
- en: 'if suit_stitched and air_fixed:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message += " SUIT OK"
  prefs: []
  type: TYPE_NORMAL
- en: show_text(use_message, 0)
  prefs: []
  type: TYPE_NORMAL
- en: sounds.say_status_report.play()
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: '# If "on" the computer, player intention is clearly status update.'
  prefs: []
  type: TYPE_NORMAL
- en: '# Return to stop another object use accidentally overriding this.'
  prefs: []
  type: TYPE_NORMAL
- en: ➍         return
  prefs: []
  type: TYPE_NORMAL
- en: 'elif item_carrying == 60 or item_player_is_on == 60:'
  prefs: []
  type: TYPE_NORMAL
- en: ➎         use_message = "You fix " + objects[60][3] + " to the suit"
  prefs: []
  type: TYPE_NORMAL
- en: air_fixed = True
  prefs: []
  type: TYPE_NORMAL
- en: air = 90
  prefs: []
  type: TYPE_NORMAL
- en: air_countdown()
  prefs: []
  type: TYPE_NORMAL
- en: remove_object(60)
  prefs: []
  type: TYPE_NORMAL
- en: elif (item_carrying == 58 or item_player_is_on == 58) \
  prefs: []
  type: TYPE_NORMAL
- en: 'and not suit_stitched:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You use " + objects[56][3] + \
  prefs: []
  type: TYPE_NORMAL
- en: '" to repair the suit fabric"'
  prefs: []
  type: TYPE_NORMAL
- en: suit_stitched = True
  prefs: []
  type: TYPE_NORMAL
- en: remove_object(58)
  prefs: []
  type: TYPE_NORMAL
- en: 'elif item_carrying == 72 or item_player_is_on == 72:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You radio for help. A rescue ship is coming. \
  prefs: []
  type: TYPE_NORMAL
- en: Rendezvous Sector 13, outside."
  prefs: []
  type: TYPE_NORMAL
- en: props[40][0] = 13
  prefs: []
  type: TYPE_NORMAL
- en: elif (item_carrying == 66 or item_player_is_on == 66) \
  prefs: []
  type: TYPE_NORMAL
- en: 'and current_room in outdoor_rooms:'
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You dig..."
  prefs: []
  type: TYPE_NORMAL
- en: if (current_room == LANDER_SECTOR
  prefs: []
  type: TYPE_NORMAL
- en: and player_x == LANDER_X
  prefs: []
  type: TYPE_NORMAL
- en: 'and player_y == LANDER_Y):'
  prefs: []
  type: TYPE_NORMAL
- en: add_object(71)
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You found the Poodle lander!"
  prefs: []
  type: TYPE_NORMAL
- en: 'elif item_player_is_on == 40:'
  prefs: []
  type: TYPE_NORMAL
- en: clock.unschedule(air_countdown)
  prefs: []
  type: TYPE_NORMAL
- en: show_text("Congratulations, "+ PLAYER_NAME +"!", 0)
  prefs: []
  type: TYPE_NORMAL
- en: show_text("Mission success! You have made it to safety.", 1)
  prefs: []
  type: TYPE_NORMAL
- en: game_over = True
  prefs: []
  type: TYPE_NORMAL
- en: sounds.take_off.play()
  prefs: []
  type: TYPE_NORMAL
- en: game_completion_sequence()
  prefs: []
  type: TYPE_NORMAL
- en: 'elif item_player_is_on == 16:'
  prefs: []
  type: TYPE_NORMAL
- en: energy += 1
  prefs: []
  type: TYPE_NORMAL
- en: 'if energy > 100:'
  prefs: []
  type: TYPE_NORMAL
- en: energy = 100
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You munch the lettuce and get a little energy back"
  prefs: []
  type: TYPE_NORMAL
- en: draw_energy_air()
  prefs: []
  type: TYPE_NORMAL
- en: 'elif item_carrying == 68 or item_player_is_on == 68:'
  prefs: []
  type: TYPE_NORMAL
- en: energy = 100
  prefs: []
  type: TYPE_NORMAL
- en: use_message = "You use the food to restore your energy"
  prefs: []
  type: TYPE_NORMAL
- en: remove_object(68)
  prefs: []
  type: TYPE_NORMAL
- en: draw_energy_air()
  prefs: []
  type: TYPE_NORMAL
- en: 'if suit_stitched and air_fixed: # open airlock access'
  prefs: []
  type: TYPE_NORMAL
- en: 'if current_room == 31 and props[20][0] == 31:'
  prefs: []
  type: TYPE_NORMAL
- en: 'open_door(20) # which includes removing the door'
  prefs: []
  type: TYPE_NORMAL
- en: sounds.say_airlock_open.play()
  prefs: []
  type: TYPE_NORMAL
- en: show_text("The computer tells you the airlock is now open.", 1)
  prefs: []
  type: TYPE_NORMAL
- en: 'elif props[20][0] == 31:'
  prefs: []
  type: TYPE_NORMAL
- en: 'props[20][0] = 0 # remove door from map'
  prefs: []
  type: TYPE_NORMAL
- en: sounds.say_airlock_open.play()
  prefs: []
  type: TYPE_NORMAL
- en: show_text("The computer tells you the airlock is now open.", 1)
  prefs: []
  type: TYPE_NORMAL
- en: show_text(use_message, 0)
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: '##   START   ##'
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-4: Adding the ability to use certain objects*'
  prefs: []
  type: TYPE_NORMAL
- en: '[Listing 10-4](ch10.xhtml#ch10list4) includes a series of instructions that
    check whether the object that’s being used is a particular object number. If so,
    the instructions for that object are carried out.'
  prefs: []
  type: TYPE_NORMAL
- en: For example, if the player is carrying or standing on object 70 ➊, which is
    an MP3 player, they’ll see a message that says “Banging tunes!” and hear some
    music. If the player is using the computer ➋, the message shown is made by combining
    information from the air and energy variables, and adding an alert if the suit
    or air bottle is faulty. There’s also a computer speech sound effect here that
    says “status report!”
  prefs: []
  type: TYPE_NORMAL
- en: I’ve included a return instruction at the end of this set of instructions ➍,
    which prevents the player from accidentally using another object when they intended
    to use the computer. If we didn’t include this return instruction, the player
    might end up using another prop that they’re carrying instead of the computer.
    Keeping the controls simple means there can be some ambiguity about what the player
    intended to use, but the game is designed to prioritize results that help the
    player complete the game.
  prefs: []
  type: TYPE_NORMAL
- en: In a couple of places, I’ve used the short description from the objects dictionary
    instead of typing the name of the object into the string ➎. That’s to prevent
    you from seeing any spoilers in the code!
  prefs: []
  type: TYPE_NORMAL
- en: The \ symbol at the end of a line ➌ tells Python that the code continues on
    the next line. Some of the lines here are quite long, so I’ve used this symbol
    to break them up and to fit them on the book page.
  prefs: []
  type: TYPE_NORMAL
- en: Try out some of the new code by walking into one of the computer terminals and
    pressing the U key. You’ll see a status update. If you can find the MP3 player,
    you can listen to that too.
  prefs: []
  type: TYPE_NORMAL
- en: '**RED ALERT**'
  prefs: []
  type: TYPE_NORMAL
- en: '*Be particularly careful when you’re entering the object numbers and the rest
    of the code in [Listing 10-4](ch10.xhtml#ch10list4). If you make a mistake here,
    you might not be able to complete the puzzles in the game!*'
  prefs: []
  type: TYPE_NORMAL
- en: '**COMBINING OBJECTS**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Some of the puzzles in the game require you to use objects together. For example,
    you might use one object as a tool to do something to the other object, or you
    might join two objects together. For instance, one of the puzzles requires you
    to insert a GPS module into a positioning system. When you find the two parts,
    you need to combine them to make a working positioning system. To use two objects
    together, you select one in your inventory and walk on or into the other one.
    You might need to drop an object from your inventory onto the floor so you can
    work on it with another object you’re carrying.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the *Escape* game engine, combinations are called *recipes*. A single recipe
    contains three object numbers in a list. The first two are the items that are
    combined, and the third one is the object number they make when they’re combined.
    Here’s an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[73, 74, 75]'
  prefs: []
  type: TYPE_NORMAL
- en: Object 73 (a GPS module) plus object 74 (a positioning system) makes object
    75 (a working positioning system).
  prefs: []
  type: TYPE_NORMAL
- en: When you combine objects, the new object goes into your inventory. The objects
    you combined are removed from the game if they’re props. Sometimes one will be
    a piece of scenery and so will remain in the game.
  prefs: []
  type: TYPE_NORMAL
- en: '[Listing 10-5](ch10.xhtml#ch10list5) shows you the list of recipes. Add it
    to the end of the PROPS part of your program where the information for props is
    set up. Save your file as *listing10-5.py*. The listing shouldn’t do anything
    new yet if you run it, but it will check that the new data is correct.'
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-5.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: in_my_pockets = [55]
  prefs: []
  type: TYPE_NORMAL
- en: 'selected_item = 0 # the first item'
  prefs: []
  type: TYPE_NORMAL
- en: item_carrying = in_my_pockets[selected_item]
  prefs: []
  type: TYPE_NORMAL
- en: RECIPES = [
  prefs: []
  type: TYPE_NORMAL
- en: '[62, 35, 63], [76, 28, 77], [78, 38, 54], [73, 74, 75],'
  prefs: []
  type: TYPE_NORMAL
- en: '[59, 54, 60], [77, 55, 56], [56, 57, 58], [71, 65, 72],'
  prefs: []
  type: TYPE_NORMAL
- en: '[88, 58, 89], [89, 60, 90], [67, 35, 68]'
  prefs: []
  type: TYPE_NORMAL
- en: ']'
  prefs: []
  type: TYPE_NORMAL
- en: checksum = 0
  prefs: []
  type: TYPE_NORMAL
- en: check_counter = 1
  prefs: []
  type: TYPE_NORMAL
- en: 'for recipe in RECIPES:'
  prefs: []
  type: TYPE_NORMAL
- en: checksum += (recipe[0] * check_counter
  prefs: []
  type: TYPE_NORMAL
- en: + recipe[1] * (check_counter + 1)
  prefs: []
  type: TYPE_NORMAL
- en: + recipe[2] * (check_counter + 2))
  prefs: []
  type: TYPE_NORMAL
- en: check_counter += 3
  prefs: []
  type: TYPE_NORMAL
- en: print(len(RECIPES), "recipes")
  prefs: []
  type: TYPE_NORMAL
- en: assert len(RECIPES) == 11, "Expected 11 recipes"
  prefs: []
  type: TYPE_NORMAL
- en: assert checksum == 37296, "Error in recipes data"
  prefs: []
  type: TYPE_NORMAL
- en: print("Recipe checksum:", checksum)
  prefs: []
  type: TYPE_NORMAL
- en: '#######################'
  prefs: []
  type: TYPE_NORMAL
- en: 'PROP INTERACTIONS ##'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '#######################'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-5: Adding recipes to the* Escape *game*'
  prefs: []
  type: TYPE_NORMAL
- en: Now add the code to use the recipes near the end of the use_object() function,
    as shown in [Listing 10-6](ch10.xhtml#ch10list6). Add it to your use_object()
    function, and save the program as *listing10-5.py*. When you run the program,
    using pgzrun listing10-5.py, you’ll be able to combine objects.
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-6.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: sounds.say_airlock_open.play()
  prefs: []
  type: TYPE_NORMAL
- en: show_text("The computer tells you the airlock is now open.", 1)
  prefs: []
  type: TYPE_NORMAL
- en: '➊     for recipe in RECIPES:'
  prefs: []
  type: TYPE_NORMAL
- en: ➋         ingredient1 = recipe[0]
  prefs: []
  type: TYPE_NORMAL
- en: ingredient2 = recipe[1]
  prefs: []
  type: TYPE_NORMAL
- en: combination = recipe[2]
  prefs: []
  type: TYPE_NORMAL
- en: ➌         if (item_carrying == ingredient1
  prefs: []
  type: TYPE_NORMAL
- en: and item_player_is_on == ingredient2) \
  prefs: []
  type: TYPE_NORMAL
- en: ➍             or (item_carrying == ingredient2
  prefs: []
  type: TYPE_NORMAL
- en: 'and item_player_is_on == ingredient1):'
  prefs: []
  type: TYPE_NORMAL
- en: ➎             use_message = "You combine " + objects[ingredient1][3] \
  prefs: []
  type: TYPE_NORMAL
- en: + " and " + objects[ingredient2][3] \
  prefs: []
  type: TYPE_NORMAL
- en: + " to make " + objects[combination][3]
  prefs: []
  type: TYPE_NORMAL
- en: '➏             if item_player_is_on in props.keys():'
  prefs: []
  type: TYPE_NORMAL
- en: ➐                 props[item_player_is_on][0] = 0
  prefs: []
  type: TYPE_NORMAL
- en: ➑                 room_map[player_y][player_x] = get_floor_type()
  prefs: []
  type: TYPE_NORMAL
- en: ➒             in_my_pockets.remove(item_carrying)
  prefs: []
  type: TYPE_NORMAL
- en: ➓             add_object(combination)
  prefs: []
  type: TYPE_NORMAL
- en: sounds.combine.play()
  prefs: []
  type: TYPE_NORMAL
- en: show_text(use_message, 0)
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-6: Combining objects in the game*'
  prefs: []
  type: TYPE_NORMAL
- en: 'You might find you can work out what’s going on in this new code: it mostly
    combines ideas you’ve seen before. We use a loop to go through all the items in
    the RECIPES list ➊, and a new recipe goes into the recipe list each time. We put
    the ingredients and combination object numbers into variables to make the function
    easier to understand ➋.'
  prefs: []
  type: TYPE_NORMAL
- en: The program checks whether the player is carrying the first ingredient and standing
    on the second one ➌, or the other way around ➍. If so, the use message is updated
    to tell them what they combined and what they made ➎.
  prefs: []
  type: TYPE_NORMAL
- en: When the combined object is made, it usually replaces the ingredient objects.
    If one of the objects is scenery instead of a prop, though, it remains in the
    game. So the program checks whether the item the player is on is a prop ➏, and
    if so, its room number is set to 0, removing it from the game ➐. If it’s a prop,
    it’s also deleted from the room map for the current room ➑.
  prefs: []
  type: TYPE_NORMAL
- en: The object that was being carried is removed from the player’s inventory ➒,
    and the newly created object is added to it ➓.
  prefs: []
  type: TYPE_NORMAL
- en: '**TRAINING MISSION #1**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s do a simple test to check that the combination code is working. We’ll
    need to hack the code a bit for this test. In the PROPS section, change the line
    that sets up in_my_pockets so you’re carrying items 73 and 74:'
  prefs: []
  type: TYPE_NORMAL
- en: in_my_pockets = [55, 73, 74]
  prefs: []
  type: TYPE_NORMAL
- en: 'Now run the program: you’ll be carrying the GPS module and the positioning
    system. Drop one of them and stand on it. Select the other one in your inventory,
    and press U. The items should be combined into a working GPS system! You can use
    it to see your location in the game. To be certain the code is working, try switching
    the objects so you’re standing on the other one this time.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Make sure you change the code back again afterward:'
  prefs: []
  type: TYPE_NORMAL
- en: in_my_pockets = [55]
  prefs: []
  type: TYPE_NORMAL
- en: '**ADDING THE GAME COMPLETION SEQUENCE**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'There is one final function in the USE OBJECTS part of the program, which is
    a short animation that plays when the player completes the game: the astronaut
    takes off in the rescue ship. Add this function to the end of your USE OBJECTS
    section, as shown in [Listing 10-7](ch10.xhtml#ch10list7):'
  prefs: []
  type: TYPE_NORMAL
- en: '*listing10-7.py*'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: show_text(use_message, 0)
  prefs: []
  type: TYPE_NORMAL
- en: time.sleep(0.5)
  prefs: []
  type: TYPE_NORMAL
- en: 'def game_completion_sequence():'
  prefs: []
  type: TYPE_NORMAL
- en: 'global launch_frame #(initial value is 0, set up in VARIABLES section)'
  prefs: []
  type: TYPE_NORMAL
- en: box = Rect((0, 150), (800, 600))
  prefs: []
  type: TYPE_NORMAL
- en: screen.draw.filled_rect(box, (128, 0, 0))
  prefs: []
  type: TYPE_NORMAL
- en: box = Rect ((0, top_left_y - 30), (800, 390))
  prefs: []
  type: TYPE_NORMAL
- en: screen.surface.set_clip(box)
  prefs: []
  type: TYPE_NORMAL
- en: 'for y in range(0, 13):'
  prefs: []
  type: TYPE_NORMAL
- en: 'for x in range(0, 13):'
  prefs: []
  type: TYPE_NORMAL
- en: draw_image(images.soil, y, x)
  prefs: []
  type: TYPE_NORMAL
- en: launch_frame += 1
  prefs: []
  type: TYPE_NORMAL
- en: 'if launch_frame < 9:'
  prefs: []
  type: TYPE_NORMAL
- en: draw_image(images.rescue_ship, 8 - launch_frame, 6)
  prefs: []
  type: TYPE_NORMAL
- en: draw_shadow(images.rescue_ship_shadow, 8 + launch_frame, 6)
  prefs: []
  type: TYPE_NORMAL
- en: clock.schedule(game_completion_sequence, 0.25)
  prefs: []
  type: TYPE_NORMAL
- en: 'else:'
  prefs: []
  type: TYPE_NORMAL
- en: screen.surface.set_clip(None)
  prefs: []
  type: TYPE_NORMAL
- en: screen.draw.text("MISSION", (200, 380), color = "white",
  prefs: []
  type: TYPE_NORMAL
- en: fontsize = 128, shadow = (1, 1), scolor = "black")
  prefs: []
  type: TYPE_NORMAL
- en: screen.draw.text("COMPLETE", (145, 480), color = "white",
  prefs: []
  type: TYPE_NORMAL
- en: fontsize = 128, shadow = (1, 1), scolor = "black")
  prefs: []
  type: TYPE_NORMAL
- en: sounds.completion.play()
  prefs: []
  type: TYPE_NORMAL
- en: sounds.say_mission_complete.play()
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: '##   START   ##'
  prefs: []
  type: TYPE_NORMAL
- en: '###############'
  prefs: []
  type: TYPE_NORMAL
- en: --snip--
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-7: Blast off!*'
  prefs: []
  type: TYPE_NORMAL
- en: '**EXPLORING THE OBJECTS**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Now you can explore the objects you find in the space station and try using
    them to see what they do. Before you can find all the props, though, and get to
    work on the space station, you’ll need to work out how to open the safety doors
    that seal off parts of the space station. In the next chapter, you’ll complete
    the space station setup by engineering the door mechanism to open when you use
    the correct access pass.
  prefs: []
  type: TYPE_NORMAL
- en: You can also use what you’ve learned in this chapter to add your own puzzles
    to the *Escape* game code. The simplest approach is to use standard messages ([Listing
    10-2](ch10.xhtml#ch10list2)) for clues and to use recipes ([Listing 10-5](ch10.xhtml#ch10list5))
    to combine objects. You can also add simple instructions ([Listing 10-4](ch10.xhtml#ch10list4))
    to see whether the player is carrying a particular object, and then increase their
    air or energy variables, display a message, or do something else in the game.
    Happy adventuring!
  prefs: []
  type: TYPE_NORMAL
- en: '**ARE YOU FIT TO FLY?**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Check the following boxes to confirm that you’ve learned the key lessons in
    this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: '![Images](../images/box.jpg)  The instructions for using objects go into the
    use_object() function.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Images](../images/box.jpg)  The standard_responses dictionary contains messages
    for when the player uses a particular object.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Images](../images/box.jpg)  For many objects, there are specific instructions
    to update different lists or variables when the player uses them.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Images](../images/box.jpg)  The RECIPES list stores the details of how the
    player can combine objects in the game.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Images](../images/box.jpg)  In a recipe, the first two items are ingredients,
    and the third item is what they make.'
  prefs: []
  type: TYPE_NORMAL
