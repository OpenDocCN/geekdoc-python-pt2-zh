<html><head></head><body>
<h2 class="h2" id="ch01"><span epub:type="pagebreak" id="page_13"/><strong><span class="blue"><span class="big">1</span></span><br/>YOUR FIRST SPACEWALK</strong></h2>
<div class="image1"><img src="../images/common01.jpg" alt="image"/></div>
<p class="noindent">Welcome to the space corps. Your mission is to build the first human outpost on Mars. For years, the world’s greatest scientists have been sending robots to study it up close. Soon you too will set foot on its dusty surface.</p>
<p class="indent">Travel to Mars takes between six and eight months, depending on how Earth and Mars are aligned. During the journey, the spaceship risks hitting meteoroids and other space debris. If any damage occurs, you’ll need to put on your spacesuit, go to the airlock, and then step into the void of space to make repairs, similar to the astronaut in <a href="ch01.xhtml#ch01fig1">Figure 1-1</a>.</p>
<p class="indent">In this chapter, you’ll go on a spacewalk by using Python to move a character around the screen. You’ll launch your first Python program and learn some of the essential Python instructions you’ll need to build the space station later in the book. You’ll also learn how to create a sense of depth by overlapping images, which will prove essential when we create the <em>Escape</em> game in 3D later (starting with our first room mock-up in <a href="ch03.xhtml#ch03">Chapter 3</a>).</p>
<div class="image"><span epub:type="pagebreak" id="page_14"/><a id="ch01fig1"/><img src="../images/fig1-1.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-1: NASA astronaut Rick Mastracchio on a 26-minute spacewalk in 2010, as photographed by astronaut Clayton Anderson. The spacewalk outside the International Space Station was one of a series to replace coolant tanks.</em></p>
<p class="indent">If you haven’t already installed Python and Pygame Zero (Windows users), see “<a href="intro.xhtml#lev3">Installing the Software</a>” on <a href="intro.xhtml#page_3">page 3</a>. You’ll also need the <em>Escape</em> game files in this chapter. “<a href="intro.xhtml#lev8">Downloading the Game Files</a>” on <a href="intro.xhtml#page_7">page 7</a> tells you how to download and unzip those files.</p>
<h3 class="h3" id="lev16"><strong>STARTING THE PYTHON EDITOR</strong></h3>
<p class="noindent">As I mentioned in the Introduction, in this book we’ll use the Python programming language. A programming language provides a way to write instructions for a computer. Our instructions will tell the computer how to do things like react to a keypress or display an image. We’ll also be using Pygame Zero, which gives Python some additional instructions for handling sound and images.</p>
<p class="indent">Python comes with the IDLE editor, and we’ll use the editor to create our Python programs. Because you’ve already installed Python, IDLE should now be on your computer as well. The following sections explain how to start IDLE, depending on the type of computer you’re using.</p>
<h4 class="h4" id="lev17"><strong>STARTING IDLE IN WINDOWS 10</strong></h4>
<p class="noindent">To start IDLE in Windows 10, follow these steps:</p>
<ol>
<li class="noindent">Click the Cortana search box at the bottom of the screen, and enter <span class="codestrong">Python</span> in the box.</li>
<li class="noindent">Click <strong>IDLE</strong> to open it.</li>
<li class="noindent"><span epub:type="pagebreak" id="page_15"/>With IDLE running, right-click its icon in the taskbar at the bottom of the screen and pin it. Then you can run it from there in the future using a single click.</li>
</ol>
<h4 class="h4" id="lev18"><strong>STARTING IDLE IN WINDOWS 8</strong></h4>
<p class="noindent">To start IDLE in Windows 8, follow these steps:</p>
<ol>
<li class="noindent">Move your mouse to the top right of the screen to show the Charms bar.</li>
<li class="noindent">Click the Search icon, and enter <span class="codestrong">Python</span> in the box.</li>
<li class="noindent">Click <strong>IDLE</strong> to open it.</li>
<li class="noindent">With IDLE running, right-click its icon in the taskbar at the bottom of the screen and pin it. Then you can run it from there in the future using a single click.</li>
</ol>
<h4 class="h4" id="lev19"><strong>STARTING IDLE ON THE RASPBERRY PI</strong></h4>
<p class="noindent">To start IDLE on the Raspberry Pi, follow these steps:</p>
<ol>
<li class="noindent">Click the Programs menu at the top left of the screen.</li>
<li class="noindent">Find the Programming category.</li>
<li class="noindent">Click the Python 3 (IDLE) icon. The Raspberry Pi has both Python 2 and Python 3 installed, but most of the programs in this book will work only in Python 3.</li>
</ol>
<h3 class="h3" id="lev20"><strong>INTRODUCING THE PYTHON SHELL</strong></h3>
<p class="noindent">When you start IDLE, you should see the Python <em>shell</em>, as shown in <a href="ch01.xhtml#ch01fig2">Figure 1-2</a>. This window is where you can give Python instructions and immediately see the computer respond. The three arrows (<code>&gt;&gt;&gt;</code>) are called a <em>prompt</em>. They tell you that Python is ready for you to enter an instruction.</p>
<div class="image"><a id="ch01fig2"/><img src="../images/fig1-2.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-2: The Python shell</em></p>
<p class="indent">So let’s give Python something to do!</p>
<h4 class="h4" id="lev21"><span epub:type="pagebreak" id="page_16"/><strong>DISPLAYING TEXT</strong></h4>
<p class="noindent">For our first instruction, let’s tell Python to display text on the screen. Type the following line and press <small>ENTER</small>:</p>
<pre><span class="brown">&gt;&gt;&gt;</span> <span class="purple">print</span>(<span class="green">"Prepare for launch!"</span>)</pre>
<p class="indent">As you type, the color of your text will change. It starts off black, but as soon as Python recognizes a command, like <code>print</code>, the text changes color.</p>
<p class="indent"><a href="ch01.xhtml#ch01fig3">Figure 1-3</a> shows the names of the different parts of the instruction you just entered. The purple word <code>print</code> is the name of a <em>built-in function</em>, which is one of many instructions that are always available in Python. The <code>print()</code> function displays onscreen the information you place between the <em>parentheses</em> (curved brackets). The information between a function’s parentheses is the function’s <em>argument</em>.</p>
<div class="image"><a id="ch01fig3"/><img src="../images/fig1-3.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-3: The different parts of your first instruction</em></p>
<p class="indent">In our first instruction, the <code>print()</code> function’s argument is a <em>string</em>, which is what programmers call a piece of text. (A string can include numbers, but they’re treated as letters, so you can’t do calculations with numbers in a string.) The double quotation marks (<code>" "</code>) show the start and end of the string. Anything you type between double quotation marks will be green, and so will the quotation marks.</p>
<p class="indent">The colors do more than brighten up the screen: they highlight the different parts of the instruction to help you find mistakes. For example, if your final parenthesis is green, it means you forgot the closing double quote on the string.</p>
<p class="indent">If you entered the instruction correctly, your computer will display this text:</p>
<pre><span class="blue">Prepare for launch!</span></pre>
<p class="indent">The string that was shown in green is now displayed onscreen in blue. All <em>output</em> (information the computer gives to you) appears in blue. If your command didn’t work, check that you did the following:</p>
<ol>
<li class="noindent">Spelled <code>print</code> correctly. If you did, it will be purple (see <a href="ch01.xhtml#ch01fig3">Figure 1-3</a>).</li>
<li class="noindent">Used two parentheses. Other bracket shapes won’t work.</li>
<li class="noindent"><span epub:type="pagebreak" id="page_17"/>Used two double quotes. Don’t use two apostrophes (<code>''</code>) instead of a double quote (<code>"</code>). Although the double quote includes two marks, it’s just one symbol on the keyboard. On a US keyboard, the double quote is in the middle row of letters, on the right, and must be used with the <small>SHIFT</small> key. On a UK keyboard, the double quote is on the 2 key.</li>
</ol>
<p class="indent">If you make a mistake typing the text between the double quotes, the instruction will still work, but the computer will display exactly what you typed. For example, try this:</p>
<pre><span class="brown">&gt;&gt;&gt;</span> <span class="purple">print</span>(<span class="green">"Prepare for lunch!"</span>)</pre>
<p class="indent">It doesn’t matter if you mistype the string now, but be careful when you type a string or an instruction later in the book. Mistakes often prevent a program from working correctly, and it can be hard to track down a mistake in a longer program, even with the color coding.</p>
<div class="sidebar">
<p class="sidebart" id="ch01sb1a"><strong>TRAINING MISSION #1</strong></p>
<p class="spara">Can you enter a new instruction to output your name? (You’ll find the answers to the Training Missions in the “Mission Debrief” section at the end of each chapter.)</p>
</div>
<h4 class="h4" id="lev22"><strong>OUTPUTTING AND USING NUMBERS</strong></h4>
<p class="noindent">So far you’ve used the <code>print()</code> function to output a string, but it can also do calculations and output a number. Enter the following line:</p>
<pre><span class="brown">&gt;&gt;&gt;</span> <span class="purple">print</span>(4 + 1)</pre>
<p class="indent">The computer should output the number <code>5</code>, the solution to <code>4 + 1</code>. Unlike with a string, you don’t use quotes around numbers and calculations. But you still use the parentheses to mark the start and end of the information you want to give the <code>print()</code> function.</p>
<p class="indent">What happens if you do put quotes around <code>4 + 1</code>? Try it! The result is that the computer outputs <code>"4 + 1"</code> because it doesn’t treat 4 and 1 as numbers. Instead, it treats the argument as a string. You ask it to output <code>"4 + 1"</code>, and it does exactly that!</p>
<pre><span class="brown">&gt;&gt;&gt;</span> <span class="purple">print</span>(4 + 1)<br/><span class="blue">5</span><br/><span class="brown">&gt;&gt;&gt;</span> <span class="purple">print</span>(<span class="green">"4 + 1"</span>)<br/><span class="blue">4 + 1</span></pre>
<p class="indent">Python does the calculation only when you don’t include the quotes. You’ll use the <code>print()</code> function a lot in your programs.</p>
<h3 class="h3" id="lev23"><span epub:type="pagebreak" id="page_18"/><strong>INTRODUCING SCRIPT MODE</strong></h3>
<p class="noindent">The shell is great for quick calculations and for short instructions. But for longer sets of instructions, like games, it’s much easier to create programs instead. <em>Programs</em> are repeatable sets of instructions that we save so we can run them whenever we want and change them whenever we need to without retyping them. We’ll build programs using IDLE’s <em>script mode</em>. When you enter instructions in script mode, they don’t run immediately as they do in the shell.</p>
<p class="indent">Using the menu at the top of the shell window, select <strong>File</strong> and then select <strong>New File</strong> to open a blank new window, as shown in <a href="ch01.xhtml#ch01fig4">Figure 1-4</a>. The title bar at the top of the window displays <em>Untitled</em> until you save your file and name it. Once you’ve saved your file, the title bar will display the file’s name. From now on, we’ll use script mode nearly all the time when we’re creating Python code.</p>
<div class="image"><a id="ch01fig4"/><img src="../images/fig1-4.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-4: Python script mode</em></p>
<p class="indent">When you enter instructions in script mode, you can change, add, and delete instructions using the mouse or the arrow keys, so it’s much easier to fix mistakes and build your programs. Starting from <a href="ch04.xhtml#ch04">Chapter 4</a>, we’ll build the <em>Escape</em> game by adding to it piece-by-piece in script mode and testing each new section as we go.</p>
<div class="sidebar1">
<p class="sidebart"><strong>TIP</strong></p>
<p class="spara">If you’re not sure whether you’re in the shell or the script mode window, look at the title bar at the top. The shell displays <em>Python Shell</em>. The script mode window displays either <em>Untitled</em> or the name of your program.</p>
</div>
<h3 class="h3" id="lev24"><strong>CREATING THE STARFIELD</strong></h3>
<p class="noindent">The first program we’ll write will display the starfield image that we’ll use as the space background for our <em>Spacewalk</em> program. This image is in the <em>images</em> folder within the <em>escape</em> folder. Start by entering <a href="ch01.xhtml#ch01list1">Listing 1-1</a> into the new blank window in IDLE.</p>
<div class="note">
<p class="notet"><span epub:type="pagebreak" id="page_19"/><strong>NOTE</strong></p>
<p class="notep"><em>In this book, I’ll use numbers in circles (like this:</em> <span class="ent">➊</span><em>) to refer to different bits of code in the explanations so it’s easier for you to follow along. Don’t type these numbers in your program. When you see a number in a circle in the text, refer back to the program listing to see which part of the program I’m talking about.</em></p>
</div>
<p class="indent"><a href="ch01.xhtml#ch01list1">Listing 1-1</a> is a short program, but there are a couple of details that you should pay attention to while you’re typing: the <code>def</code> statement <span class="ent">➍</span> needs a colon at the end of its line, and the next line <span class="ent">➎</span> needs to start with four spaces. When you add the colon to the end of the <code>def</code> line and press <small>ENTER</small>, IDLE automatically adds the four spaces at the beginning of the next line for you.</p>
<p class="margin"><em>listing1-1.py</em></p>
<pre><span class="ent">➊</span> <span class="red"># Spacewalk</span><br/>   <span class="red"># by Sean McManus</span><br/>   <span class="red"># www.sean.co.uk / www.nostarch.com</span><br/><br/><span class="ent">➋</span> WIDTH = 800<br/>   HEIGHT = 600<br/><span class="ent">➌</span> player_x = 600<br/>   player_y = 350<br/><br/><span class="ent">➍</span> <span class="orange">def</span> <span class="blue">draw</span>():<br/><span class="ent">➎</span>     screen.blit(images.backdrop, (0, 0))</pre>
<p class="listing" id="ch01list1"><em>Listing 1-1: See the starfield in Pygame Zero.</em></p>
<p class="indent">Select the <strong>File</strong> menu at the top of the screen and then select <strong>Save</strong> (from now on, we’ll use a shorthand for menu selections that looks like this: <strong>File</strong> <span class="ent">▸</span> <strong>Save</strong>). In the Save dialog, name your program <em>listing1-1.py</em>. You need to save your file in the <em>escape</em> folder you set up in the Introduction. This way, it’s in the same folder as the book’s <em>images</em> folder, and Pygame Zero can find the images when you run the program. After you save the file, your <em>escape</em> folder should now contain your <em>listing1-1.py</em> file and the <em>images</em> folder, as shown in <a href="ch01.xhtml#ch01fig5">Figure 1-5</a> (along with the <em>listings</em> and <em>sounds</em> folders).</p>
<div class="image"><a id="ch01fig5"/><img src="../images/fig1-5.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-5: Your new Python program and the</em> images <em>folder should be stored in the same place.</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_20"/>I’ll explain how the <em>listing1-1.py</em> program works shortly, but first let’s run the program so we can admire the starfield. The program needs some instructions from Pygame Zero to manage the images, so to use those instructions, we need to run the program using a <code>pgzrun</code> instruction. Whenever we use any instructions from Pygame Zero in a Python program, we need to run it using <code>pgzrun</code>.</p>
<p class="indent">We’ll type this on the computer’s command line, just like we did in the Introduction to run the <em>Escape</em> game. First, look back at “<a href="intro.xhtml#lev12">Running the Game</a>” on <a href="intro.xhtml#page_9">page 9</a>, and follow the directions there to open your computer’s command line terminal from your <em>escape</em> folder. Then run the following instruction from the command line:</p>
<pre><span class="codestrong1">pgzrun listing1-1.py</span></pre>
<div class="note">
<p class="notet"><strong><span class="notes">RED ALERT</span></strong></p>
<p class="notep"><em>Don’t type this instruction in IDLE: be sure to type it in your Windows or Raspberry Pi command line. The Introduction shows you how.</em></p>
</div>
<p class="indent">If all went according to plan, you should be looking at the majesty of space, as shown in <a href="ch01.xhtml#ch01fig6">Figure 1-6</a>.</p>
<div class="image"><a id="ch01fig6"/><img src="../images/fig1-6.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-6: The starfield. The starfield image is courtesy of NASA/JPL-Caltech/UCLA and shows star cluster NGC 2259.</em></p>
<div class="sidebar1">
<p class="sidebart" id="ch01sb1"><span epub:type="pagebreak" id="page_21"/><strong>USING MY EXAMPLE LISTINGS</strong></p>
<p class="spara">If you can’t get a program in this book to work, you can use my example program instead. For instance, you can use my <em>listing1-1.py</em> example and modify it to make your own <em>listing1-2.py</em> shortly so you can continue following along.</p>
<p class="spara1">You’ll find my programs in the <em>listings</em> folder, which is in the <em>escape</em> folder. Simply open the <em>listings</em> folder in Windows or the Raspberry Pi desktop, find the listing you need, copy it, and then paste it into the <em>escape</em> folder. Then open the copied listing in IDLE and follow along with the next step in the book. When you look at the folder, you should be able to see your Python file and the <em>images</em> folder are in the same place (see <a href="ch01.xhtml#ch01fig5">Figure 1-5</a>).</p>
</div>
<h4 class="h4" id="lev25"><strong>UNDERSTANDING THE PROGRAM SO FAR</strong></h4>
<p class="noindent">Most of the instructions you’ll see in this book will work in any Python program. The <code>print()</code> function, for example, is always available. To make the programs in this book, we’re also using Pygame Zero. This adds some new functions and capabilities to Python for creating games, especially for the screen display and sound. <a href="ch01.xhtml#ch01list1">Listing 1-1</a> introduces our first instructions from Pygame Zero, used to set up the game window and draw the starfield.</p>
<p class="indent">Let’s take a closer look at how the <em>listing1-1.py</em> program works.</p>
<p class="indent">The first few program lines are <em>comments</em> <span class="ent">➊</span>. When you use a <code>#</code> symbol, Python ignores everything after it on the same line, and the line appears in red. The comments help you and other people reading the program understand what a program does and how it works.</p>
<p class="indent">Next, the program needs to store some information. Programs almost always need to store information that the program uses or needs to refer back to at a later time. For example, in many games, the computer needs to keep track of the score and the player’s position on the screen. Because these details can change (or <em>vary</em>) as the program runs, they’re stored in something called a <em>variable</em>. A variable is a name you give to a piece of information, either a number or some text.</p>
<p class="indent">To create a variable, you use an instruction like this:</p>
<pre><span class="codeitalic1">variable_name = value</span></pre>
<div class="note">
<p class="notet"><strong>NOTE</strong></p>
<p class="notep"><em>Code terms shown in italics are placeholders that would be filled in. Instead of</em> <span class="codeitalic">variable_name</span><em>, you would enter your own variable name.</em></p>
</div>
<p class="indent">For example, the following instruction puts the number 500 into the variable <code>score</code>:</p>
<pre>score = 500</pre>
<p class="indent">You can name your variables almost anything you want. However, to make your program easy to write and understand, you should choose <span epub:type="pagebreak" id="page_22"/>variable names that describe the information inside each variable. Note that you can’t use names for your variables that Python uses for its language, such as <code>print</code>.</p>
<div class="note">
<p class="notet"><strong><span class="notes">RED ALERT</span></strong></p>
<p class="notep"><em>Python is case-sensitive, which means it is strict about whether variables use uppercase or lowercase letters. In fact, it treats</em> <span class="codeitalic">score</span><em>,</em> <span class="codeitalic">SCORE</span><em>, and</em> <span class="codeitalic">Score</span> <em>as three completely different variables. Make sure you copy my example programs exactly, or they might not work properly.</em></p>
</div>
<p class="indent"><a href="ch01.xhtml#ch01list1">Listing 1-1</a> begins by creating some variables. Pygame Zero uses the <code>WIDTH</code> and <code>HEIGHT</code> variables <span class="ent">➋</span> to set the size of the game window on the screen. Our window is wider than it is tall because the <code>WIDTH</code> value (<code>800</code>) is bigger than the <code>HEIGHT</code> value (<code>600</code>).</p>
<p class="indent">Notice that we’ve spelled these variables with capital letters. The capital letters in variable names tell us that they’re <em>constants</em>. A constant is a particular kind of variable with values that aren’t supposed to change after they’ve been set up. The capital letters help other programmers who are looking at the program understand that they shouldn’t let anything else in the program change these variables.</p>
<p class="indent">The <code>player_x</code> and <code>player_y</code> variables <span class="ent">➌</span> will store your position on the screen as you carry out your spacewalk. Later in the chapter, we’ll use these variables to draw you on the screen.</p>
<p class="indent">We then define a function using the <code>def()</code> statement <span class="ent">➍</span>. A <em>function</em> is a group of instructions you can run whenever you need them in your program. You’ve already seen one built-in function called <code>print()</code>. We’ll make our own function in this program called <code>draw()</code>. Pygame Zero will use it to draw the screen display whenever the screen changes.</p>
<p class="indent">We define a function using the keyword <code>def</code> <span class="ent">➍</span>, followed by the function name we choose, empty parentheses, and a colon. Sometimes you’ll use a function’s parentheses to contain information for that function, as you’ll see later in this book.</p>
<p class="indent">We then need to give the function instructions for what it should do. To tell Python which instructions belong to the function, we indent them by four spaces. The <code>screen.blit()</code> instruction <span class="ent">➎</span> from Pygame Zero draws an image on the screen. In the parentheses, we tell it which image to draw and where to draw it, like this:</p>
<pre>screen.blit(images<span class="codeitalic1">.image_name</span>, (<span class="codeitalic1">x</span>, <span class="codeitalic1">y</span>) )</pre>
<p class="indent">From the <em>images</em> folder, we’ll use the <em>backdrop.jpg</em> file, which is the starfield. In our <em>listing1-1.py</em> program, we refer to it as <code>images.backdrop</code>. We don’t have to use the file’s <em>.jpg</em> extension, because we’re using Pygame Zero to handle the images, and Pygame Zero doesn’t require the extension<em>.</em> Also, the program knows where the image is because all the images must be in the <em>images</em> folder so Pygame Zero can find them.</p>
<p class="indent">We put the image on the screen at position <code>(0, 0)</code> <span class="ent">➌</span>, which is the top-left corner of the screen. The first number, known as the <em>x position</em>, tells the <code>screen.blit()</code> instruction how far from the left edge we want our image to <span epub:type="pagebreak" id="page_23"/>be; the second number, known as the <em>y position</em>, describes how far down we want it to be. The <em>x</em> positions go from 0 on the left edge of the window to 799 on the right edge because our window is 800 pixels wide. Similarly, the <em>y</em> positions run from 0 at the top of the window to 599 at the bottom (see <a href="ch01.xhtml#ch01fig6">Figure 1-6</a>).</p>
<p class="indent">For positions onscreen, we use a <em>tuple</em>, which is just a group of numbers or strings in parentheses, such as <code>(0, 0)</code>. In a tuple, the numbers are separated with a comma, plus an optional space for readability.</p>
<p class="indent">The most important thing you need to know about tuples is that you have to take care with the punctuation. Because the tuple uses parentheses, and we put this tuple inside the parentheses for <code>screen.blit()</code>, there are two sets of parentheses here. So you need parentheses around the tuple values, but you also need to close the parentheses for <code>screen.blit()</code> after the tuple.</p>
<h3 class="h3" id="lev26"><strong>STOPPING YOUR PYGAME ZERO PROGRAM</strong></h3>
<p class="noindent">Similar to space, your Pygame Zero program will go on forever. To stop it, click the game window’s close button at the top right (see <a href="ch01.xhtml#ch01fig6">Figure 1-6</a>). You can also close the program from the command line window where you entered the <code>pgzrun</code> instruction by pressing <small>CTRL</small>-C.</p>
<div class="note">
<p class="notet"><strong><span class="notes">RED ALERT</span></strong></p>
<p class="notep"><em>Don’t close the command line window itself. Otherwise, you’ll have to open it again to run another Pygame Zero program. If you do close it by mistake, refer back to “<a href="intro.xhtml#lev12">Running the Game</a>” on <a href="intro.xhtml#page_9">page 9</a> to open it again.</em></p>
</div>
<h3 class="h3" id="lev27"><strong>ADDING THE PLANET AND SPACESHIP</strong></h3>
<p class="noindent">Let’s bring Mars and the spaceship into view. In IDLE, add the last two lines in <a href="ch01.xhtml#ch01list2">Listing 1-2</a> to your existing <em>listing 1-1.py</em> program.</p>
<div class="note">
<p class="notet"><strong>NOTE</strong></p>
<p class="notep"><em>I’ll use</em> <span class="codeitalic">--snip--</span> <em>in code listings to show you where I’ve left out some code, usually because the code is repeated from before. I’ll also show any repeated code in gray so you can see the new code you need to add more clearly. Don’t add in the repeated code again!</em></p>
</div>
<p class="indent">In the following code, I’ve excluded the comments and variable setup to save space and make it easier for you to see the new code. But make sure you keep those instructions in your program. Just add the two new lines at the end.</p>
<p class="margin"><em>listing1-2.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/><span class="gray">def draw():</span><br/>    <span class="gray">screen.blit(images.backdrop, (0, 0))</span><br/>    screen.blit(images.mars, (50, 50))<br/>    screen.blit(images.ship, (130, 150))</pre>
<p class="listing" id="ch01list2"><em>Listing 1-2: Adding Mars and the ship</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_24"/>Save your updated program as <em>listing1-2.py</em> by selecting <strong>File</strong> <span class="ent">▸</span> <strong>Save As</strong>. Run your program by switching back to the command line window and entering the command <span class="codestrong">pgzrun listing1-2.py</span>. <a href="ch01.xhtml#ch01fig7">Figure 1-7</a> shows how the screen should now look, with the red planet and the spaceship above it.</p>
<div class="image"><a id="ch01fig7"/><img src="../images/fig1-7.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-7: Mars and the spaceship. The Mars image was taken by the Hubble Space Telescope in 1991.</em></p>
<div class="note">
<p class="notet"><strong>NOTE</strong></p>
<p class="notep"><em>If your program doesn’t work as expected, check that all your</em> <span class="codeitalic">screen.blit()</span> <em>instructions have exactly four spaces before them and are lined up with each other.</em></p>
</div>
<p class="indent">The first of the new instructions places the image <em>mars.jpg</em> at the position (50, 50), which is near the top-left corner of the screen. The second new instruction positions the ship at (130, 150). In each case, the coordinates used are for the top-left corner of the image.</p>
<h4 class="h4" id="lev28"><strong>CHANGING PERSPECTIVE: FLYING BEHIND THE PLANET</strong></h4>
<p class="noindent">Now let’s look at how we can make the ship fly behind the planet. Swap the order of the last two instructions in IDLE, as shown in <a href="ch01.xhtml#ch01list3">Listing 1-3</a>. To do this, highlight one of the lines, press <small>CTRL</small>-X to cut it, click on a new line, and press <small>CTRL</small>-V to paste it in place. You can also use the cut and paste options in the Edit menu at the top of the screen.</p>
<p class="margin"><em>listing1-3.py</em></p>
<pre><span class="gray">--<span class="codeitalic1">snip</span>--</span><br/><span class="gray">def draw():</span><br/>    <span class="gray">screen.blit(images.backdrop, (0, 0))</span><br/><span epub:type="pagebreak" id="page_25"/>    screen.blit(images.ship, (130, 150))<br/>    screen.blit(images.mars, (50, 50))</pre>
<p class="listing" id="ch01list3"><em>Listing 1-3: Swapping the order of the planet and ship instructions</em></p>
<p class="indent">If the previous version of your program is still running, close it now. Save your new program as <em>listing1-3.py</em> and run it from the command line by entering <span class="codestrong">pgzrun listing1-3.py</span>. You should see that the spaceship is now behind the planet, as shown in <a href="ch01.xhtml#ch01fig8">Figure 1-8</a>. If not, make sure you ran the right file (<em>listing1-3.py</em>), and then check that the instructions in the program are correct.</p>
<p class="indent">The ship goes behind the planet because the images are added to the screen in the order they are drawn in the program. In our updated program, we draw the starfield, draw the ship, and then draw Mars. Each new image appears on top of the previous one. If two images overlap, the image that was drawn last appears in front of the one drawn earlier.</p>
<div class="image"><a id="ch01fig8"/><img src="../images/fig1-8.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-8: The spaceship is now behind the planet.</em></p>
<div class="sidebar">
<p class="sidebart" id="ch01sb2"><strong>TRAINING MISSION #2</strong></p>
<p class="spara">Can you move just one drawing instruction in your program to make the planet and the spaceship disappear? If you’re not sure what to do, experiment by moving the drawing instructions to see what effect it has when you save the program and run it again.</p>
<p class="spara1">Make sure you keep the drawing instructions aligned and indented with four spaces inside the <code>draw()</code> function. When you’re done experimenting, match the instructions in <a href="ch01.xhtml#ch01list3">Listing 1-3</a> again to bring the ship and Mars back into view.</p>
</div>
<h4 class="h4" id="lev29"><span epub:type="pagebreak" id="page_26"/><strong>SPACEWALKING!</strong></h4>
<p class="noindent">It’s time to climb out of the underside of the spaceship and begin your spacewalk. Edit your program so it matches <a href="ch01.xhtml#ch01list4">Listing 1-4</a>. But be sure to keep the variable instructions that aren’t shown here the same as they were before. Save the updated program as <em>listing1-4.py</em>.</p>
<p class="margin"><em>listing1-4.py</em></p>
<pre>   <span class="gray">--<span class="codeitalic1">snip</span>--</span><br/>   <span class="gray">def draw():</span><br/>       <span class="gray">screen.blit(images.backdrop, (0, 0))</span><br/>       screen.blit(images.mars, (50, 50))<br/><span class="ent">➊</span>     screen.blit(images.astronaut, (player_x, player_y))<br/><span class="ent">➋</span>     screen.blit(images.ship, (550, 300))<br/><br/><span class="ent">➌</span> <span class="orange">def</span> <span class="blue">game_loop</span>():<br/><span class="ent">➍</span>     <span class="orange">global</span> player_x, player_y<br/><span class="ent">➎</span>     <span class="orange">if</span> keyboard.right:<br/><span class="ent">➏</span>         player_x += 5<br/><span class="ent">➐</span>     <span class="orange">elif</span> keyboard.left:<br/>           player_x -= 5<br/><span class="ent">➑</span>     <span class="orange">elif</span> keyboard.up:<br/>           player_y -= 5<br/>       <span class="orange">elif</span> keyboard.down:<br/>           player_y += 5<br/><br/><span class="ent">➒</span> clock.schedule_interval(game_loop, 0.03)</pre>
<p class="listing" id="ch01list4"><em>Listing 1-4: Adding the spacewalk instructions</em></p>
<p class="indent">In this listing, we add a new instruction <span class="ent">➊</span> to draw the astronaut image at the position in the <code>player_x</code> and <code>player_y</code> variables, which were set up at the start of the program in <a href="ch01.xhtml#ch01list1">Listing 1-1</a>. As you can see, we can use these variable names in place of numbers for the astronaut’s position. The program will use the current numbers stored in these variables to figure out where to put the astronaut every time it is drawn.</p>
<p class="indent">Note that the order of drawing the images has changed in the program and is now backdrop, Mars, astronaut, and ship. Make sure you change the order of your <code>screen.blit()</code> instructions to match this listing.</p>
<p class="indent">The astronaut starts off overlapping the ship. Because the astronaut is drawn before the ship, the astronaut will appear to emerge from underneath (behind) the spaceship. We also changed the position of the ship <span class="ent">➋</span> to the bottom-right area of the screen. This gives the astronaut space to fly toward the planet.</p>
<p class="indent">Run the program by entering <span class="codestrong">pgzrun listing1-4.py</span>. You should now be able to use the arrow keys to move freely through space, protected by your spacesuit, as shown in <a href="ch01.xhtml#ch01fig9">Figure 1-9</a>. You’ll see that you fly behind the spaceship but in front of Mars and the starfield. The order in which we draw the images creates a simple illusion of depth. When we draw the space station beginning in <a href="ch03.xhtml#ch03">Chapter 3</a>, we’ll use this drawing technique to create a 3D perspective of each room. We’ll draw the rooms from back to front to create a sense of depth.</p>
<div class="image"><span epub:type="pagebreak" id="page_27"/><a id="ch01fig9"/><img src="../images/fig1-9.jpg" alt="image"/></div>
<p class="figcap"><em>Figure 1-9: You emerge from the ship for your spacewalk.</em></p>
<div class="sidebar">
<p class="sidebart" id="ch01sb3"><strong>TRAINING MISSION #3</strong></p>
<p class="spara">Can you edit the code to move the spaceship and the astronaut to the top-right corner of the screen? You’ll need to change the starting values for <code>player_x</code> and <code>player_y</code>, as well as where the spaceship is drawn. Make sure the player is “inside” (actually underneath) the ship at the start of the program. Experiment with other positions, too. This is a great way to get familiar with screen positions. Refer back to <a href="ch01.xhtml#ch01fig6">Figure 1-6</a> if you need to.</p>
</div>
<h4 class="h4" id="lev30"><strong>UNDERSTANDING THE SPACEWALK LISTING</strong></h4>
<p class="noindent">The spacewalk listing, <a href="ch01.xhtml#ch01list4">Listing 1-4</a>, is interesting because it lets you control part of the program from the keyboard, which will be crucial in the <em>Escape</em> game. Let’s look at how our final spacewalk program works.</p>
<p class="indent">We build on our earlier listings and add a new function called <code>game_loop()</code> <span class="ent">➌</span>. This function’s job is to change the values of the <code>player_x</code> and <code>player_y</code> variables when you press the arrow keys. Changing the variables enables you to move the astronaut character because those variables position the astronaut when it’s drawn.</p>
<p class="indent">Before we go on, we need to look at two different types of variables. Variables that are changed inside a function usually belong to that function and can’t be used by other functions. They’re called <em>local variables</em>, and they make it harder for bits of the program to interfere with other bits accidentally and cause errors.</p>
<p class="indent"><span epub:type="pagebreak" id="page_28"/>But in the spacewalk listing, we need both the <code>draw()</code> and <code>game_loop()</code> functions to use the same <code>player_x</code> and <code>player_y</code> variables, so they need to be <em>global variables</em>, which any part of the program can use. We set up global variables at the start of the program, outside of any functions.</p>
<p class="indent">To tell Python that the <code>game_loop()</code> function needs to use and change the global variables we set up outside of this function, we use the <code>global</code> command <span class="ent">➍</span>. We put it at the beginning of the function and list the variables we want to use as global variables. Doing this is like overriding the safety feature that stops you from changing variables that weren’t created inside the function. We don’t need to use <code>global</code> in the <code>draw()</code> function, because the <code>draw()</code> function doesn’t need to change those variables. It only needs to look at what those variables contain.</p>
<p class="indent">We tell the program to use keyboard controls using the <code>if</code> command. With this instruction, we tell Python to do something only <em>if</em> certain conditions are met. We use four spaces to indent the instructions that belong to the <code>if</code> command. That means these instructions are indented by eight spaces in total in <a href="ch01.xhtml#ch01list4">Listing 1-4</a> because they are also inside the <code>game_loop()</code> function. These instructions run only if the statement after the <code>if</code> command is true. If not, the instructions that belong to the <code>if</code> command are skipped over.</p>
<p class="indent">It might seem odd to use spaces like this to show which instructions belong together, especially if you’ve used other programming languages, but it makes the programs easy to read. Other languages often need brackets around sets of instructions like this. Python keeps it simple.</p>
<p class="indent">We use the <code>if</code> command to check whether the right arrow key is pressed <span class="ent">➎</span>. If it is, we change the value of <code>player_x</code> by adding 5 <span class="ent">➏</span>, moving the astronaut image to the right. The symbols <code>+=</code> mean <em>increase by</em>, so the following line increases the number in the <code>player_x</code> variable by 5:</p>
<pre>player_x += 5</pre>
<p class="indent">Similarly, <code>-=</code> means <em>decrease by</em>, so the following instruction reduces the number in <code>player_x</code> by 5:</p>
<pre>player_x -= 5</pre>
<p class="indent">If the right arrow key is not pressed, we check whether the left key is pressed. If it is, the program subtracts 5 from the <code>player_x</code> value, moving the astronaut’s position left. To do that, we use an <code>elif</code> command <span class="ent">➐</span>, which is short for “else if.” You can think of <em>else</em> as meaning <em>otherwise</em> here. In plain English, this part of our program means, “If the right arrow key is pressed, add 5 to the <em>x</em> position. Otherwise, if the left key is pressed, subtract 5 from the <em>x</em> position.” We then use <code>elif</code> to check for up and down keypresses in the same way, and change the <em>y</em> position to move the astronaut up or down. The <code>draw()</code> function uses the <code>player_x</code> and <code>player_y</code> variables for the astronaut’s position, so changing the numbers in these variables makes the astronaut move on the screen.</p>
<div class="sidebar1">
<p class="sidebart"><span epub:type="pagebreak" id="page_29"/><strong>TIP</strong></p>
<p class="spara">If you change the <code>elif</code> command at <span class="ent">➑</span> to an <code>if</code> command, the program allows you to move up or down at the same time as moving left or right, letting you walk diagonally. That’s fun in the spacewalk program, but we’ll use code similar to this to move around the space station later, and it doesn’t look natural there.</p>
</div>
<p class="indent">The final instruction <span class="ent">➒</span> sets the <code>game_loop()</code> function to run every 0.03 seconds using the clock in Pygame Zero, so the program keeps checking for your keypresses and changing your position variables frequently. Note that you don’t put any parentheses after <code>game_loop</code> here. This instruction isn’t indented, because it doesn’t belong to any function. When the program starts, it runs the instructions that aren’t in any function in the order they are in the listing, from top to bottom. Therefore, the last line of the program is one of the first to run after the variables are set up. This last line starts the <code>game_loop()</code> function running.</p>
<p class="indent">The <code>draw()</code> function runs automatically whenever the screen needs updating. This is a feature of Pygame Zero.</p>
<div class="sidebar">
<p class="sidebart" id="ch01sb4"><strong>TRAINING MISSION #4</strong></p>
<p class="spara">Let’s fit some new thrusters to the spacesuit. Can you work out how to make the astronaut move faster in the up and down directions than it does in the left and right directions? Each keypress in the up or down direction should make the space suit move more than a keypress in the left or right direction.</p>
</div>
<p class="indent">Enjoy the breathtaking views as you take your spacewalk and conduct any essential repairs to your ship. We’ll reconvene in <a href="ch02.xhtml#ch02">Chapter 2</a>, where you’ll learn some procedures that will help you stay safe in space.</p>
<h3 class="h3" id="lev31"><strong>ARE YOU FIT TO FLY?</strong></h3>
<p class="noindentb">Check the following boxes to confirm that you’ve learned the key lessons in this chapter. If you’re not sure about something, flip back through the chapter and give the topic another look.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  You use IDLE’s script mode to create a program that you can save, edit, and run again. Enter script mode by selecting <strong>File</strong> <span class="ent">▸</span> <strong>New File</strong> or edit an existing file by selecting <strong>File</strong> <span class="ent">▸</span> <strong>Open</strong>.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  Strings are pieces of text in code. Double quotes mark the start and end of a string. A string can include numbers, but they’re treated as letters.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  Variables store information, either numbers or strings.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  The <code>print()</code> function outputs information on the screen. You can use it for strings, numbers, calculations, or the values of variables.</p>
<p class="square"><span epub:type="pagebreak" id="page_30"/><img src="../images/box.jpg" alt="Images"/>  The <code>#</code> symbol in a program marks a comment. Python ignores anything on the same line after a <code>#</code>, and comments can be a handy reminder for you and anyone you share your code with.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  Use the <code>WIDTH</code> and <code>HEIGHT</code> variables to set the size of your game window.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  To run a Pygame Zero program, open the command line from the folder your Python program is in, and then enter <code>pgzrun</code> <span class="codeitalic">filename</span><code>.py</code> in the command line to run it.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  A function is a group of instructions you can run whenever you want your program to use the instructions. Pygame Zero uses the <code>draw()</code> function to draw or update the game screen.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  Use <code>screen.blit</code><code>(</code><span class="codeitalic">images</span><code>.</code><span class="codeitalic">image_name</span><code>, (</code><span class="codeitalic">x</span><code>,</code> <span class="codeitalic">y</span><code>))</code> to draw an image at position (<em>x</em>, <em>y</em>) on the screen. The x- and y-axes are numbered starting at 0 in the top-left corner.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  A <em>tuple</em> is a group of numbers or strings in parentheses, separated by a comma. The contents of a tuple can’t be changed by the program after they’ve been set up.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  To end your Pygame Zero program, click the window’s close button or press <small>CTRL</small>-C in the command line window.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  If images overlap, the image you drew last in the program appears at the front.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  The <code>elif</code> command is short for “else if.” Use it to combine <code>if</code> conditions so that only one set of instructions can run. In our program, we use it to stop the player from moving in two directions at the same time.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  If we want to change a variable inside a function and use it in a different function, we need to use a <em>global variable</em>. We set it up outside of the functions and use the <code>global</code> keyword inside a function when we plan to change the variable there.</p>
<p class="square"><img src="../images/box.jpg" alt="Images"/>  We can set a function to run at regular intervals using the clock feature in Pygame Zero.</p>
<div class="image" id="ch01sb5"><span epub:type="pagebreak" id="page_31"/><img src="../images/f0031-01.jpg" alt="image"/><span epub:type="pagebreak" id="page_32"/></div>
</body></html>