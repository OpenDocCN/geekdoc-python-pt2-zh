## **C**

**调试你的代码列表**

![image](img/common01.jpg)

本书中的一些代码列表第一次运行时可能不会起作用。不要气馁！这是编程中常见的情况，即使是经验丰富的程序员也会遇到。忽略一些细节可能会导致程序发生重大差异。修复程序中的错误叫做*调试*。

为了尽量减少问题，我将代码列表保持得尽可能简短，因此如果某个列表无法正常工作，你不需要检查太多指令。我还在文本中添加了警告，提醒你注意特别棘手的部分。

记住，如果你无法解决程序的问题，可以使用我在书籍资源中提供的该列表的版本（参见 “ZIP 文件中包含的内容” 在第 8 页）。如果你修改了程序，可以尝试将我列表中的新部分复制并粘贴到你的程序中。

在本附录中，我整理了一些技巧，帮助你修复任何无法正常工作的程序。当 Python 发现错误时，通常会显示程序中出现问题的第一行。这并不总是错误实际所在的行：它只是 Python 发现问题时所能执行到的地方。如果显示的行看起来没问题，首先检查前一行，然后检查列表中的其他新指令是否有错误。

### **缩进**

缩进用于告诉 Python 哪些部分的程序是属于同一组的。例如，所有属于某个函数的指令需要在定义该函数的`def`指令下进行缩进。属于`while`、`for`、`if`或`else`命令的指令也需要进行缩进。列表 C-1 提供了一个示例，展示了`get_floor_type()`函数的一部分。

```py
   --snip--
➊ def get_floor_type():
➋     if current_room in outdoor_rooms:
➌         return 2 # soil
➍     else:
➎         return 0 # tiled floor       
   --snip--
```

*列表 C-1：游戏列表的摘录，展示了缩进层级*

所有的指令都属于函数`get_floor_type()` ➊，因此它们都至少缩进四个空格（参见 ➋ 和 ➍）。`return`指令（➌ 和 ➎）也属于它们上方的`if` ➋ 和 `else` ➍命令，因此它们再缩进四个空格，总共缩进八个空格。当你在输入`def`、`if`和`else`指令时，行尾加上冒号后，下一行的缩进会在 IDLE 中自动添加。使用 DELETE 键删除不需要的缩进。

如果某些指令的缩进级别设置错误，程序可能会出现异常行为，或者即使 Python 没有报告错误，也可能运行得更慢。因此，仔细检查你的缩进级别是值得的。

如果 Python 给出一个错误提示，显示它期望一个缩进块，这意味着你没有缩进应该缩进的内容。如果 Python 告诉你有意外的缩进，说明你在指令开始时添加了过多的空格，或者你可能有指令的缩进层级不一致，应该对齐。在本书中，我使用了四个空格作为每个缩进层级。

### **大小写敏感**

Python 是大小写敏感的，这意味着你使用大写字母（ABC...）还是小写字母（abc...）都很重要。大多数情况下，你应该在编写 Python 代码时使用小写字母。以下是一些例外情况：

+   `True`、`False` 和 `None` 这些值的首字母是大写的。当你正确输入它们时，它们会在 IDLE 中显示为橙色。

+   程序中的一些变量、字典和列表名称是大写的，如 `TILE_SIZE` 和 `PLAYER`。如果你的大小写不一致，可能会收到错误信息，提示某个名称未定义。Python 不会把两个大小写不同的名称识别为相同的名称。（也要检查名称的拼写错误。）

+   任何在引号中的内容都可以有大小写变化。这是程序用来执行某些操作的文本，通常写得让它在人类阅读时看起来正确。

+   Python 会忽略 `#` 符号后面同一行的内容，所以你可以在这里使用任何你喜欢的大小写字母。

### **圆括号和方括号**

检查你是否使用了正确的括号形状，并且顺序正确，特别是当 Python 告诉你列表或字典中的某个地方出错时：

+   圆括号 `()` 用于元组和为函数提供信息。例如，`range()`、`print()` 和 `len()` 函数使用圆括号。我们的 *Escape* 游戏中的函数也使用圆括号，如 `remove_object()` 和 `draw_image()`。

+   方括号 `[]` 标记列表的开始和结束。有时，你可能会在一个列表中包含另一个列表，这样就会有多个括号对。

+   花括号 `{}` 标记字典的开始和结束。

### **冒号**

当代码行以 `for`、`while`、`if`、`else` 或 `def` 开头时，它需要在行末加上冒号（`:`）。冒号还用于在字典中分隔键和值。*Escape* 列表不使用分号（`;`），所以如果你的代码中有分号，改成冒号。

### **逗号**

列表或元组中的项需要用逗号分隔。当向列表中添加新行时，确保在添加新项之前，在最后一项后加上逗号。通过观察数据中的模式，可以帮助你发现涉及逗号的错误。例如，`props` 字典和 `recipes` 列表中的每个列表都包含三个数字。

### **图像和声音**

如果 Python 告诉你找不到图像或声音目录，检查你是否已经下载了文件，并且文件保存的位置是否正确。请参见 “下载游戏文件” 第 7 页和第 19 页的 示例 1-1。

### **拼写**

IDLE 的颜色编码可以帮助你发现一些指令中的拼写错误。检查屏幕上的颜色是否与书中的颜色匹配。拼写变量和列表时要小心：任何错误都可能导致程序停止或出现异常行为。
