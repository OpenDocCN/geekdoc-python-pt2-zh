- en: '4'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '4'
- en: A/B Testing
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: A/B测试
- en: '![](image_fi/book_art/chapterart.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/book_art/chapterart.png)'
- en: In the preceding chapter, we discussed the scientific practice of observing
    two groups and making quantitative judgments about how they relate to each other.
    But scientists (including data scientists) do more than just observe preexisting
    differences. A huge part of science consists of creating differences experimentally
    and then drawing conclusions. In this chapter, we’ll discuss how to conduct those
    kinds of experiments in business.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们讨论了观察两个群体并对它们之间的关系做出定量判断的科学实践。但科学家（包括数据科学家）不仅仅是观察已有的差异。科学的一个重要部分是通过实验制造差异，然后得出结论。在本章中，我们将讨论如何在商业中进行这些类型的实验。
- en: We’ll start by discussing the need for experimentation and our motivations for
    testing. We’ll cover how to properly set up experiments, including the need for
    randomization. Next, we’ll detail the steps of A/B testing and the champion/challenger
    framework. We’ll conclude by describing nuances like the exploration/exploitation
    trade-off, as well as ethical concerns.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从讨论实验的必要性和我们进行测试的动机开始。我们将涵盖如何正确设置实验，包括随机化的必要性。接下来，我们将详细介绍A/B测试和冠军/挑战者框架的步骤。最后，我们将描述一些细微差别，比如探索/利用的权衡，以及伦理问题。
- en: The Need for Experimentation
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实验的必要性
- en: 'Let’s return to the scenario we outlined in the second half of Chapter 3. Imagine
    that you’re running a computer company and maintain email marketing lists that
    your customers can choose to subscribe to. One email list is designed for customers
    who are interested in your desktop computers, and the other email list is for
    customers interested in your laptops. You can download two fabricated datasets
    for this scenario from [https://bradfordtuckfield.com/desktop.csv](https://bradfordtuckfield.com/desktop.csv)
    and [https://bradfordtuckfield.com/laptop.csv](https://bradfordtuckfield.com/laptop.csv).
    If you save them to the same directory you’re running Python from, you can read
    these hypothetical lists into Python as follows:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回到第3章下半部分概述的情境。假设你经营一家电脑公司，并维护着客户可以选择订阅的电子邮件营销列表。一个电子邮件列表是为对台式机感兴趣的客户设计的，另一个电子邮件列表是为对笔记本电脑感兴趣的客户设计的。你可以从[https://bradfordtuckfield.com/desktop.csv](https://bradfordtuckfield.com/desktop.csv)和[https://bradfordtuckfield.com/laptop.csv](https://bradfordtuckfield.com/laptop.csv)下载两个虚构的数据集。如果你将它们保存在你运行Python的相同目录下，你可以如下方式将这些假设的列表读取到Python中：
- en: '[PRE0]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: You can run `print(desktop.head())` and `print(laptop.head())` to see the first
    five rows of each dataset.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以运行`print(desktop.head())`和`print(laptop.head())`来查看每个数据集的前五行。
- en: 'In Chapter 3, you learned how to use simple t-tests to detect differences between
    our datasets, as follows:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在第3章中，你学会了如何使用简单的t检验来检测我们的数据集之间的差异，具体如下：
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Here, we import the SciPy package’s `stats` module so we can use it for t-tests.
    Then we print the results of three separate t-tests: one comparing the spending
    of desktop and laptop subscribers, one comparing the ages of desktop and laptop
    subscribers, and one comparing the number of recorded website visits of desktop
    and laptop subscribers. We can see that the first *p*-value is less than 0.05,
    indicating that these groups are significantly different in their spending levels
    (at the 5 percent significance level), just as we concluded in Chapter 3.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们导入SciPy包的`stats`模块，以便使用t检验。然后我们打印三个独立t检验的结果：一个比较台式机和笔记本电脑订阅者的消费，一个比较台式机和笔记本电脑订阅者的年龄，一个比较台式机和笔记本电脑订阅者的记录网站访问次数。我们可以看到，第一个*p*值小于0.05，这表明这两个群体在消费水平上存在显著差异（在5%的显著性水平下），正如我们在第3章中得出的结论。
- en: After determining that desktop subscribers are different from laptop subscribers,
    we can conclude that we should send them different marketing emails. However,
    this fact alone is not enough to completely guide our marketing strategy. Just
    knowing that our desktop subscriber group spends a little less than the laptop
    subscriber group doesn’t tell us whether crafting long messages or short ones
    would lead to better sales, or whether using red text or blue text would get us
    more clicks, or whether informal or formal language would improve customer loyalty
    most. In some cases, past research published in academic marketing journals can
    give us hints about what will work best. But even when relevant research exists,
    every company has its own unique set of customers that may not respond to marketing
    in exactly the same way that past research indicates.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定台式机订阅者与笔记本电脑订阅者有所不同之后，我们可以得出结论，应该向他们发送不同的营销邮件。然而，仅凭这一事实并不足以完全指导我们的营销策略。仅仅知道我们的台式机订阅者群体的消费略低于笔记本电脑订阅者群体，并不能告诉我们，长篇信息或短篇信息哪种更能促进销售，或者使用红色文本还是蓝色文本能获得更多的点击，或者使用非正式语言还是正式语言能更好地提升客户忠诚度。在某些情况下，学术营销期刊中发布的过往研究可以为我们提供有效的线索。但即便存在相关的研究，每个公司都有其独特的客户群，这些客户群可能不会像过往研究所示那样对营销产生反应。
- en: We need a way to generate new data that’s never been collected or published
    before, so we can use that data to answer new questions about the new situations
    that we regularly face. Only if we can generate this kind of new data can we reliably
    learn about what will work best in our efforts to grow our business with our particular
    set of unique customers. We’ll spend the rest of this chapter discussing an approach
    that will accomplish this.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要一种方法来生成以前从未收集或发布过的新数据，这样我们才能利用这些数据来回答有关我们常常面临的新情况的问题。只有能够生成这种新数据，我们才能可靠地了解在面对我们特定的独特客户群时，哪些方法最能推动我们的业务增长。本章剩余的部分将讨论一种可以实现这一目标的方法。
- en: '*A/B testing*, the focus of this chapter, uses experiments to help businesses
    determine which practices will give them the greatest chances of success. It consists
    of a few steps: experimental design, random assignment into treatment and control
    groups, careful measurement of outcomes, and finally, statistical comparison of
    outcomes between groups.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*A/B 测试*，本章的重点，使用实验来帮助企业确定哪些做法能为它们带来最大的成功机会。它包含几个步骤：实验设计、将样本随机分配到实验组和控制组、仔细衡量结果，最后对各组之间的结果进行统计比较。'
- en: 'The way we’ll do statistical comparisons will be familiar: we’ll use the t-tests
    introduced in the previous chapter. While t-tests are a part of the A/B testing
    process, they are not the only part. A/B testing is a process for collecting new
    data, which can then be analyzed using tests like the t-test. Since we’ve already
    introduced t-tests, we won’t focus on them in this chapter. Instead, we’ll focus
    on all the other steps of A/B testing.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将采用的统计比较方法应该是熟悉的：我们将使用上一章介绍的 t 检验。虽然 t 检验是 A/B 测试的一部分，但它并不是唯一的部分。A/B 测试是一个收集新数据的过程，这些数据可以通过
    t 检验等方法进行分析。由于我们已经介绍了 t 检验，因此本章不会再重点讨论它。相反，我们将重点讨论 A/B 测试的其他所有步骤。
- en: Running Experiments to Test New Hypotheses
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进行实验以测试新假设
- en: 'Let’s consider just one hypothesis about our customers that might interest
    us. Suppose we’re interested in studying whether changing the color of text in
    our marketing emails from black to blue will increase the revenue we earn as a
    result of the emails. Let’s express two hypotheses related to this:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一个关于我们客户的假设，这可能引起我们的兴趣。假设我们想研究是否将我们营销邮件中的文本颜色从黑色改为蓝色会增加我们从这些邮件中获得的收入。我们可以提出与此相关的两个假设：
- en: Hypothesis 0 Changing the color of text in our emails from black to blue will
    have no effect on revenues.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 假设 0：将我们电子邮件中的文本颜色从黑色改为蓝色不会对收入产生任何影响。
- en: Hypothesis 1 Changing the color of text in our emails from black to blue will
    lead to a change in revenues (either an increase or a decrease).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 假设 1：将我们电子邮件中的文本颜色从黑色改为蓝色将会导致收入发生变化（无论是增加还是减少）。
- en: 'We can use the testing hypothesis framework covered in Chapter 3 to test our
    null hypothesis (Hypothesis 0) and decide whether we want to reject it in favor
    of its alternative hypothesis (Hypothesis 1). The only difference is that in Chapter
    3, we tested hypotheses related to data we had already collected. Here, our datasets
    do not include information about blue-text and black-text emails. So, extra steps
    are required before we perform hypothesis testing: designing an experiment, running
    an experiment, and collecting data related to the experiment’s results.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用第3章中介绍的假设检验框架来检验原假设（假设0），并决定是否要拒绝它，转而接受其替代假设（假设1）。唯一的区别是，在第3章中，我们检验的是已经收集的数据相关的假设。而在这里，我们的数据集并不包括关于蓝色文本和黑色文本电子邮件的信息。因此，在进行假设检验之前需要额外的步骤：设计实验、进行实验，并收集与实验结果相关的数据。
- en: 'Running experiments may not sound so difficult, but some tricky parts are important
    to get exactly right. To do the hypothesis test we just outlined, we’ll need data
    from two groups: a group that has received a blue-text email and a group that
    has received a black-text email. We’ll need to know how much revenue we received
    from each member of the group that received the blue-text email and how much revenue
    we received from each member of the group that received the black-text email.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 进行实验可能听起来不那么困难，但一些关键的细节非常重要，需要做到精准无误。为了进行我们刚才提到的假设检验，我们需要来自两个组的数据：一个收到蓝色文本电子邮件的组和一个收到黑色文本电子邮件的组。我们需要知道从收到蓝色文本电子邮件的每个组成员那里获得了多少收入，以及从收到黑色文本电子邮件的每个组成员那里获得了多少收入。
- en: After we have that, we can do a simple t-test to determine whether the revenue
    collected from the blue-text group differed significantly from the revenue collected
    from the black-text group. In this chapter, we’ll use a 5 percent significance
    level for all of our tests—that is, we’ll reject the null hypothesis and accept
    our alternative hypothesis if our *p*-value is less than 0.05\. When we do our
    t-test, if the revenues are significantly different, we can reject our null hypothesis
    (Hypothesis 0). Otherwise, we won’t reject our null hypothesis, and until something
    convinces us otherwise, we’ll accept its assertion that blue and black text lead
    to equal revenues.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们有了这些数据之后，我们可以做一个简单的t检验，以确定蓝色文本组收集的收入是否与黑色文本组收集的收入有显著差异。在本章中，我们将对所有测试使用5%的显著性水平——也就是说，如果我们的*p*-值小于0.05，我们将拒绝原假设并接受替代假设。如果我们进行t检验，发现收入差异显著，我们可以拒绝原假设（假设0）。否则，我们不会拒绝原假设，并且在没有其他证据的情况下，我们将接受其关于蓝色和黑色文本产生相等收入的断言。
- en: We need to split our population of interest into two subgroups and send a blue-text
    email to one subgroup and a black-text email to our other subgroup so we can compare
    revenues from each group. For now, let’s focus on desktop subscribers only and
    split our desktop dataframe into two subgroups.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要将目标人群分成两个子组，向一个子组发送蓝色文本电子邮件，向另一个子组发送黑色文本电子邮件，这样我们就可以比较每个组的收入。现在，先让我们只关注桌面端订阅者，并将我们的桌面数据框分为两个子组。
- en: 'We can split a group into two subgroups in many ways. One possible choice is
    to split our dataset into a group of younger people and a group of older people.
    We might split our data this way because we believe that younger people and older
    people might be interested in different products, or we might do it this way just
    because age is one of the few variables that appears in our data. Later, we’ll
    see that this way of splitting our group into subgroups will lead to problems
    in our analysis, and we’ll discuss better ways to create subgroups. But since
    this method of splitting into subgroups is simple and easy, let’s start by trying
    it to see what happens:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过多种方式将一个组分成两个子组。一个可能的选择是将我们的数据集分为年轻人组和老年人组。我们可能这样划分数据，因为我们认为年轻人和老年人可能对不同的产品感兴趣，或者我们可能仅仅因为年龄是我们数据中少数几个变量之一而这么做。稍后我们将看到，这种将组分成子组的方法会在我们的分析中引发问题，我们将讨论更好的创建子组的方法。但由于这种分组方法简单易行，让我们先尝试一下，看看会发生什么：
- en: '[PRE2]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Here, we import the NumPy package, giving it the alias `np`, so we can use its
    `median()` method. Then we simply take the median age of our group of desktop
    subscribers and create `groupa`, a subset of our desktop subscribers whose age
    is below or equal to the median age, and `groupb`, a subset of our desktop subscribers
    whose age is above the median age.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，我们导入了NumPy包，并为其指定别名`np`，以便使用它的`median()`方法。然后，我们简单地取出桌面订阅者组的中位年龄，并创建`groupa`，它是一个年龄小于或等于中位年龄的桌面订阅者子集；`groupb`是一个年龄高于中位年龄的桌面订阅者子集。
- en: After creating `groupa` and `groupb`, you can send these two dataframes to your
    marketing team members and instruct them to send different emails to each group.
    Suppose they send the black-text email to `groupa` and the blue-text email to
    `groupb`. In every email, they include links to new products they want to sell,
    and by tracking who clicks which links and their purchases, the team members can
    measure the total revenue earned from each individual email recipient.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建了`groupa`和`groupb`之后，你可以将这两个数据框发送给你的营销团队成员，并指示他们向每个组发送不同的邮件。假设他们将黑色文本的邮件发送给`groupa`，将蓝色文本的邮件发送给`groupb`。每封邮件中都会包含他们想要销售的新产品链接，通过跟踪谁点击了哪些链接以及他们的购买情况，团队成员可以衡量每个邮件接收者带来的总收入。
- en: 'Let’s read in some fabricated data that shows hypothetical outcomes for members
    of our two groups. This data can be downloaded from [https://bradfordtuckfield.com/emailresults1.csv](https://bradfordtuckfield.com/emailresults1.csv);
    store it in the same directory where you run Python. Then you can read it into
    your Python session as follows:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们读取一些虚构的数据，这些数据展示了我们两个组成员的假设结果。你可以从[https://bradfordtuckfield.com/emailresults1.csv](https://bradfordtuckfield.com/emailresults1.csv)下载这些数据；并将其存储在你运行Python的同一目录下。然后，你可以按如下方式将其读取到Python会话中：
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'If you run `print(emailresults1.head())` in Python, you can see the first rows
    of this new data. It’s a simple dataset: each row corresponds to one individual
    desktop email subscriber, whose ID is identified in the `userid` column. The `revenue`
    column records the revenue your company earned from each user as a result of this
    email campaign.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在Python中运行`print(emailresults1.head())`，你可以看到这组新数据的前几行。这是一个简单的数据集：每一行对应一个个人桌面邮件订阅者，其ID在`userid`列中标识。`revenue`列记录了你公司通过这次电子邮件活动从每个用户那里获得的收入。
- en: 'It will be useful to have this new revenue information in the same dataframe
    as our other information about each user. Let’s join the datasets:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些新的收入信息与我们关于每个用户的其他信息放在同一个数据框中是非常有用的。让我们合并这些数据集：
- en: '[PRE4]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In this snippet, we use the pandas `merge()` method to combine our dataframes.
    We specify `on='userid'`, meaning that we take the row of `emailresults1` that
    corresponds to a particular `userid` and merge it with the row of `groupa` that
    corresponds to that same `userid`. The end result of using `merge()` is a dataframe
    in which every row corresponds to a particular user identified by their unique
    `userid`. The columns tell us not only about their characteristics like age but
    also about the revenue we earned from them as a result of our recent email campaign.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个代码片段中，我们使用pandas的`merge()`方法来合并数据框。我们指定`on='userid'`，这意味着我们将`emailresults1`中与特定`userid`对应的行与`groupa`中与该`userid`相对应的行合并。使用`merge()`的最终结果是一个数据框，其中每一行对应一个通过其唯一`userid`识别的用户。列中不仅告诉我们关于用户的特征（如年龄），还告诉我们通过最近的电子邮件活动从他们那里获得的收入。
- en: 'After preparing our data, it’s simple to perform a t-test to check whether
    our groups are different. We can do it in one line, as follows:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在准备好数据之后，进行t检验来检查我们的组是否有差异变得简单。我们可以通过一行代码来完成，如下所示：
- en: '[PRE5]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'When you run this code, you’ll get the following result:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当你运行这段代码时，你将得到如下结果：
- en: '[PRE6]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The important part of this output is the `pvalue` variable, which tells us
    the *p*-value of our test. We can see that the result says that *p* = 0.037, approximately.
    Since *p* < 0.05, we can conclude that this is a statistically significant difference.
    We can check the size of the difference:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 输出中重要的部分是`pvalue`变量，它告诉我们测试的*p*-值。我们可以看到结果显示*p* ≈ 0.037。由于*p* < 0.05，我们可以得出结论，这是一种具有统计学意义的差异。我们可以检查差异的大小：
- en: '[PRE7]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The output is 125.0\. The average `groupb` customer has outspent the average
    `groupa` customer by $125\. This difference is statistically significant, so we
    reject Hypothesis 0 in favor of Hypothesis 1, concluding (for now, at least) that
    the blue text in marketing emails leads to about $125 more in revenue per user
    than black text.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果是 125.0。平均而言，`groupb` 的客户比 `groupa` 的客户多花费了 $125。这一差异在统计学上具有显著性，因此我们拒绝零假设，支持假设一，得出结论（至少目前为止）认为营销邮件中的蓝色文本使每个用户的收入比黑色文本多出约
    $125。
- en: 'What we have just done was an *experiment*. We split a population into two
    groups, performed different actions on each group, and compared the results. In
    the context of business, such an experiment is often called an *A/B test*. The
    *A/B* part of the name refers to the two groups, Group A and Group B, whose different
    responses to emails we compared. Every A/B test follows the same pattern we went
    through here: a split into two groups, application of a different treatment (for
    example, sending different emails) to each group, and statistical analysis to
    compare the groups’ outcomes and draw conclusions about which treatment is better.'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚做的是一个*实验*。我们将一个人群分成两组，对每组进行不同的处理，并比较结果。在商业环境中，这种实验通常被称为 *A/B 测试*。名称中的 *A/B*
    部分指的是两组，A 组和 B 组，我们比较了它们对电子邮件的不同反应。每个 A/B 测试遵循我们这里经历的相同模式：将人群分成两组，对每组施加不同的处理（例如，发送不同的电子邮件），并通过统计分析比较两组的结果，得出哪个处理更好的结论。
- en: 'Now that we’ve successfully conducted an A/B test, we may want to conclude
    that the effect of blue text is to increase spending by $125\. However, something
    is wrong with the A/B test we ran: it’s *confounded*. To see what we mean, consider
    [Table 4-1](#table4-1).'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经成功进行了 A/B 测试，我们可能会得出结论，蓝色文本的效果是增加 $125 的支出。然而，我们进行的 A/B 测试存在问题：它是*混淆的*。为了更好地理解这一点，参考
    [表 4-1](#table4-1)。
- en: 'Table 4-1: Differences Between Groups'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 表 4-1：组间差异
- en: '|  | **Group A** | **Group B** |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '|  | **A 组** | **B 组** |'
- en: '| --- | --- | --- |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **Personal characteristics** | Younger (Same as B in other ways) | Older
    (Same as A in other ways) |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| **个人特征** | 年轻（其他方面与 B 组相同） | 年长（其他方面与 A 组相同） |'
- en: '| **Email text color** | Black | Blue |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| **电子邮件文本颜色** | 黑色 | 蓝色 |'
- en: '| **Average revenue per user** | $104 | $229 |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| **每用户平均收入** | $104 | $229 |'
- en: 'We can see the important features of Group A and Group B. Our t-test comparing
    spending found that their spending levels were significantly different. We want
    an explanation for why they’re different, and any explanation of different outcomes
    will have to rely on the differences listed in [Table 4-1](#table4-1). We want
    to be able to conclude that the difference in spending can be explained by the
    difference in the text color. However, that difference coexists with another difference:
    age.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到 A 组和 B 组的重要特征。我们通过 t 检验比较了它们的支出，结果发现它们的支出水平有显著差异。我们想要解释为什么它们的支出不同，任何对不同结果的解释都必须依赖于
    [表 4-1](#table4-1) 中列出的差异。我们希望得出结论，支出差异可以通过文本颜色的不同来解释。然而，这种差异与另一个差异并存：年龄。
- en: We can’t be certain that the difference in spending levels is due to text color
    rather than age. For example, perhaps no one even noticed the text difference,
    but older people tend to be wealthier and more eager to buy your products than
    young people. If so, our A/B test didn’t test for the effect of blue text, but
    rather for the effect of age or wealth. We intended to study only the effect of
    text color in this A/B test, and now we don’t know whether we truly studied that
    or whether we studied age, wealth, or something else. It would be better if our
    A/B test had a simpler, non-confounded design like the one illustrated in [Table
    4-2](#table4-2).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不能确定支出水平的差异是由文本颜色引起的，而不是由年龄差异引起的。例如，也许根本没有人注意到文本颜色的不同，但年长的人通常比年轻人更富有，也更愿意购买你的产品。如果真是这样，那么我们的
    A/B 测试并不是在测试蓝色文本的效果，而是在测试年龄或财富的影响。我们原本只打算研究文本颜色的影响，但现在我们不知道到底是在研究文本颜色，还是在研究年龄、财富，或者其他因素。如果我们的
    A/B 测试有一个更简单、不带混淆因素的设计，像 [表 4-2](#table4-2) 中所示的那样，那就更好了。
- en: 'Table 4-2: A Non-confounded A/B Test Design'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 表 4-2：一个无混淆的 A/B 测试设计
- en: '|  | **Group C** | **Group D** |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '|  | **C 组** | **D 组** |'
- en: '| --- | --- | --- |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **Personal characteristics** | (Same as D in every way) | (Same as C in every
    way) |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| **个人特征** | （与 D 组完全相同） | （与 C 组完全相同） |'
- en: '| **Email text color** | Black | Blue |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| **电子邮件文本颜色** | 黑色 | 蓝色 |'
- en: '| **Average revenue per user** | $104 | $229 |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| **每用户平均收入** | $104 | $229 |'
- en: '[Table 4-2](#table4-2) imagines that we had split the users into hypothetical
    groups called C and D, which are identical in all personal characteristics, but
    differ only in the text of the emails they received. In this hypothetical scenario,
    the spending difference can be explained only by the different text colors sent
    to each group because that’s the only difference between them. We should have
    split our groups in a way that ensured that the only differences between groups
    were in our experimental treatment, not in the group members’ preexisting characteristics.
    If we had done so, we would have avoided having a confounded experiment.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '[表格 4-2](#table4-2) 假设我们将用户分成了两个假设的组，C组和D组，这两个组在所有个人特征上都是相同的，唯一的区别是他们收到的邮件文本不同。在这个假设场景下，消费差异只能通过不同的文本颜色来解释，因为这是它们之间唯一的区别。我们应该以一种确保组与组之间唯一差异来自实验处理，而非组成员先前特征的方式来分组。如果我们这么做了，就能避免实验中的混杂效应。'
- en: Understanding the Math of A/B Testing
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 理解A/B测试中的数学原理
- en: 'We can also express these notions mathematically. We can use the common statistical
    notation *E*() to refer to the expected value. So *E*(*A’s revenue with blk text*)
    will mean *the expected value of revenue we would earn by sending a black-text
    email to Group A*. We can write two simple equations that describe the relationship
    between the revenue we expect to earn from black text, the effect of our experiment,
    and the revenue we expect to earn from blue text:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以用数学的方式来表示这些概念。我们可以使用常见的统计符号*E*()来表示期望值。所以*E*(*A使用黑色文本时的收入*)就表示*我们通过给A组发送黑色文本邮件所能获得的期望收入*。我们可以写出两个简单的方程，描述我们期望从黑色文本、实验效应和蓝色文本中获得的收入之间的关系：
- en: '*E*(*A’s revenue with blk text*) + *E*(*effect of changing blk → blue on A*)
    = *E*(*A’s revenue with blue text*)'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '*E*(*A使用黑色文本时的收入*) + *E*(*将黑色文本改为蓝色对A的影响*) = *E*(*A使用蓝色文本时的收入*)'
- en: '*E*(*B’s revenue with blk text*) + *E*(*effect of changing blk → blue on B*)
    = *E*(*B’s revenue with blue text*)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '*E*(*B使用黑色文本时的收入*) + *E*(*将黑色文本改为蓝色对B的影响*) = *E*(*B使用蓝色文本时的收入*)'
- en: 'To decide whether to reject Hypothesis 0, we need to solve for the effect sizes:
    *E*(*effect of changing blk → blue on A*) and *E*(*effect of changing blk → blue
    on B*). If either of these effect sizes is different from 0, we should reject
    Hypothesis 0\. By performing our experiment, we found *E*(*A’s revenue with blk
    text*) = 104 and *E*(*B’s revenue with blue text*) = 229\. After knowing these
    values, we have the following equations:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 为了决定是否拒绝假设0，我们需要求解效应值：*E*(*将黑色文本改为蓝色对A的影响*)和*E*(*将黑色文本改为蓝色对B的影响*)。如果其中任何一个效应值不为0，我们就应该拒绝假设0。通过实验，我们发现*E*(*A使用黑色文本时的收入*)
    = 104，*E*(*B使用蓝色文本时的收入*) = 229。知道这些数值后，我们可以得到以下方程：
- en: 104 + *E*(*effect of changing blk → blue on A*) = *E*(*A’s revenue with blue
    text*)
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 104 + *E*(*将黑色文本改为蓝色对A的影响*) = *E*(*A使用蓝色文本时的收入*)
- en: '*E*(*B’s revenue with blk text*) + *E*(*effect of changing blk → blue on B*)
    = 229'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '*E*(*B使用黑色文本时的收入*) + *E*(*将黑色文本改为蓝色对B的影响*) = 229'
- en: 'But this still leaves many variables we don’t know, and we’re not yet able
    to solve for *E*(*effect of changing blk → blue on A*) and *E*(*effect of changing
    blk → blue on B*). The only way we’ll be able to solve for our effect sizes will
    be if we can simplify these two equations. For example, if we knew that *E*(*A’s
    revenue with blk text*) = *E*(*B’s revenue with blk text*), and *E*(*effect of
    changing blk → blue on A*) = *E*(*effect of changing blk → blue on B*), and *E*(*A’s
    revenue with blue Text*) = *E*(*B’s revenue with blue text*), then we could reduce
    these two equations to just one simple equation. If we knew that our groups were
    identical before our experiment, we would know that all of these expected values
    were equal, and we could simplify our two equations to the following easily solvable
    equation:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 但这仍然存在许多我们不知道的变量，并且我们还无法解出*E*(*将黑色文本改为蓝色对A的影响*)和*E*(*将黑色文本改为蓝色对B的影响*)。要解决这些效应值，唯一的方法是简化这两个方程。例如，如果我们知道*E*(*A使用黑色文本时的收入*)
    = *E*(*B使用黑色文本时的收入*)，并且*E*(*将黑色文本改为蓝色对A的影响*) = *E*(*将黑色文本改为蓝色对B的影响*)，且*E*(*A使用蓝色文本时的收入*)
    = *E*(*B使用蓝色文本时的收入*)，那么我们就可以将这两个方程简化为一个简单的方程。如果我们知道实验前我们的组是相同的，那么我们就知道这些期望值都是相等的，从而能够轻松简化我们的两个方程，得到一个可解的方程：
- en: 104 + *E*(*effect of changing blk → blue on everyone*) = 229
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 104 + *E*(*将黑色文本改为蓝色对每个人的影响*) = 229
- en: With this, we can be sure that the effect of blue text is a $125 revenue increase.
    This is why we consider it so important to design non-confounded experiments in
    which the groups have equal expected values for personal characteristics. By doing
    so, we’re able to solve the preceding equations and be confident that our measured
    effect size is actually the effect of what we’re studying and not the result of
    different underlying characteristics.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这个，我们可以确信蓝色文本的效果是$125的收入增加。这就是为什么我们认为设计没有混杂因素的实验如此重要，在这些实验中，各组在个人特征上的期望值相等。通过这样做，我们能够解出之前的方程，并且可以自信地认为我们测量的效应大小实际上是我们研究的内容的效应，而不是不同潜在特征的结果。
- en: Translating the Math into Practice
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将数学转化为实践
- en: We know what to do mathematically, but we need to translate that into practical
    action. How should we ensure that *E*(*A’s revenue with blk text*) = *E*(*B’s
    revenue with blk text*), and how should we ensure that the other expected values
    are all the same? In other words, how can we ensure that our study design looks
    like [Table 4-2](#table4-2) instead of [Table 4-1](#table4-1)? We need to find
    a way to select subgroups of our desktop subscriber list that are expected to
    be identical.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们知道该如何从数学上处理，但我们需要将其转化为实际行动。我们应该如何确保*E*(*A使用蓝色文本的收入*) = *E*(*B使用蓝色文本的收入*)，并且如何确保其他期望值都是相同的？换句话说，我们如何确保我们的研究设计像[表格4-2](#table4-2)而不是[表格4-1](#table4-1)？我们需要找到一种方法，从我们的桌面订阅者列表中选择预期相同的子组。
- en: 'The simplest way to select subgroups that are expected to be identical is to
    select them randomly. We mentioned this briefly in Chapter 3: every random sample
    from a population has an expected value equal to the population mean. So, we expect
    that two random samples from the same population won’t differ from each other
    significantly.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 选择预期相同的子组最简单的方法是随机选择。我们在第3章中简要提到过这一点：来自一个总体的每个随机样本，其期望值等于总体均值。因此，我们预期来自同一总体的两个随机样本之间不会有显著差异。
- en: 'Let’s perform an A/B test on our laptop subscriber list, but this time we’ll
    use randomization to select our groups to avoid having a confounded experimental
    design. Suppose that in this new A/B test, we want to test whether adding a picture
    to a marketing email will improve revenue. We can proceed just as we did before:
    we split the laptop subscriber list into two subgroups, and we send different
    emails to each subgroup. The difference is that this time, instead of splitting
    based on age, we perform a random split:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对我们的笔记本电脑订阅者列表进行A/B测试，但这次我们将使用随机化来选择我们的组，以避免出现混杂的实验设计。假设在这个新的A/B测试中，我们想要测试在营销邮件中添加图片是否会提高收入。我们可以像之前一样进行：我们将笔记本电脑订阅者列表分成两个子组，并向每个子组发送不同的邮件。不同之处在于，这次我们不是根据年龄分组，而是进行随机分组：
- en: '[PRE8]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: In this snippet, we use the NumPy `random.random()` method to generate a column
    that consists of randomly generated 0s and 1s. We can interpret a 0 to mean that
    a user belongs to Group C, and a 1 to mean that a user belongs to group D. When
    we generate 0s and 1s randomly like this, the groups could end up with different
    sizes. However, here we use a *random seed* (in the first line, `np.random.seed(18811015)`).
    Every time anyone uses this random seed, their “randomly” generated column of
    0s and 1s will be identical. That means that if you use this random seed, your
    results at home should be the same as the results here in the book. Using a random
    seed is not necessary, but if you use the same random seed we used here, you should
    find that both Group C and Group D have 15 members.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个代码片段中，我们使用NumPy的`random.random()`方法生成一个包含随机生成的0和1的列。我们可以将0解释为用户属于C组，而1表示用户属于D组。当我们像这样随机生成0和1时，两个组可能会有不同的大小。然而，在这里我们使用了一个*随机种子*（在第一行，`np.random.seed(18811015)`）。每当有人使用这个随机种子时，他们“随机”生成的0和1列将是相同的。这意味着如果你使用这个随机种子，你在家里得到的结果应该和书中的结果一样。使用随机种子并不是必须的，但如果你使用我们这里使用的相同随机种子，你应该会发现C组和D组各有15个成员。
- en: After generating this random column of 0s and 1s that indicates the group assignment
    of each customer, we create two smaller dataframes, `groupc` and `groupd`, that
    contain user IDs and information about the users in each subgroup.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在生成了一个包含0和1的随机列，表示每个客户的组别分配后，我们创建了两个更小的数据框，`groupc`和`groupd`，它们包含了每个子组中用户的ID和信息。
- en: 'You can send the group membership information to your marketing team members
    and ask them to send the right emails to the right groups. One group, either C
    or D, should receive an email without a picture, and the other group, either D
    or C, should receive an email with a picture. Then, suppose that the marketing
    team sends you a file containing the results of this latest A/B test. You can
    download a fabricated dataset containing hypothetical results from [https://bradfordtuckfield.com/emailresults2.csv](https://bradfordtuckfield.com/emailresults2.csv).
    After you store it in the same place where you’re running Python, let’s read the
    results of this email campaign into Python as follows:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将群组成员信息发送给你的营销团队成员，并请他们向正确的群组发送相应的邮件。一个群组，可以是C组或D组，应该收到没有图片的邮件，而另一个群组，可以是D组或C组，应该收到带有图片的邮件。假设营销团队随后将最新的A/B测试结果文件发送给你，你可以从[https://bradfordtuckfield.com/emailresults2.csv](https://bradfordtuckfield.com/emailresults2.csv)下载一个包含假设结果的虚构数据集。在你将数据存储在运行Python的同一位置后，接下来让我们按照以下方式将这个邮件活动的结果读取到Python中：
- en: '[PRE9]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Again, let’s join our email results to our group dataframes, just as we did
    before:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，让我们将邮件结果与群组数据框连接起来，就像我们之前做的那样：
- en: '[PRE10]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'And again, we can use a t-test to check whether the revenue resulting from
    Group C is different from the revenue we get from Group D:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用t检验来检查C组的收入是否与D组的收入不同：
- en: '[PRE11]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We find that the *p*-value is less than 0.05, indicating that the difference
    between the groups is statistically significant. This time, our experiment isn’t
    confounded, because we used random assignment to ensure that the differences between
    groups are the result of our different emails, not the result of different characteristics
    of each group. Since our experiment isn’t confounded, and since we find a significant
    difference between the revenues earned from Group C and Group D, we conclude that
    including the picture in the email has a nonzero effect. If the marketing team
    tells us that it sent the picture only to Group D, we can find the estimated size
    of the effect easily:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们发现*p*-值小于0.05，这表明两个群组之间的差异具有统计学意义。此次实验没有被混淆，因为我们使用了随机分配，以确保群组之间的差异是由于我们不同的邮件，而不是各组特征的差异。由于我们的实验没有受到混淆，而且我们发现C组和D组之间的收入差异显著，我们可以得出结论：在邮件中加入图片具有非零的效果。如果营销团队告诉我们他们只将图片发送给了D组，我们可以轻松地找出效果的估算大小：
- en: '[PRE12]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'We calculate the estimated effect here with subtraction: the mean revenue obtained
    from subjects in Group D minus the mean revenue obtained from subjects in Group
    C. The difference between mean revenue from Group C and mean revenue from Group
    D, about $260, is the size of the effect of our experiment.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里通过减法计算估算的效果：即D组参与者获得的平均收入减去C组参与者获得的平均收入。C组与D组之间的平均收入差异，约为$260，这就是我们实验效果的大小。
- en: The process we follow for A/B testing is really quite simple, but it’s also
    powerful. We can use it for a wide variety of questions that we might want to
    answer. Anytime you’re unsure about an approach to take in business, especially
    in user interactions and product design, considering an A/B test as an approach
    to learn the answer is worthwhile. Now that you know the process, let’s move on
    and understand its nuances.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 我们进行A/B测试的过程其实非常简单，但它也非常强大。我们可以用它来回答各种各样的问题，尤其是那些我们在业务决策中可能遇到的疑问。任何时候，如果你对采取何种方法感到不确定，特别是在用户互动和产品设计方面，考虑采用A/B测试作为一种学习答案的方法是值得的。现在你已经了解了这个过程，接下来我们将继续深入了解它的细节。
- en: Optimizing with the Champion/Challenger Framework
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用冠军/挑战者框架进行优化
- en: 'When we’ve crafted a great email, we might call it our *champion* email design:
    the one that, according to what we know so far, we think will perform the best.
    After we have a champion email design, we may wish to stop doing A/B testing and
    simply rest on our laurels, collecting money indefinitely from our “perfect” email
    campaigns.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们制作出一封很棒的邮件时，我们可能会称其为我们的*冠军*邮件设计：根据我们迄今为止所了解的情况，我们认为它的表现会最好。一旦我们有了一个冠军邮件设计，我们可能会想停止进行A/B测试，直接停下来，依赖我们“完美”的邮件活动源源不断地收钱。
- en: 'But this isn’t a good idea, for a few reasons. The first is that times change.
    Fads in design and marketing change quickly, and a marketing effort that seems
    exciting and effective today may soon seem dated and outmoded. Like all champions,
    your champion email design will become weaker and less effective as it ages. Even
    if design and marketing fads *don’t* change, your champion will eventually seem
    boring as the novelty wears off: new stimuli are more likely to get people’s attention.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 但这并不是一个好主意，原因有几个。首先，时代在变化。设计和营销的潮流变化很快，一个今天看起来令人兴奋且有效的营销手段，很快可能会变得过时和落后。像所有冠军一样，你的冠军邮件设计会随着时间的推移变得更弱、更无效。即使设计和营销潮流
    *没有* 变化，随着新鲜感的消退，你的冠军邮件最终会显得乏味：新的刺激更容易吸引人们的注意。
- en: Another reason that you shouldn’t stop A/B testing is that your customer base
    will change. You’ll lose some old customers and gain new ones. You’ll release
    new products and enter new markets. As your customer mix changes, the types of
    emails that they tend to respond to will change as well, and constant A/B testing
    will enable you to keep up with their changing characteristics and preferences.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 你不应该停止 A/B 测试的另一个原因是，你的客户群会发生变化。你将失去一些老客户并获得新客户。你会发布新产品并进入新市场。随着客户群体的变化，他们倾向于响应的邮件类型也会发生变化，持续的
    A/B 测试将帮助你跟上他们不断变化的特点和偏好。
- en: A final reason to continue A/B testing is that although your champion likely
    is good, you might not have optimized it in every possible way. A dimension you
    haven’t tested yet could enable you to have an even better champion that gets
    even better performance. If we can successfully run one A/B test and learn one
    thing, we’ll naturally want to continue to use our A/B testing skills to learn
    more and more and to increase profits higher and higher.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 继续 A/B 测试的另一个原因是，尽管你的冠军邮件可能已经不错，但你可能还没有在所有可能的方面对它进行优化。你尚未测试的某个维度可能会让你拥有一个更优秀的冠军邮件，从而获得更好的表现。如果我们能够成功地进行一次
    A/B 测试并学到一些东西，我们自然会希望继续使用 A/B 测试技巧，学到更多，并将利润推向更高。
- en: Suppose you have a champion email and want to continue A/B testing to try to
    improve it. You do another random split of your users, into a new Group A and
    a new Group B. You send the champion email to Group A. You send another email
    to Group B that differs from the champion email in one way that you want to learn
    about; for example, maybe it uses formal rather than informal language. When we
    compare the revenues from Group A and Group B after the email campaign, we’ll
    be able to see whether this new email performs better than the champion email.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有一封冠军邮件，并希望继续进行 A/B 测试，以尝试改进它。你再次将用户随机分组，分为新的 A 组和 B 组。你将冠军邮件发送给 A 组。你将另一封与冠军邮件在某个方面有所不同的邮件发送给
    B 组，你希望通过这种方式获得一些信息；例如，也许它使用了正式的语言而不是非正式的语言。当我们在邮件活动结束后比较 A 组和 B 组的收入时，我们将能够看出这封新邮件是否比冠军邮件效果更好。
- en: Since the new email is in direct competition with the champion email, we call
    it the *challenger*. If the champion performs better than the challenger, the
    champion retains its champion status. If the challenger performs better than the
    champion, that challenger becomes the new champion.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这封新邮件与冠军邮件直接竞争，我们称其为 *挑战者*。如果冠军邮件的表现优于挑战者，冠军将保留其冠军地位。如果挑战者的表现优于冠军，那么这个挑战者将成为新的冠军。
- en: 'This process can continue indefinitely: we have a champion that represents
    the state of the art of whatever we’re doing (marketing emails, in this case).
    We constantly test the champion by putting it in direct competition with a succession
    of challengers in A/B tests. Each challenger that leads to significantly better
    outcomes than the champion becomes the new champion and is, in turn, put into
    competition against new challengers later.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程可以无限持续下去：我们拥有一个代表我们所做事情（在这里是营销邮件）最前沿水平的冠军邮件。我们不断通过与一系列挑战者在 A/B 测试中进行直接竞争来测试冠军邮件。每当某个挑战者的结果显著优于冠军邮件时，这个挑战者就会成为新的冠军，并且将与新的挑战者进行后续的竞争。
- en: This endless process is called the *champion/challenger framework* for A/B tests.
    It’s meant to lead to continuous improvement, continuous refinement, and asymptotic
    optimization to get to the best-possible performance in all aspects of business.
    The biggest tech companies in the world run literally hundreds of A/B tests per
    day, with hundreds of challengers taking on hundreds of champions, sometimes defeating
    them and sometimes being defeated. The champion/challenger framework is a common
    approach for setting up and running A/B tests for the most important and most
    challenging parts of your business.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 这个不断进行的过程被称为*冠军/挑战者框架*，用于A/B测试。它旨在通过持续改进、不断优化，逐步实现业务各个方面的最佳表现。世界上最大的科技公司每天都进行数百次A/B测试，数百个挑战者与数百个冠军对抗，有时会战胜他们，有时会被击败。冠军/挑战者框架是为业务中最重要和最具挑战性的部分设置和运行A/B测试的常见方法。
- en: Preventing Mistakes with Twyman’s Law and A/A Testing
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通过Twyman定律和A/A测试防止错误
- en: A/B testing is a relatively simple process from beginning to end. Nevertheless,
    we are all human and make mistakes. In any data science effort, not just A/B testing,
    it’s important to proceed carefully and constantly check whether we’ve done something
    wrong. One piece of evidence that often indicates that we’ve done something wrong
    is that things are going too well.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: A/B测试从头到尾是一个相对简单的过程。然而，我们都是人，难免会犯错。在任何数据科学工作中，不仅仅是A/B测试，谨慎行事并不断检查是否存在错误是非常重要的。一个常见的证据，表明我们可能做错了什么，就是事情进展得过于顺利。
- en: 'How could it be bad for things to go too well? Consider a simple example. You
    perform an A/B test: Group A gets one email, and Group B gets a different one.
    You measure revenue from each group afterward and find that the average revenue
    earned from members of Group A is about $25, while the average revenue earned
    from members of Group B is $99,999\. You feel thrilled about the enormous revenue
    you earned from Group B. You call all your colleagues to an emergency meeting
    and tell them to stop everything they’re doing and immediately work on implementing
    the email that Group B got and pivot the whole company strategy around this miracle
    email.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切进展顺利，怎么会不好呢？考虑一个简单的例子。你进行了一次A/B测试：A组收到一封电子邮件，B组收到另一封。然后你衡量了每组的收入，发现A组的平均收入大约为$25，而B组的平均收入为$99,999。你为B组获得的巨大收入感到兴奋。你召集所有同事开紧急会议，告诉他们立即停止手头的工作，立即实施B组收到的电子邮件，并围绕这个奇迹般的电子邮件调整公司的整体战略。
- en: As your colleagues are working around the clock on sending the new email to
    everyone they know, you start to feel a nagging sense of doubt. You think about
    how unlikely it is that a single email campaign could plausibly earn almost $100,000
    in revenue per recipient, especially when your other campaigns are earning only
    about $25 per user. You think about how $99,999, the amount of revenue you supposedly
    earned per user, is five identical digits repeated. Maybe you remember a conversation
    you had with a database administrator who told you that your company database
    automatically inserts 99999 every time a database error occurs or data is missing.
    Suddenly, you realize that your email campaign didn’t really earn $99,999 per
    user, but rather a database error for Group B caused the appearance of the apparently
    miraculous result.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 当你的同事们日以继夜地将新的电子邮件发送给他们认识的每个人时，你开始感到一种挥之不去的疑虑。你开始思考，单一的电子邮件活动几乎每个收件人就能赚取接近$100,000的收入，这种情况是多么不太可能，尤其是当你其他的活动每个用户仅赚取大约$25时。你还想到了$99,999这个数字——据说你每个用户赚取的收入，它是五个相同的数字重复出现的。也许你还记得曾与一位数据库管理员的对话，他告诉你公司数据库每当出现数据库错误或数据丢失时，系统会自动插入99999。突然间，你意识到，实际上你的电子邮件活动并没有真的为每个用户赚取$99,999，而是由于B组的数据库错误导致了这一看似奇迹般的结果。
- en: 'A/B testing is a simple process from a data science point of view, but it can
    be quite complex from a practical and social point of view. For example, in any
    company larger than a tiny startup, the creative people designing marketing emails
    will be different from the technology people who maintain the databases that record
    revenues per user. Other groups may be involved in little parts of A/B testing:
    maybe a group that maintains the software used to schedule and send out emails,
    maybe a group that creates art that the email marketing team asks for, and maybe
    others.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 从数据科学的角度来看，A/B测试是一个简单的过程，但从实践和社会角度来看，它可能相当复杂。例如，在任何比微小创业公司更大的公司中，设计营销电子邮件的创意人员与维护记录每个用户收入的数据库的技术人员不同。其他小组可能会参与A/B测试中的某些小部分：也许是一个负责维护安排和发送电子邮件软件的小组，也许是一个为电子邮件营销团队制作艺术设计的小组，甚至可能还有其他小组。
- en: With all these groups and steps involved, many possible chances exist for miscommunication
    and small errors. Maybe two different emails are designed, but the person who’s
    in charge of sending them out doesn’t understand A/B testing and copies and pastes
    the same email to both groups. Maybe they accidentally paste in something that’s
    not even supposed to be in the A/B test at all. In our example, maybe the database
    that records revenues encounters an error and puts 99999 in the results as an
    error code, which others mistakenly interpret as a high revenue. No matter how
    careful we try to be, mistakes and miscommunications will always find a way to
    happen.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在涉及这些小组和步骤的情况下，存在许多可能导致沟通不畅和小错误的机会。也许设计了两封不同的电子邮件，但负责发送的人不了解A/B测试，结果将相同的电子邮件复制粘贴到两个小组中。也许他们不小心粘贴了本不应该出现在A/B测试中的内容。在我们的例子中，也许记录收入的数据库出现了错误，把99999当作错误代码写入结果，其他人误以为这是一个高收入的表现。无论我们如何小心，错误和误解总会找到发生的方式。
- en: The inevitability of mistakes should lead us to be naturally suspicious of anything
    that seems too good, bad, interesting, or strange to be true. This natural suspicion
    is advocated by *Twyman’s law*, which states that “any figure that looks interesting
    or different is usually wrong.” This law has been restated in several ways, including
    “any statistic that appears interesting is almost certainly a mistake” and “the
    more unusual or interesting the data, the more likely it is to have been the result
    of an error.”
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 错误的不可避免性应该使我们自然地对任何看起来过于好、坏、有趣或奇怪的事物保持怀疑。这种天然的怀疑是*Twyman法则*所提倡的，法则指出“任何看起来有趣或不同的数字通常是错误的。”这一法则已经以几种不同的方式重新表述过，包括“任何看起来有趣的统计数据几乎肯定是个错误”和“数据越不寻常或有趣，就越可能是错误的结果。”
- en: 'Besides extreme carefulness and natural suspicion of good news, we have another
    good way to prevent the kinds of interpretive mistakes that Twyman’s law warns
    against: *A/A testing*. This type of testing is just what it sounds like; we go
    through the steps of randomization, treatment, and comparison of two groups just
    as in A/B testing, but instead of sending two different emails to our two randomized
    groups, we send the identical email to each group. In this case, we expect the
    null hypothesis to be true, and we won’t be gullibly convinced by a group that
    appears to get $100,000 more revenue than the other group.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 除了极度小心和对好消息的天然怀疑外，我们还有另一种有效的方式来防止类似*Twyman法则*所警告的解释性错误：*A/A测试*。这种测试和字面意思一样；我们按照A/B测试中的步骤进行随机化、处理和比较两个小组，但我们不是向两个随机小组发送不同的电子邮件，而是向每个小组发送完全相同的电子邮件。在这种情况下，我们期望零假设成立，并且不会轻易被一个看似获得比另一个小组多$100,000收入的组所说服。
- en: 'If we consistently find that A/A tests lead to statistically significant differences
    between groups, we can conclude that our process has a problem: a database gone
    haywire, a t-test being run incorrectly, an email being pasted wrong, randomization
    performed incorrectly, or something else. An A/A test would also help us realize
    that the first test described in this chapter (where Group A consists of younger
    people and Group B consists of older people) was confounded, since we would know
    that differences between the results of an A/A test must be due to the differences
    in age rather than differences between emails. A/A testing can be a useful sanity
    check that can prevent us from getting carried away by the kind of unusual, interesting,
    too-good-to-be-true results that Twyman’s law warns us about.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们一贯发现A/A测试在组间产生了统计学上显著的差异，我们可以得出结论：我们的过程存在问题：数据库出现故障、t检验运行不正确、邮件粘贴错误、随机化执行不当，或者其他问题。A/A测试还帮助我们意识到本章描述的第一个测试（其中组A由年轻人组成，组B由老年人组成）是有混淆的，因为我们会知道A/A测试结果之间的差异一定是由于年龄差异，而不是邮件之间的差异。A/A测试可以作为一个有用的理智检查，防止我们被Twyman定律警告的那种不寻常、有趣、看似太好以至于不真实的结果所冲昏头脑。
- en: Understanding Effect Sizes
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解效应大小
- en: In the first A/B test we ran, we observed a difference of $125 between the Group
    A users who received a black-text email and the Group B users who received a blue-text
    email. This $125 difference between groups is also called the A/B test’s *effect
    size*. It’s natural to try to form a judgment about whether we should consider
    this $125 effect size a small effect, a medium effect, or a large effect.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进行的第一次A/B测试中，我们观察到组A（收到黑色文字邮件的用户）和组B（收到蓝色文字邮件的用户）之间的差异为$125。这个组间的$125差异也被称为A/B测试的*效应大小*。我们自然会尝试判断是否应该将这个$125的效应大小视为小效应、中效应，还是大效应。
- en: 'To judge whether an effect is small or large, we have to compare it to something
    else. Consider the following list of nominal GDP figures (in US dollars, as of
    2019) for Malaysia, Myanmar, and the Marshall Islands, respectively:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 要判断一个效应是小还是大，我们必须将其与其他内容进行比较。考虑以下各国的名义GDP数据（以2019年为准，单位为美元），分别是马来西亚、缅甸和马绍尔群岛：
- en: '[PRE13]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'When we look at these numbers, $125 starts to seem pretty small. For example,
    consider the standard deviation of our `gdps` list:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们看到这些数字时，$125开始显得相当小。例如，考虑我们`gdps`列表的标准差：
- en: '[PRE14]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The result is 158884197328.32672, or about $158,884,197,328 (almost $159 billion).
    The standard deviation is a common way to measure how dispersed a dataset is.
    If we observe a difference between two countries’ GDPs that’s about $80 billion,
    we don’t think of that as outrageously big or outrageously small, because it means
    those countries are about half of a standard deviation apart, a common magnitude
    of difference. Instead of expressing the difference as an $80 billion difference,
    you might say that the two countries’ GDPs differed by about half of a standard
    deviation, and expect to be understood by anyone with some statistical training.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是158884197328.32672，约为$158,884,197,328（几乎是1590亿美元）。标准差是衡量数据集分散程度的常用方法。如果我们观察到两个国家的GDP差异约为800亿美元，我们不会认为这个差异是极其大或极其小，因为这意味着这两个国家的GDP大约相差一个标准差的一半，这是一个常见的差异规模。与其将差异表示为800亿美元的差异，不如说这两个国家的GDP相差了大约一个标准差的一半，并且预计任何具备一些统计学训练的人都会理解这一点。
- en: By contrast, if someone tells you that two countries have GDPs that differ by
    112 trillion kyat (the currency of Myanmar), you might be unsure whether that
    difference is large or small if you’ve never learned the value of 1 kyat (112
    trillion kyat is equal to about $80 billion at the time of writing). Many currencies
    exist in the world, and their relative and absolute values change all the time.
    A standard deviation, on the other hand, isn’t specific to any particular country
    and is not affected by inflation, making it a useful unit of measurement.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，如果有人告诉你两个国家的GDP差异为112万亿缅元（缅甸的货币），如果你从未了解过1缅元的价值，你可能不确定这个差异是大还是小（112万亿缅元大约等于$800亿美元，按写作时的汇率计算）。世界上存在许多货币，它们的相对和绝对价值一直在变化。而标准差则不会特定于任何某个国家，也不受通货膨胀的影响，因此它是一个有用的衡量单位。
- en: We can use standard deviations as measurements in other domains as well. Someone
    from Europe may be used to using meters to express heights. When you tell your
    European data scientist friend about a man who’s 75 inches tall, they may feel
    puzzled about whether that’s tall or short or average if they’re not used to conversion
    from inches. But, if you tell them that he’s about two standard deviations taller
    than the mean, they should immediately be able to understand that he’s pretty
    tall but not a record-breaking height. Observing someone who’s more than three
    standard deviations above the mean height will be much rarer, and we can know
    that whether we’re measuring in meters or inches or any other units.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以在其他领域使用标准差作为衡量标准。来自欧洲的人可能习惯于使用米来表示身高。当你告诉你的欧洲数据科学家朋友某个人身高为75英寸时，如果他们不习惯从英寸换算，他们可能会困惑这个身高是高还是矮还是平均。如果你告诉他们这个人比平均值高了大约两个标准差，他们应该立刻明白他挺高的，但并不算破纪录的高度。观察身高比平均值高出三个标准差以上的人将会更为罕见，无论我们是使用米、英寸还是其他单位来衡量，结果都是一样的。
- en: 'When we talk about the $125 effect size of our A/B test, let’s try to think
    of it in terms of standard deviations as well. Compared to the standard deviation
    of the GDP measurements we’ve seen, $125 is small potatoes:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论A/B测试中的$125效应大小时，我们也可以尝试从标准差的角度来理解它。与我们所见的GDP测量值的标准差相比，$125只是小菜一碟：
- en: '[PRE15]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The output is about 7.9 · 10^(–10), which shows us that the $125 effect size
    is a little more than 1 one-billionth of the standard deviation of our GDP figures.
    Compared to the world of GDP measurements, a $125 difference in GDP is like being
    a micrometer taller than your friend—not even enough to notice without extremely
    precise measurement technology.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 结果大约是7.9 · 10^（–10），这告诉我们$125效应大小大约是我们GDP数据标准差的十亿分之一。与GDP测量的世界相比，$125的GDP差异就像是比你的朋友高出一个微米——没有足够精确的测量技术根本察觉不到。
- en: 'By contrast, suppose we conduct a survey of the prices of burgers at local
    restaurants. Maybe we find the following prices:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，假设我们对当地餐馆的汉堡价格进行了一项调查。也许我们找到了以下价格：
- en: '[PRE16]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We can check this standard deviation as well:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以检查这个标准差：
- en: '[PRE17]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The standard deviation of our burger price data is about 1.65\. So, two countries’
    GDPs differing by about $80 billion is roughly comparable to two burger prices
    differing by about 80 cents: both represent about half of a standard deviation
    in their respective domains. When we compare a $125 effect size to this, we see
    that it’s huge:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的汉堡价格数据的标准差大约是1.65。所以，两个国家的GDP相差约800亿美元，和两个汉堡价格相差大约80美分大致是相当的：它们分别代表了各自领域中大约一半的标准差。当我们将$125效应大小与此比较时，我们可以看出它是巨大的：
- en: '[PRE18]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: We see that $125 is about 75.9 burger price standard deviations. Seeing a $125
    difference in burger prices in your town is therefore something like seeing a
    man who is over 20 feet tall—unheard of.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到$125大约是75.9个汉堡价格的标准差。所以，如果你所在的城市出现了$125的汉堡价格差异，那就像看到一个超过20英尺高的男人——闻所未闻。
- en: 'By measuring our effect size in terms of the standard deviation of different
    datasets, we can easily make comparisons, not just between different domains with
    the same units (GDP in dollars versus burger prices in dollars) but also between
    different domains that use totally different units (burger prices in dollars versus
    height in inches). The metric we’ve calculated several times here—an effect size
    divided by a relevant standard deviation—is called *Cohen’s d*, a common metric
    for measuring effect sizes. Cohen’s *d* is just the number of standard deviations
    that two populations’ means are apart from each other. We can calculate Cohen’s
    *d* for our first A/B test as follows:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将我们的效应大小以不同数据集的标准差为单位进行衡量，我们可以轻松地进行比较，不仅可以比较使用相同单位的不同领域（以美元计的GDP与以美元计的汉堡价格），还可以比较使用完全不同单位的不同领域（以美元计的汉堡价格与以英寸计的身高）。我们在这里计算过几次的度量——效应大小除以相关标准差——叫做*Cohen's
    d*，它是衡量效应大小的常用度量。Cohen的*d*就是两个群体的平均值之间的标准差差距。我们可以通过以下方式计算我们的第一次A/B测试的Cohen的*d*：
- en: '[PRE19]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We see that the result is about 0.76\. A common convention when we’re working
    with Cohen’s *d* is to say that if Cohen’s *d* is about 0.2 or lower, we have
    a small effect; if Cohen’s *d* is about 0.5, we have a medium effect; and if Cohen’s
    *d* is around 0.8 or even higher, we have a large effect. Since our result is
    about 0.76—quite close to 0.8—we can say that we’re working with a large effect
    size.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到结果大约是0.76。当我们使用Cohen的*d*时，通常的约定是，如果Cohen的*d*大约为0.2或更低，我们认为效果较小；如果Cohen的*d*大约为0.5，我们认为效果中等；如果Cohen的*d*大约为0.8甚至更高，我们认为效果较大。由于我们的结果大约是0.76——非常接近0.8——我们可以说我们正在处理一个大的效果大小。
- en: Calculating the Significance of Data
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 计算数据的显著性
- en: 'We typically use statistical significance as the key piece of evidence that
    convinces us that an effect that we study in an A/B test is real. Mathematically,
    statistical significance depends on three things:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通常使用统计显著性作为关键证据，以证明我们在A/B测试中研究的效果是真实的。从数学上讲，统计显著性取决于三个因素：
- en: The size of the effect being studied (like the increase in revenue that results
    from changing an email’s text color). Bigger effects make statistical significance
    more likely.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被研究的效果大小（比如改变电子邮件文本颜色所带来的收入增加）。更大的效果使统计显著性更有可能出现。
- en: The size of the sample being studied (the number of people on a subscriber list
    who are receiving our marketing emails). Bigger samples make statistical significance
    more likely.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被研究的样本大小（比如接收我们营销邮件的订阅者列表中的人数）。更大的样本使统计显著性更有可能出现。
- en: The significance threshold we’re using (typically 0.05). A higher threshold
    makes statistical significance more likely.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们使用的显著性阈值（通常为0.05）。更高的阈值使统计显著性更有可能出现。
- en: 'If we have a big sample size, and we’re studying a big effect, our t-tests
    will likely reach statistical significance. On the other hand, if we study an
    effect that’s very small, with a sample that’s very small, we may have predestined
    our own failure: the probability that we detect a statistically significant result
    is essentially 0—even if the email truly does have an effect. Since running an
    A/B test costs time and money, we’d rather not waste resources running tests like
    this that are predestined to fail to reach statistical significance.'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们有一个较大的样本量，并且研究的是一个较大的效果，我们的t检验很可能会达到统计显著性。另一方面，如果我们研究的是一个非常小的效果，且样本非常小，我们可能已经注定了自己的失败：我们检测到统计显著性结果的概率基本为0——即使电子邮件确实有影响。由于运行A/B测试需要时间和金钱，我们宁愿不浪费资源进行这种注定无法达到统计显著性的测试。
- en: The probability that a correctly run A/B test will reject a false null hypothesis
    is called the A/B test’s *statistical power*. If changing the color of text leads
    to a $125 increase in revenue per user, we can say that $125 is the effect size,
    and since the effect size is nonzero, we know the null hypothesis (that changing
    the text color has no effect on revenue) is false. But if we study this true effect
    by using a sample of only three or four email subscribers, it’s very possible
    that, by chance, none of these subscribers purchase anything, so we fail to detect
    the true $125 effect. By contrast, if we study the effect of changing the text
    color by using an email list of a million subscribers, we’re much more likely
    to detect the $125 effect and measure it as statistically significant. With the
    million-subscriber list, we have greater statistical power.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 正确运行的A/B测试拒绝虚无假设的概率被称为A/B测试的*统计功效*。如果改变文本颜色导致每位用户的收入增加125美元，我们可以说125美元是效果大小，且由于效果大小非零，我们知道虚无假设（改变文本颜色对收入没有影响）是错误的。但如果我们仅用三四个电子邮件订阅者的样本来研究这个真实效果，很有可能因为偶然原因，这些订阅者中没有人购买任何东西，因此我们未能发现真实的125美元效果。相比之下，如果我们使用一个有百万订阅者的电子邮件列表来研究文本颜色的变化效果，我们更有可能发现125美元的效果并将其测量为统计显著。对于百万订阅者列表，我们具有更大的统计功效。
- en: 'We can import a module into Python that makes calculating statistical power
    easy:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以导入一个Python模块，使得计算统计功效变得简单：
- en: '[PRE20]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'To calculate power with this module, we’ll need to define parameters for the
    three things that determine statistical significance (see the preceding bulleted
    list). We’ll define `alpha`, which is our chosen statistical significance threshold,
    as discussed in Chapter 3:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使用这个模块计算统计功效，我们需要定义影响统计显著性的三个因素的参数（参见前面的要点列表）。我们将定义`alpha`，即我们选择的统计显著性阈值，正如第3章所讨论的那样：
- en: '[PRE21]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'We choose the standard 0.05 threshold for `alpha`, as is standard in much empirical
    research. We also need to define our sample size. Suppose we’re running an A/B
    test on a group of email subscribers that consists of 90 people total. That means
    we’ll have 45 people in Group A and 45 people in Group B, so we define the number
    of observations in each of our groups as 45\. We’ll store this number in a variable
    called `nobs`, short for *number of observations*:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们选择了标准的0.05阈值作为`alpha`，这是许多实证研究中常见的做法。我们还需要定义我们的样本大小。假设我们正在对一组由90名电子邮件订阅者组成的群体进行A/B测试。这意味着A组和B组各有45人，因此我们将每组的观测数量定义为45。我们会将这个数字存储在一个名为`nobs`的变量中，`nobs`是*观测数量*的缩写：
- en: '[PRE22]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'We also have to define an estimated effect size. In our previous A/B test,
    we observed an effect size of $125\. However, for the statistical power calculations
    this module performs, we can’t express the effect size in dollar units or units
    of any other currency. We’ll use Cohen’s *d* instead, and we’ll specify a medium
    size:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要定义一个估计的效应大小。在我们之前的A/B测试中，我们观察到的效应大小为$125。然而，对于该模块执行的统计功效计算，我们不能以美元或任何其他货币单位来表达效应大小。我们将改用Cohen的*d*，并指定一个中等大小：
- en: '[PRE23]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Finally, we can use a function that will take the three parameters we’ve defined
    and calculate the statistical power we should expect:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以使用一个函数，它将接受我们定义的三个参数，并计算我们应该预期的统计功效：
- en: '[PRE24]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: If you run `print(power)`, you can see that the estimated statistical power
    for our hypothetical A/B test is about 0.65\. This means that we expect about
    a 65 percent chance of detecting an effect from our A/B test and about a 35 percent
    chance that even though a true effect exists, our A/B test doesn’t find it. These
    odds might seem unfavorable if a given A/B test is expected to be expensive; you’ll
    have to make your own decisions about the minimum level of power that is acceptable
    to you. Power calculations can help at the planning stage to understand what to
    expect and be prepared. One common convention is to authorize only A/B tests that
    are expected to have at least 80 percent power.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行`print(power)`，你可以看到我们假设的A/B测试的统计功效大约是0.65。这意味着我们预计在A/B测试中检测到效应的概率为65%，而即使真实效应存在，我们的A/B测试没有发现它的概率为35%。如果某个A/B测试预期费用较高，这样的赔率可能看起来不太理想；你需要根据自己对功效的最低接受标准做出决策。功效计算可以帮助你在规划阶段理解预期结果，并做好准备。一种常见的约定是，只批准预计功效至少为80%的A/B测试。
- en: 'You can also use the same `solve_power()` method we used in the previous snippet
    to “reverse” the power calculation: you’d start by assuming a certain power level
    and then calculate the parameters required to achieve that level of statistical
    power. For example, in the following snippet, we define `power`, `alpha`, and
    our effect size, and run the `solve_power()` command not to calculate the power
    but to calculate `observations`, the number of observations we’ll need in each
    group to achieve the power level we specified:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以使用我们在前一个代码片段中使用的相同`solve_power()`方法来“反向”计算统计功效：你可以从假定一个特定的功效水平开始，然后计算为了达到该统计功效水平所需的参数。例如，在以下代码片段中，我们定义了`power`、`alpha`和我们的效应大小，并运行`solve_power()`命令，这次不是计算功效，而是计算`observations`，即为了实现我们指定的功效水平，
    每组所需的观测数量：
- en: '[PRE25]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: If you run `print(observations)`, you’ll see that the result is about 63.8\.
    This means that if we want to have 80 percent statistical power for our planned
    A/B test, we’ll need to recruit at least 64 participants for both groups. Being
    able to perform these kinds of calculations can be helpful in the planning stages
    of A/B tests.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行`print(observations)`，你会看到结果大约是63.8。这意味着，如果我们希望在计划的A/B测试中达到80%的统计功效，我们需要为两个组招募至少64个参与者。能够进行这些计算在A/B测试的规划阶段是非常有帮助的。
- en: Applications and Advanced Considerations
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用与高级考虑
- en: So far, we’ve considered only A/B tests related to marketing emails. But A/B
    tests are applicable to a wide variety of business challenges beyond optimal email
    design. One of the most common applications of A/B testing is user interface/experience
    design. A website might randomly assign visitors to two groups (called Group A
    and Group B, as usual) and show different versions of the site to each group.
    The site can then measure which version leads to more user satisfaction, higher
    revenue, more link clicks, more time spent on the site, or whatever else interests
    the company. The whole process can be completely automated, which is what enables
    the high-speed, high-volume A/B testing that today’s top tech companies are doing.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们只考虑了与营销电子邮件相关的A/B测试。但A/B测试适用于除了最佳电子邮件设计之外的各种商业挑战。A/B测试最常见的应用之一是用户界面/体验设计。一个网站可能会随机将访问者分配到两个组（通常称为A组和B组），并向每组展示不同版本的网站。然后，该网站可以衡量哪个版本能带来更高的用户满意度、更高的收入、更多的链接点击、更多的停留时间，或者其他公司感兴趣的指标。整个过程可以完全自动化，这也使得今天顶尖科技公司能够进行高速、大规模的A/B测试。
- en: E-commerce companies run tests, including A/B tests, on product pricing. By
    running an A/B test on pricing, you can measure what economists call the *price
    elasticity of demand*, meaning how much demand changes in response to price changes.
    If your A/B test finds only a very small change in demand when you increase the
    price, you should increase the price for everyone and take advantage of their
    greater willingness to pay. If your A/B test finds that demand drops off significantly
    when you increase the price slightly, you can conclude that customers are sensitive
    to price, and their purchase decisions depend heavily on price considerations.
    If customers are sensitive to price and constantly thinking about it, they’ll
    likely respond positively to a price decrease. If so, you should decrease the
    price for everyone instead, and expect a large increase in demand. Some businesses
    have to set prices based on intuition or other painstaking calculations, but A/B
    testing makes determining the right price relatively simple.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 电子商务公司进行测试，包括A/B测试，以确定产品定价。通过进行定价A/B测试，你可以衡量经济学家所说的*需求价格弹性*，即需求随价格变化的变化程度。如果你的A/B测试发现，当你提高价格时，需求变化非常小，那么你应该对所有人提高价格，利用他们更高的支付意愿。如果A/B测试发现，当你稍微提高价格时需求显著下降，那么你可以得出结论，客户对价格敏感，他们的购买决策很大程度上依赖于价格因素。如果客户对价格敏感并时刻考虑价格，他们很可能会对降价作出积极反应。如果是这样，你应该对所有人降价，并预计需求会大幅增加。一些企业必须依靠直觉或其他繁琐的计算来确定价格，但A/B测试使得确定正确价格变得相对简单。
- en: Email design, user-interface design, and product pricing are all common concerns
    for *business-to-consumer (B2C)* business models, in which businesses sell directly
    to consumers. B2C scenarios are a natural fit for A/B testing because the number
    of customers, products, and transactions tends to be higher for B2C businesses
    than for other businesses, so we can get large sample sizes and higher statistical
    power.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件设计、用户界面设计和产品定价是*商业对消费者（B2C）*商业模型中的常见问题，在这种模型中，企业直接向消费者销售产品。B2C场景非常适合进行A/B测试，因为B2C企业的客户、产品和交易数量通常比其他企业更高，因此我们可以获得更大的样本量和更强的统计能力。
- en: This doesn’t mean that business-to-business (B2B) companies can’t do A/B testing.
    Indeed, A/B testing has been practiced for centuries around the world and in many
    domains, though it used to be called just *science*. For example, medical researchers
    do *randomized controlled trials* for new drugs, with an approach that’s often
    essentially the same as A/B testing in a champion/challenger framework. Businesses
    of all kinds have always needed to learn about the market and their customers,
    and A/B testing is a natural, rigorous way to learn nearly anything.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不意味着商业对商业（B2B）公司不能进行A/B测试。事实上，A/B测试在全球范围内以及许多领域已经被实践了几个世纪，尽管它过去仅被称为*科学*。例如，医学研究人员进行*随机对照试验*来测试新药，这种方法在本质上与A/B测试中的冠军/挑战者框架几乎相同。各类企业一直需要了解市场和客户，A/B测试是一种自然、严谨的方式，几乎可以用来了解任何事情。
- en: As you apply A/B testing in your business, you should try to learn as much as
    you can about it, beyond the content in the limited space of this chapter. One
    huge field you might want to wade into is Bayesian statistics. Some data scientists
    prefer to use Bayesian methods instead of significance tests and *p*-values to
    test for the success of A/B tests.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在业务中应用A/B测试时，你应该尽可能多地了解它，超越本章有限空间中的内容。一个你可能想深入研究的巨大领域是贝叶斯统计。一些数据科学家更倾向于使用贝叶斯方法，而不是显著性检验和*p*-值来测试A/B测试的成功。
- en: 'Another interesting, useful topic to learn more about is the *exploration/exploitation
    trade-off* in A/B tests. In this trade-off, two goals are in constant tension:
    to explore (for example, to run A/B tests with possibly bad email designs to learn
    which is best) and to exploit (for example, to send out only the champion email
    because it seems to perform the best). Exploration can lead to missed opportunities
    if one of your challengers performs much worse than the champion; you would have
    been better off just sending out the champion to everyone. Exploitation can lead
    to missed opportunities if your champion is not as good as another challenger
    that you haven’t tested yet because you’re too busy exploiting your champion to
    do the requisite exploration.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有趣且有用的主题是A/B测试中的*探索/开发权衡*。在这种权衡中，两个目标处于不断的张力之中：探索（例如，运行可能设计不佳的A/B测试以了解哪个最好）和开发（例如，仅发送表现最好的冠军电子邮件）。如果你的某个挑战者比冠军表现差很多，探索可能导致错失机会；你本可以直接向所有人发送冠军邮件。开发也可能导致错失机会，如果你的冠军不如另一个你还未测试的挑战者，因为你太专注于开发你的冠军而未进行必要的探索。
- en: In operations research, you’ll find a huge body of research on the *multi-armed
    bandit problem*, which is a mathematical formalization of the exploration/exploitation
    dilemma. If you’re really interested in doing A/B testing optimally, you can peer
    into some of the strategies that researchers have come up with to solve the multi-armed
    bandit problem and run A/B tests as efficiently as possible.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在运筹学研究中，你会发现大量关于*多臂老虎机问题*的研究，这是探索/开发困境的数学形式化。如果你真的有兴趣优化A/B测试，你可以了解一些研究人员提出的解决多臂老虎机问题的策略，以尽可能高效地进行A/B测试。
- en: The Ethics of A/B Testing
  id: totrans-154
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: A/B测试的伦理
- en: 'A/B testing is fraught with difficult ethical issues. This may seem surprising,
    but remember, A/B testing is an experimental method in which we intentionally
    alter human subjects’ experiences in order to study the results for our own gain.
    This means that A/B testing is human experimentation. Think about other examples
    of human experimentation to see why people have ethical concerns about it:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: A/B测试充满了困难的伦理问题。这可能让人感到惊讶，但请记住，A/B测试是一种实验方法，我们故意改变人类受试者的体验，以便研究结果并为自己的利益服务。这意味着A/B测试是人类实验。想想其他人类实验的例子，看看为什么人们对它有伦理担忧：
- en: Jonas Salk developed an untested, unprecedented polio vaccine, tried it on himself
    and his family, and then tried it on millions of American children to ensure that
    it worked. (It worked and helped eliminate a terrible disease from much of the
    world.)
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 乔纳斯·索尔克开发了一种未经测试、前所未有的脊髓灰质炎疫苗，首先试验自己和家人，然后在数百万美国儿童中进行试验，以确保其有效。（它确实有效，并帮助消除了世界大部分地区的一种可怕的疾病。）
- en: My grandmother made a pie for her grandchildren, observed how we reacted to
    it, and then the next day made a different pie and checked whether we reacted
    more or less positively. (Both were delicious.)
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我的祖母为她的孙子孙女做了一只派，观察我们对它的反应，然后第二天做了一只不同的派，检查我们是更积极还是更消极地反应。（两者都很美味。）
- en: A professor posed as a student and emailed 6,300 professors to ask them to schedule
    time to talk to her, lying about herself and her intentions in an attempt to determine
    whether her false persona would be a target of discrimination so she could publish
    a paper about the replies. She didn’t compensate any of the unwitting study participants
    for the deception or the schedule disruption, nor did she receive their consent
    beforehand to be an experimental subject. (Every detail of this study was approved
    by a university ethics board.)
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一位教授伪装成学生，给6300位教授发送电子邮件，请他们安排时间与她交谈，谎称自己和意图，试图确定她的虚假身份是否会成为歧视的目标，以便她能够发表关于回复的论文。她没有为任何无意识参与研究的受试者提供补偿，既没有因欺骗或时间表干扰提供补偿，也没有事先获得他们同意作为实验对象。（这项研究的每一个细节都得到了大学伦理委员会的批准。）
- en: A corporation intentionally manipulated the emotions of its users to better
    understand and sell products to them.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Josef Mengele performed painful and deadly sadistic experiments on unwilling
    human subjects in the Auschwitz concentration camp.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You perform an A/B test.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The first five entries on this list of human experiments actually happened,
    and all but the second inspired public discussions about ethics among social scientists.
    You’ll have to decide whether the sixth will happen and what position you will
    take concerning the ethical issues involved. Because of the broad range of activities
    that could be called human experimentation, making a single ethical judgment about
    all of its forms isn’t possible. We have to consider several important ethical
    concepts when we’re deciding whether our A/B tests make us a hero like my grandmother
    or Salk, a villain like Mengele, or something in between.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: The first concept we should consider is consent. Salk tested his vaccine on
    himself before large-scale tests of others. Mengele, by contrast, performed experiments
    on unwilling subjects confined in concentration camps. Informed consent always
    makes human experimentation more ethical. In some cases, obtaining informed consent
    is not feasible. For example, if we perform experiments about which outdoor billboard
    designs are most effective, we can’t obtain informed consent from every possible
    human research subject, since any person in the world could conceivably see a
    public billboard, and we don’t have a way to contact every living human.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: Other cases form a large gray area. For example, a website that performs A/B
    tests may have a Terms and Conditions section, with small print and legalese that
    claims that every website visitor provides consent to be experimented on (via
    A/B tests of user-interface features) whenever they navigate to the site. This
    may technically meet the definition of informed consent, but only a tiny percentage
    of any website’s visitors likely visit and understand these conditions. In gray-area
    cases, it helps to consider other ethical concepts.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: 'Another important ethical consideration related to A/B testing is risk. Risk
    itself involves two considerations: potential downsides to participation as a
    human subject and the probability of experiencing those downsides. Salk’s vaccine
    had a large potential downside—contracting polio—but because of Salk’s preparation
    and knowledge, the probability of subjects experiencing it was remarkably low.
    A/B testing for marketing campaigns usually has potential downsides that are minuscule
    or smaller, as it’s hard to even imagine any downside that could occur because
    (for example) someone was exposed to blue rather than black text in one marketing
    email. Experiments with low risks to subjects are more ethical than risky experiments.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: We should also consider the potential benefits that could result from our experimentation.
    Salk’s vaccine experiments had the potential (later realized) of eradicating polio
    from most of the Earth. A/B tests are designed to improve profits, not cure diseases,
    so your judgment of their benefits will have to depend on your opinion of the
    moral status of corporate profits. The only other benefit likely to come from
    a corporation’s marketing experiment would be an advance in understanding of human
    psychology. Indeed, corporate marketing practitioners occasionally publish the
    results of marketing experiments in psychology journals, so this isn’t unheard
    of.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还应考虑从我们的实验中可能带来的潜在好处。萨尔克的疫苗实验具有（后来实现的）消除大多数地区脊髓灰质炎的潜力。A/B 测试旨在提高利润，而不是治愈疾病，因此你对其好处的判断将取决于你对公司利润的道德地位的看法。公司营销实验可能带来的唯一其他好处是对人类心理学的理解进展。实际上，企业营销从业者偶尔会将营销实验的结果发表在心理学期刊上，所以这并不鲜见。
- en: Ethical and philosophical questions can never reach a definitive, final conclusion
    that everyone agrees on. You can make up your own mind about whether you feel
    that A/B testing is fundamentally good, like Salk’s vaccine experiments, or fundamentally
    abhorrent, like Mengele’s horrors. Most people agree that the extremely low risks
    of most online A/B testing, and the fact that people rarely refuse consent to
    benign A/B tests, mean that A/B testing is an ethically justifiable activity when
    performed properly. Regardless, you should think carefully through your own situation
    and come to your own conclusion.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 伦理和哲学问题永远无法得出所有人都认同的最终结论。你可以自己决定是否认为 A/B 测试本质上是好的，就像萨尔克的疫苗实验一样，或本质上令人反感，就像门吉莱的恐怖实验一样。大多数人都同意，大多数在线
    A/B 测试的风险极低，而且人们很少拒绝同意无害的 A/B 测试，这意味着当 A/B 测试得当时，它是道德上可以辩护的活动。不管怎样，你应该仔细考虑自己的情况，并得出自己的结论。
- en: Summary
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we discussed A/B testing. We started with a simple t-test,
    and then looked at the need for random, non-confounded data collection as part
    of the A/B testing process. We covered some nuances of A/B testing, including
    the champion/challenger framework and Twyman’s law, as well as ethical concerns.
    In the next chapter, we’ll discuss binary classification, an essential skill for
    any data scientist.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 本章讨论了 A/B 测试。我们从一个简单的 t 检验开始，然后探讨了在 A/B 测试过程中随机、非混杂数据收集的必要性。我们介绍了 A/B 测试的一些细微差别，包括冠军/挑战者框架和特威曼定律，以及伦理问题。在下一章，我们将讨论二元分类，这是任何数据科学家必备的技能。
