<html><head></head><body>
		<section>
			<header>
				<h1 class="chapter"><span class="ChapterNumber"><span epub:type="pagebreak" id="Page_159" title="159"/>8</span><br/><span class="ChapterTitle">Dictionaries and JSON</span></h1>
			</header>
			<figure class="opener">
				<img alt="" src="image_fi/book_art/chapterart.png"/>
			</figure>
			<p class="ChapterIntro">Dictionaries hold collections of items, similar to the ordered lists you learned about in <span class="xref">Chapter 7</span>. Dictionaries, however, are unordered, and you use an associated value to access each item, which makes it easier to remember what the items in your dictionary represent. In this chapter, you’ll learn about Python’s dictionary syntax and methods, how to combine loops and dictionaries, and how to nest dictionaries and lists.</p>
			<p>
				You’ll also learn how to work with another plaintext file format: <em>JavaScript Object Notation (JSON)</em>. The syntax isn’t quite as simple as CSV, but it’s better suited for handling more complex data structures. You’ll use Python’s built-in <em>json</em> module to read in dictionary data from a JSON file, and as in <span class="xref">Chapter 7</span>, you’ll then create a data visualization.</p>
			<h2 id="h1-500969c08-0001"><span epub:type="pagebreak" id="Page_160" title="160"/>Introducing Dictionaries</h2>
			<p class="BodyFirst">In a dictionary, each unordered item is associated with a value called a <em>key</em>. A key is usually a short string, and each dictionary item is composed of a key-value pair. This means dictionaries are associative, and some programming languages refer to dictionary-type structures as <em>associative arrays</em>. Dictionaries are different from lists, which are numerically indexed, because each element in a list corresponds to a number (index) indicating its position in a sequence of items.</p>
			<p>
				As an example of how key-value pairs work, you might use a dictionary to note the favorite movie of each of your friends. In such a dictionary, each key would be a friend’s name, and each value would be a corresponding film title. To insert or retrieve your friend Lee’s favorite movie, you’d use the key <code>'Lee'</code>. <a href="#figure8-1" id="figureanchor8-1">Figure 8-1</a> is a conceptual diagram of this dictionary.</p>
			<figure>
				<img alt="f08001" src="image_fi/500969c08/f08001.png"/>
				<figcaption>
					<p><a id="figure8-1">Figure 8-1</a>: A diagram of a dictionary indicating the mapping between keys and values</p>
				</figcaption>
			</figure>
			<p>
				For your first exercise in working with Python dictionaries, you’ll write code to manage student records. Create a new sketch named <em>dictionaries</em>, and<em> </em>add the following code that shows the difference between a list and dictionary:</p>
			<pre><code><span aria-label="annotation1" class="CodeAnnotationHang">1</span> student = [<span class="ProcessingPurple">'Sam'</span>, 24]<span aria-label="annotation2" class="CodeAnnotationHang">2</span> student = {<span class="ProcessingPurple">'name'</span>: <span class="ProcessingPurple">'Sam'</span>, <span class="ProcessingPurple">'age'</span>: 24}</code></pre>
			<p>
				First, note that dictionaries use curly brackets (<code>{}</code>), whereas lists use square brackets (<code>[]</code>). The list <span aria-label="annotation1" class="CodeAnnotation">1</span> and dictionary <span aria-label="annotation2" class="CodeAnnotation">2</span> variants store the same values: <code>'Sam'</code> and <code>24</code>. However, each dictionary item includes a value <em>and</em> a key. In this instance, the dictionary keys are <code>'name'</code> and <code>'age'</code>. Keep in mind that sensibly named keys help identify what the values represent. This <code>student</code> dictionary holds two key-value pairs (<a href="#figure8-2" id="figureanchor8-2">Figure 8-2</a>).</p>
			<p>
				You’ll use the meaningfully named keys to retrieve values from the <code>student</code> dictionary. To use the <code>student</code> list, you would need to recall the seemingly arbitrary positions for each value. Lists are better at handling an ordered sequence of items, but if you have a set of unique keys that map to values, use a dictionary.</p>
				<span epub:type="pagebreak" id="Page_161" title="161"/>
				<figure>
				<img alt="f08002" src="image_fi/500969c08/f08002.png"/>
				<figcaption>
					<p><a id="figure8-2">Figure 8-2</a>: A dictionary with two key-value pairs</p>
				</figcaption>
			</figure>
			<p>Dictionaries can hold all types of data, including strings, numbers, Booleans, lists, and even other dictionaries. You can store as many key-value pairs as you like in a dictionary. Technically speaking, there is an upper limit, but if you’re managing such large volumes of data, you should probably look at a database solution.</p>
			<h3 id="h2-500969c08-0001">Accessing Dictionaries</h3>
			<p class="BodyFirst">To access any dictionary value, use the dictionary name along with the associated key in square brackets. Try the following code:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingBlue">print</span>(student[<span class="ProcessingPurple">'age'</span>]) <span class="ProcessingGray"># displays: 24</span><span class="ProcessingBlue">print</span>(student[<span class="ProcessingPurple">'name'</span>]) <span class="ProcessingGray"># displays: Sam</span></code></pre>
			<p>
				The comments alongside each <code>print()</code> function confirm what should appear in your console.</p>
			<p>To print the entire dictionary, omit the square brackets and key, leaving only the dictionary name:</p>
			<pre><code><span class="ProcessingBlue">print</span>(student) <span class="ProcessingGray"># {'name': 'Sam', 'age': 24}</span></code></pre>
			<p>The console should display every key-value pair, complete with the curly brackets, colons, and commas.</p>
			<p>
				The order of the key-value pairs won’t always match the order in which you defined them, and this can vary among Python environments. Dictionaries are inherently orderless; Python is concerned with the connections between the keys and values. If you need to order your dictionary items—by key or value—you can use various functions and methods. You’ll see some sorting techniques in <span class="xref">“Combining Loops and Dictionaries” on page 163</span>.</p>
			<p>
				If you try to reference a nonexistent key—say, <code>student['grade']</code>—Processing displays a <code>KeyError</code> message. If you need to check whether a key exists, use the <code>in</code> operator:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingOlive">if</span> <span class="ProcessingPurple">'age'</span> <span class="ProcessingTealGreen">in</span> student: <span class="ProcessingBlue">print</span>(student[<span class="ProcessingPurple">'age'</span>])</code></pre>
			<p><span epub:type="pagebreak" id="Page_162" title="162"/>The <code>in</code> checks whether the <code>'age'</code> key exists in the <code>student</code> dictionary. If found, the operation returns <code>True</code>, and the <code>if</code> statement executes the <code>print</code> line displaying the <code>age</code> value (which is <code>24</code> in this case).</p>
			<h3 id="h2-500969c08-0002">Modifying Dictionaries</h3>
			<p class="BodyFirst">Dictionaries are dynamic structures, so you can add and modify key-value pairs as you please. To change an existing value, reassign it as you would a list element, but use the key as opposed to a numeric index. To illustrate, in your <em>dictionaries</em> sketch, change the student’s age to <code class="bold">25</code>:</p>
			<pre><code><span class="LiteralGray">. . .</span>
student[<span class="ProcessingPurple">'age'</span>] = 25<span class="ProcessingBlue">print</span>(student) <span class="ProcessingGray"># {'name': 'Sam', 'age': 25}</span></code></pre>
			<p>
				The console output should confirm that the age has changed from <code>24</code> to <code>25</code>.</p>
			<p>
				To add a new key-value pair, follow the same process. Add a student ID number to the <code>student</code> dictionary:</p>
			<pre><code><span class="LiteralGray">. . .</span>
student[<span class="ProcessingPurple">'id'</span>] = 19950501<span aria-label="annotation1" class="CodeAnnotation">1</span><span class="ProcessingBlue">print</span>(student)<span class="ProcessingGray"># {'name': 'Sam', 'id': 19950501, 'age': 25}</span></code></pre>
			<p>
				The <code>id</code> value here represents a birth date (1995-05-01) <span aria-label="annotation1" class="CodeAnnotation">1</span>. The system can use this information to calculate the student’s age, so now it’s no longer necessary to store the individual’s <code>age</code> value. To remove this, use the <code>del</code> statement:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingTealGreen">del</span> student[<span class="ProcessingPurple">'age'</span>]<span class="ProcessingBlue">print</span>(student) <span class="ProcessingGray"># {'name': 'Sam', 'id': 19950501}</span></code></pre>
			<p>
				The <code>del</code> statement permanently removes the <code>age</code> key and its corresponding value.</p>
			<h2 id="h1-500969c08-0002">Nesting Dictionaries and Lists</h2>
			<p class="BodyFirst">Dictionaries can hold other dictionaries or lists, and lists also can hold dictionaries. Let’s look at two examples: a dictionary of lists, and a list of dictionaries. Both are valid ways to structure data, but as you’ll see, you’ll choose one depending on which works best in your particular application.</p>
			<p>
				At this point, your program stores the details of a single student. A system that can manage just one student isn’t very useful, so to handle multiple students, try a <em>dictionary of lists</em>. Add the following code to the bottom of your <em>dictionaries</em> sketch:</p>
			<pre><code><span class="LiteralGray">. . .</span>
students = { <span aria-label="annotation1" class="CodeAnnotation">1</span> <span class="ProcessingPurple">'names'</span>: [<span class="ProcessingPurple">'Sam'</span>, <span class="ProcessingPurple">'Lee'</span>],<span epub:type="pagebreak" id="Page_163" title="163"/> <span aria-label="annotation2" class="CodeAnnotation">2</span> <span class="ProcessingPurple">'ids'</span>: [19950501, 19991114]
}<span class="ProcessingBlue">print</span>(students[<span class="ProcessingPurple">'names'</span>][1]<span aria-label="annotation3" class="CodeAnnotation">3</span>) <span class="ProcessingGray"># Lee</span></code></pre>
			<p>
				The <code>names</code> list item holds a list of two names <span aria-label="annotation1" class="CodeAnnotation">1</span>; the <code>ids</code> list holds their respective ID numbers <span aria-label="annotation2" class="CodeAnnotation">2</span>. To access any list element directly within a dictionary item, use the associated key followed by a second pair of square brackets containing the element index <span aria-label="annotation3" class="CodeAnnotation">3</span>.</p>
			<p>
				Another approach to structuring this data is with a <em>list of dictionaries</em>. Rather than separating the student names into one list and the IDs into another, you could use a dictionary for each student. Add the following code to the bottom of your sketch, effectively overwriting the former <code>students</code> dictionary entirely:</p>
			<pre><code><span class="LiteralGray">. . .</span>
students = [ {<span class="ProcessingPurple">'name'</span>: <span class="ProcessingPurple">'Sam'</span>, <span class="ProcessingPurple">'id'</span>: 19950501}, {<span class="ProcessingPurple">'name'</span>: <span class="ProcessingPurple">'Lee'</span>, <span class="ProcessingPurple">'id'</span>: 19991114}
]<span class="ProcessingBlue">print</span>(students[1][<span class="ProcessingPurple">'name'</span>]<span aria-label="annotation1" class="CodeAnnotation">1</span>) <span class="ProcessingGray"># Lee</span></code></pre>
			<p>
				This retrieves the name <code>Lee</code> by using an element index, followed by another pair of square brackets containing the dictionary key <span aria-label="annotation1" class="CodeAnnotation">1</span>.</p>
			<p>The latter of the two approaches (the list of dictionaries) is arguably the more sensible structure in this scenario. Each item is like a row in a spreadsheet that contains the details for a single student, and each student may have a different number of columns. This means you can add an extra key-value pair to Sam’s dictionary without having to do the same for Lee. Doing this, however, would be tricky using the first approach.</p>
			<p>What you name your keys and how you elect to nest lists and dictionaries should help relate your data to real-world models while reducing complexity. Keep your key names short and descriptive, and bear in mind that well-structured data will make for more self-evident algorithms further along in your program. In other words, you’ll end up saving time and energy writing code if it’s structured around intuitively organized data.</p>
			<h2 id="h1-500969c08-0003">Combining Loops and Dictionaries</h2>
			<p class="BodyFirst">You’ll often want to loop through your dictionaries. For example, you could dynamically generate reports for every student in your system by using a single loop to populate a predefined template. Considering that a dictionary can hold thousands or even millions of key-value pairs, this is a powerful technique. Because of the key-value system, though, iterating dictionaries is a little different from iterating lists.</p>
			<p>
				You can iterate a dictionary’s keys, values, or key-value pairs with Python’s <code>keys()</code>, <code>values()</code>, and <code>items()</code> methods. Note that many list methods—such as <code>append()</code>, <code>extend()</code>, <code>index()</code>, <code>insert()</code>, and <code>remove()</code>—do not work on the dictionary data type.</p>
			<p><span epub:type="pagebreak" id="Page_164" title="164"/>To begin, add a new dictionary, named <code>courses</code>, to the end of your <em>dictionaries</em> sketch:</p>
			<pre><code><span class="LiteralGray">. . .</span>
courses = {<span class="ProcessingPurple">  'game development'</span>: <span class="ProcessingPurple">'Prof. Smith'</span>, <span class="ProcessingPurple">'web design'</span>: <span class="ProcessingPurple">'Prof. Ncube'</span>, <span class="ProcessingPurple">'code art'</span>: <span class="ProcessingPurple">'Prof. Sato'</span>
}</code></pre>
			<p>
				The dictionary keys represent course titles; the associated values are the professors who coordinate each course. Next, you’ll look at ways to combine this dictionary with <code>for</code> loops.</p>
			<h3 id="h2-500969c08-0003">Iterating Keys</h3>
			<p class="BodyFirst">You can write a <code>for</code> loop that deals only with keys, which is useful if you don’t need to work with the values in your dictionary. Key iteration happens implicitly wherever you use a <code>for...in</code> line with a dictionary. Test this behavior in the following example, which should display all of the course titles in your console:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingOlive">for</span> course <span class="ProcessingTealGreen">in</span> courses: <span class="ProcessingBlue">print</span>(course)</code></pre>
			<p>
				With each iteration, Python assigns the next key in <code>courses</code> to <code>course</code>. The <code>print</code> line displays each course title on its own line in the console, and the loop is complete after all of the keys are exhausted:</p>
			<pre><code>web design
game development
code art</code></pre>
			<p>
				Recall that you cannot rely on the ordering of dictionary items. If you want to ensure that keys are retrieved in alphanumeric order, wrap a <code>sorted()</code> function around <code>courses</code>:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="LiteralGray">for course in</span> <b>sorted(</b><span class="LiteralGray">courses</span><b>)</b><span class="LiteralGray">:</span> <span class="LiteralGray">print(course)</span></code></pre>
			<p>
				The amended <code>for</code> line prints the keys in the following order:</p>
			<pre><code>code art
game development
web design</code></pre>
			<p><span epub:type="pagebreak" id="Page_165" title="165"/>If you simply need a list of keys, use the <code>keys()</code> method, and to sort them, include a <code>sorted()</code> function:</p>
			<pre><code><span class="ProcessingBlue">print</span>(<span class="ProcessingBlue">sorted</span>(courses.<span class="ProcessingBlue">keys</span>()))<span class="ProcessingGray"># displays: ['code art', 'game development', 'web design']</span></code></pre>
			<p>This prints a list of the keys in the console, complete with square brackets and commas.</p>
			<h3 id="h2-500969c08-0004">Iterating Values</h3>
			<p class="BodyFirst">The <code>values()</code> method returns all of a dictionary’s values, which is useful if you don’t need to work with the keys in your dictionary. Add a new loop to your sketch, using the <code>values()</code> method to retrieve the names of each professor:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingOlive">for</span> prof <span class="ProcessingTealGreen">in</span> courses.<span class="ProcessingBlue">values</span>(): <span class="ProcessingBlue">print</span>(prof)</code></pre>
			<p>
				With each iteration, Python assigns the next value in <code>courses</code> to <code>prof</code>. I’ve named this variable <code>prof</code> as an abbreviation for <em>professor</em> (representing the value it will hold). The <code>print</code> line displays the name of each course’s professor on a new line in the console.</p>
			<h3 id="h2-500969c08-0005">Iterating Items</h3>
			<p class="BodyFirst">Often you’ll want both the dictionary key and the corresponding value for your loop. The <code>items()</code> method returns all of the dictionary’s key-value pairs. Before writing any loop code, print the items in your <code>courses</code> dictionary by using the <code>items()</code> method:</p>
			<pre><code><span class="ProcessingBlue">print</span>(courses.<span class="ProcessingBlue">items</span>())</code></pre>
			<p>Here’s the console output (it doesn’t fit on a single line, which is indicated with the ellipsis):</p>
			<pre><code>[('web design', 'Prof. Ncube'), ('game development', ...</code></pre>
			<p>
				You should be able to identify each key-value pair, grouped within parentheses. The parentheses surrounding each key-value pair denote a <em>tuple</em>. This book does not cover tuples in detail, so for now, consider them interchangeable with lists.</p>
			<p>Add this loop to print each key-value tuple on its own line in the console:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingOlive">for</span> kv <span class="ProcessingTealGreen">in</span> courses.<span class="ProcessingBlue">items</span>(): <span class="ProcessingBlue">print</span>(kv)</code></pre>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="box">
					<h2><span epub:type="pagebreak" id="Page_166" title="166"/>Tuples</h2>
					<p class="BoxBodyFirst">You can pronounce tuple as <em>too-</em><em>ple</em> or <em>tuh-ple</em>, depending on whom you want to annoy.</p>
					<p>To access tuple items, use the same syntax as lists. Here’s an example:</p>
					<pre><code>newcourse = (<span class="ProcessingPurple">'visual effects'</span>, <span class="ProcessingPurple">'Prof. Kovalenko'</span>)<span class="ProcessingBlue">print</span>(newcourse[0]) <span class="ProcessingGray"># visual effects</span><span class="ProcessingBlue">print</span>(newcourse[1]) <span class="ProcessingGray"># Prof. Kovalenko</span></code></pre>
					<p>
						In the first line, a new tuple, defined using parentheses, is assigned to a variable named <code>newcourse</code>. Tuple elements are numerically indexed, relying on the list-style syntax to retrieve values, as you can see from the <code>print</code> lines. In a nutshell, the key difference between lists and tuples is that tuples, once defined, cannot be modified. The technical term for this quality is <em>immutable</em>. For example, the following code would result in a <code>TypeError</code> because you’re attempting to alter a tuple value:</p>
					<pre><code>newcourse[0] = <span class="ProcessingPurple">'VFX'</span></code></pre>
					<p>
						Conversely, lists and dictionaries are <em>mutable</em> data types, because you can add, remove, or edit items as you please.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<p>
				When you use an <code>items()</code> method with a <code>for</code> loop, Python is assigning a tuple to your loop variable. I’ve named this <code>kv</code> as an abbreviation for <em>key-value</em>, but you could name it whatever you like. For example, on the <em>code art</em> iteration, <code>kv </code>is equal to <code>('code art', 'Prof. Sato')</code>. Run the sketch to confirm that the console displays each key-value pair, complete with parentheses and commas.</p>
			<p>
				To make iterating dictionary items more convenient, Python allows you to include two variables between the <code>for</code> and <code>in</code>, one for the key and one for the corresponding value. You can name these variables whatever you like, but the order of assignment is always <em>key</em> first, <em>value</em> second; this matches the ordering in the tuple. Add this example to assign the course title and professor to separate variables. Additionally, this code includes a <code>sorted()</code> function:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingOlive">for</span> course<span aria-label="annotation1" class="CodeAnnotation">1</span>, prof<span aria-label="annotation2" class="CodeAnnotation">2</span> <span class="ProcessingTealGreen">in</span> <span class="ProcessingBlue">sorted</span>(courses.<span class="ProcessingBlue">items</span>()): <span class="ProcessingBlue">print</span>(<span class="ProcessingPurple">'{} coordinates the {} course.'</span>.<span class="ProcessingBlue">format</span>(prof, course))</code></pre>
			<p><span epub:type="pagebreak" id="Page_167" title="167"/>With each iteration, Python assigns the key (course title) to the first variable <span aria-label="annotation1" class="CodeAnnotation">1</span> and the value (professor name) to the second variable <span aria-label="annotation2" class="CodeAnnotation">2</span>. The console should display the following:</p>
			<pre><code>Prof. Sato coordinates the code art course.
Prof. Smith coordinates the game development course.
Prof. Ncube coordinates the web design course.</code></pre>
			<p>
				Notice that the <code>sorted()</code> function always operates on keys, so the sentences are ordered alphabetically by course title, not professor. To reverse the order, add a <code>reversed()</code> function:</p>
			<pre><code><span class="LiteralGray">. . .</span><b>#</b><span class="ProcessingGray">for course, prof in sorted(courses.items()):</span><span class="ProcessingOlive">for</span> course, prof <span class="ProcessingTealGreen">in</span> <span class="ProcessingBlue">reversed</span>(<span class="ProcessingBlue">sorted</span>(courses.<span class="ProcessingBlue">items</span>())): <span class="LiteralGray">print('{} coordinates the {} course.'.format(prof, course))</span></code></pre>
			<p>
				Now, the <code>code art</code> course will be listed as the last line in your console.</p>
			<h2 id="h1-500969c08-0004">Working with JSON</h2>
			<p class="BodyFirst">JavaScript Object Notation was derived from JavaScript, but it’s a language-independent data format. Many programming languages support JSON, Python included, and it’s popular for web development. You can use JSON to store dictionary-like data in plaintext files, with key-value pairs, to construct nested dictionary- and list-style structures.</p>
			<p>
				For this exercise, you’ll use JSON to format data in a plaintext file, just as you did with CSV in <span class="xref">Chapter 7</span>, except with a different syntax and the <em>.json</em> file extension. Python’s built-in <em>json</em> module will handle the data you read in. As mentioned previously, JSON syntax isn’t quite as simple as CSV, but it’s more descriptive and versatile.</p>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="box">
					<h2>Libraries and Modules</h2>
					<p class="BoxBodyFirst">A <em>module</em> is a set of prewritten, reusable code. You can write your own modules or import an existing module that contains the functionality you require. A <em>library</em> is a collection of modules. You’ll use a few libraries and modules in the chapters to come.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<h3 id="h2-500969c08-0006"><span epub:type="pagebreak" id="Page_168" title="168"/>Understanding JSON Syntax</h3>
			<p class="BodyFirst">To understand how JSON syntax works, let’s contrast it with CSV. In <span class="xref">Chapter 7</span>, you stored an album track list (for <em>The Dark Side of the Moon</em>) in CSV format. Here’s an abridged version of that file:</p>
			<pre><code>location,title,creator,album,trackNum
file:///music/SpeakToMe.mp3,Speak to Me,Pink Floyd,The Dark Side of the Moon,1
file:///music/Breathe.mp3,Breathe,Pink Floyd,The Dark Side of the Moon,2<span class="LiteralGray">. . .</span></code></pre>
			<p>The first line contains the field headings. Lines 2 and beyond provide the details of each track.</p>
			<p>Here’s the same (abridged) track list formatted as JSON:</p>
			<pre><code>[  { "location": "file:///music/SpeakToMe.mp3", "title": "Speak to Me", "creator": "Pink Floyd", "album": "The Dark Side of the Moon", "trackNum": 1 }, { "location": "file:///music/Breathe.mp3", "title": "Breathe", "creator": "Pink Floyd", "album": "The Dark Side of the Moon", "trackNum": 2 },<span class="LiteralGray">  . . .</span></code></pre>
			<p>Each value has a corresponding key—just like a Python dictionary! If you study the code, you’ll realize that it looks like a list of dictionaries written in Python. However, subtle differences exist between JSON and Python’s data structure syntax. For instance, with JSON, you must use double quotes for strings; in Python, you have the option of single quotes. The terminology is a little different too. In JSON, curly brackets denote an object (not a dictionary), and square brackets define an array (not a list). What you name your keys and how you nest your elements is up to you.</p>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="note">
					<h2><span class="NoteHead">NOTE</span></h2>
					<p>	Python permits an optional trailing comma after the last element in any list or dictionary. JSON, however, disallows trailing commas in objects and arrays.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<p>
				Because this is a track list for an individual album, every track has the same <code>creator</code> and <code>album</code> information, which seems redundant. To avoid repetition, you can restructure your JSON as follows:</p>
			<pre><code>{  "creator": "Pink Floyd",   "album": "The Dark Side of the Moon",<span epub:type="pagebreak" id="Page_169" title="169"/>  "tracklist": [ { "location": "file:///music/SpeakToMe.mp3", "title": "Speak to Me", "trackNum": 1 }, { "location": "file:///music/Breathe.mp3", "title": "Breathe", "trackNum": 2 }, <span class="LiteralGray">. . .</span></code></pre>
			<p>
				The new structure nests the tracks within <code>tracklist</code>. The <code>creator</code> and <code>album</code> information is placed at the top level of the structure because it applies to every track.</p>
			<p>You can write your own JSON data, generate it dynamically, or source it online.</p>
			<h3 id="h2-500969c08-0007">Using Web APIs</h3>
			<p class="BodyFirst">Vast repositories of JSON data, ranging from music metadata to cat facts, are available via web APIs. A <em>web application programming interface (API)</em> is a web-based service you can use to request or post data. For example, you might request data from the Twitter API to generate a graph measuring your tweet frequency or to program a Twitter bot that autonomously posts tweets of your code art.</p>
			<p>
				This book doesn’t cover how to use web APIs. However, if you want to explore web APIs, you should know a couple of things. Each API works slightly differently, which means you’ll need to refer to the service-specific developer documentation. Many APIs are accessible directly via a URL, which allows you to interface with them by using your web browser. For example, <em>OpenAQ</em> provides air-quality data from around the world. If you enter the following URL into your web browser, you’ll get a JSON summary of the air-quality data for every city in Norway: <a class="LinkURL" href="https://api.openaq.org/v1/cities?country=NO">https://api.openaq.org/v1/cities?country=NO</a>.</p>
			<p>
				The <em>api.openaq.org</em> part is the API domain name. The <em>/v1</em> indicates that you are using version 1, the first release of the API. The<em> /cities</em> part requests the data for every city in OpenAQ’s database, but the <em>?country=NO</em> limits the cities to those located in Norway. For a copy of the data, use the <b>Save Page As</b> option in your browser menu, or copy and paste the contents into any plaintext editor.</p>
			<p>You’re also likely to come across APIs that provide CSV and XML data.</p>
			<p>
				CSV, JSON, and XML have their own strengths and weaknesses, so weigh the relative merits of each format when considering what’s best for your projects. The beauty of CSV lies in its simplicity, but it cannot support hierarchically structured data. Unlike JSON, which allows you to nest objects within objects several levels deep, CSV limits you to a single value per field. XML is an established, widely supported, and flexible data exchange format, <span epub:type="pagebreak" id="Page_170" title="170"/>but it can be overly complex and bloated at times. JSON provides somewhat of a middle ground, and it has become increasingly popular on the web, as its syntax is more concise than XML’s.</p>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="box">
					<h2>XML</h2>
					<p class="BoxBodyFirst"><em>Ex</em><em>tensible Markup Language (XML)</em> files are plaintext files with the <em>.xml</em> extension. To give you an idea of what the syntax looks like, here’s an XML adaption of <em>The Dark Side of the Moon’s</em> track list:</p>
					<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;tracklist creator="Pink Floyd" album="The Dark Side of the Moon"&gt; &lt;track&gt; &lt;location&gt;file:///music/SpeakToMe.mp3&lt;/location&gt; &lt;title&gt;Speak to Me&lt;/title&gt; &lt;trackNum&gt;1&lt;/trackNum&gt; &lt;/track&gt; &lt;track&gt; &lt;location&gt;file:///music/Breathe.mp3&lt;/location&gt; &lt;title&gt;Breathe&lt;/title&gt; &lt;trackNum&gt;2&lt;/trackNum&gt; &lt;/track&gt; <span class="LiteralGray">. . .</span></code></pre>
					<p>
						Even if you have never written or viewed any XML before, you can likely make some sense of the playlist contents in the code. You can discern the details of each track within opening and closing pairs of track tags (<code>&lt;track&gt;...&lt;/track&gt;</code>). The opening <code>tracklist</code> tag includes two attributes that contain the <code>creator</code> and <code>album</code> information.</p>
					<p>You’re likely to encounter XML, or a similar markup language (like HyperText Markup Language, or HTML), on your programming journeys. Python provides various modules for dealing with markup languages, but I do not cover them in this book.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<h3 id="h2-500969c08-0008">Reading in JSON Data</h3>
			<p class="BodyFirst">You can read in JSON data when your sketch runs. In this example, you’ll use coffee data stored in a JSON file to generate a chart. Create a new sketch named <em>coffee_chart</em> with a <em>data</em> subfolder, and then complete the following steps:</p>
			<ol class="decimal">
				<li value="1">Open your browser and go to <a class="LinkURL" href="https://github.com/tabreturn/processing.py-book/">https://github.com/tabreturn/processing.py-book/</a>.</li>
				<li value="2">Navigate to <em>chapter-08-dictionaries_and_json</em>.</li>
				<li value="3">Download the <em>data.zip</em> file.</li>
				<li value="4">Extract the ZIP archive, and move <em>coffees.json</em> to the sketch <em>data</em> subfolder.</li>
			</ol>
			<p><span epub:type="pagebreak" id="Page_171" title="171"/>Here is a snippet of the <em>coffees.json</em> file contents:</p>
			<pre><code>[ {  "name": "Espresso",  "ingredients": [ {"ingredient":"espresso"<span aria-label="annotation1" class="CodeAnnotation">1</span>, "quantity":30 <span aria-label="annotation2" class="CodeAnnotation">2</span>, "color":"#221100"<span aria-label="annotation3" class="CodeAnnotation">3</span>} ] }, <span class="LiteralGray">. . .</span> {  "name": "Irish Coffee", "ingredients": [ {"ingredient":"espresso", "quantity":60, "color":"#221100"},  {"ingredient":"whiskey", "quantity":40, "color":"#FFCC77"},  {"ingredient":"whippedcream", "quantity":20, "color":"#FFFFFF"} ] },
]</code></pre>
			<p>
				Each top-level object holds the details for a different type of coffee. This code shows two types of coffee: <code>Espresso</code> and <code>Irish Coffee</code>. These are the first and last recipes; there are nine types of coffee in all. Each <code>ingredient</code> object has three key-value pairs: an ingredient name <span aria-label="annotation1" class="CodeAnnotation">1</span>, quantity in milliliters <span aria-label="annotation2" class="CodeAnnotation">2</span>, and fill color <span aria-label="annotation3" class="CodeAnnotation">3</span>. Note that these quantities are not necessarily accurate, so the final chart might not impress baristas and coffee aficionados, but it will look pretty cool.</p>
			<p>
				The next step is to load the data from the <em>coffees.json</em> file. Python’s <code>open()</code> function can open any file, plaintext or otherwise, and return a file object. For a JSON file, load the file object into a Python data structure by using the built-in <em>json</em> module. Add this code to your sketch:</p>
			<pre><code><span class="ProcessingTealGreen">import</span> json
jsondata = <span class="ProcessingBlue">open</span>(<span class="ProcessingPurple">'coffees.json'</span>)
coffees = json.load(jsondata)</code></pre>
			<p>
				The <code>import</code> line imports the <em>json</em> module. The <code>open()</code> function opens the JSON file and assigns the file object to the variable <code>jsondata</code>. The <code>json.load()</code> function converts the JSON to Python data. To confirm it’s working, print the quantity of whiskey in the Irish Coffee:</p>
			<pre><code><span class="ProcessingBlue">print</span>(coffees[8][<span class="ProcessingPurple">'ingredients'</span>][1][<span class="ProcessingPurple">'quantity'</span>]) <span class="ProcessingGray"># 40</span></code></pre>
			<p>
				The Irish Coffee is the last element in a list of nine coffees; hence, it has an index of <code>8</code>. The whiskey content is the second ingredient (<code>['ingredients'][1]</code>). The final <code>['quantity']</code> represents the quantity value of the ingredient, 40 milliliters.</p>
			<p>
				When you retrieved CSV data by using <code>loadStrings()</code>, everything was data-typed as a string, numbers included. You had to convert values to integers by using the <code>int()</code> function before performing any arithmetic; to create lists, you had to use a <code>split()</code> function. The <em>json</em> module, however, handles all of this <span epub:type="pagebreak" id="Page_172" title="172"/>conversion for you. A JSON value like <code>40</code>, with no decimal point or quotation marks, is interpreted as an integer; comma-separated values within square brackets are turned into Python lists automatically; and so forth. Now that you can access the data in Python, you can use it to render a chart.</p>
			<h4 class="HeadProject"><span>Challenge #9: Coffee Chart</span></h4>
			<p class="BodyFirst">You’ll visualize the data for all nine coffees by using nine mugs arranged in a 3 × 3 grid fashion. <a href="#figure8-3" id="figureanchor8-3">Figure 8-3</a> shows a screenshot of the final result.</p>
			<figure>
				<img alt="f08003" src="image_fi/500969c08/f08003.png"/>
				<figcaption>
					<p><a id="figure8-3">Figure 8-3</a>: The complete coffee chart</p>
				</figcaption>
			</figure>
			<p>Add the following code to define a display window size, background color, and some variables, and to lay out nine empty mugs:</p>
			<pre><code><span class="LiteralGray">. . .</span><span class="ProcessingBlue">size</span>(800, 800)<span class="ProcessingBlue">background</span>(<span class="ProcessingPurple">'#004477'</span>)
mug = 120
spacing = 230
col = 1<span epub:type="pagebreak" id="Page_173" title="173"/><span class="ProcessingBlue">translate</span>(100, 100)<span class="ProcessingOlive">for</span> coffee <span class="ProcessingTealGreen">in</span> coffees: <span aria-label="annotation1" class="CodeAnnotation">1</span> <span class="ProcessingGray"># ingredients code goes here</span> <span class="ProcessingGray"># mug</span> <span class="ProcessingBlue">strokeWeight</span>(5) <span class="ProcessingBlue">stroke</span>(<span class="ProcessingPurple">'#FFFFFF'</span>) <span class="ProcessingBlue">noFill</span>() <span class="ProcessingBlue">square</span>(0, 0, mug) <span class="ProcessingBlue">arc</span>(mug, mug/2, 40, 40, -<span class="ProcessingKhaki">HALF_PI</span>, <span class="ProcessingKhaki">HALF_PI</span>) <span class="ProcessingBlue">arc</span>(mug, mug/2, 65, 65, -<span class="ProcessingKhaki">HALF_PI</span>, <span class="ProcessingKhaki">HALF_PI</span>) <span class="ProcessingGray"># label</span> <span class="ProcessingBlue">fill</span>(<span class="ProcessingPurple">'#FFFFFF'</span>) <span class="ProcessingBlue">textSize</span>(16) label = coffee[<span class="ProcessingPurple">'name'</span>] <span class="ProcessingBlue">text</span>(label, mug/2-<span class="ProcessingBlue">textWidth</span>(label)/2, mug+40) <span aria-label="annotation2" class="CodeAnnotation">2</span> <span class="ProcessingOlive">if</span> col = 3: <span class="ProcessingBlue">translate</span>(spacing*-2, spacing) col = 1 <span aria-label="annotation3" class="CodeAnnotation">3</span> <span class="ProcessingOlive">else</span>: <span class="ProcessingBlue">translate</span>(spacing, 0) col += 1</code></pre>
			<p>
				The lines above the <code>for</code> line define the main parameters for the sketch, such as the display window size and background color. The <code>mug</code> and <code>spacing</code> variables control the mug sizing and spacing, respectively; the <code>col</code> variable serves as a column counter. Comments within the <code>for</code> loop indicate where the mug and label drawing code begins. After drawing each mug <span aria-label="annotation3" class="CodeAnnotation">3</span>, Processing translates the drawing space 230 pixels to the right and adds 1 to <code>col</code>. When <code>col</code> reaches 3 <span aria-label="annotation2" class="CodeAnnotation">2</span> (every third mug), the drawing space is shifted back to the left edge of the display window and down one row, and <code>col</code> resets to 1. The ingredients code has been left for you to complete; the comment indicates where you should write it <span aria-label="annotation1" class="CodeAnnotation">1</span>.</p>
			<p>
				Run the sketch. You should see nine empty mugs with labels. Now, complete the chart so it looks like <a href="#figure8-3">Figure 8-3</a>. If you need help, you can access the solution at <a class="LinkURL" href="https://github.com/tabreturn/processing.py-book/tree/master/chapter-08-dictionaries_and_json/coffee_chart/">https://github.com/tabreturn/processing.py-book/tree/master/chapter-08-dictionaries_and_json/coffee_chart/</a>.</p>
			<h2 id="h1-500969c08-0005">Summary</h2>
			<p class="BodyFirst">In this chapter, you learned to organize a collection of items in a dictionary that can associate values with meaningfully named keys. Furthermore, you combined dictionaries and lists to create more intuitive data structures. You also learned how to define, access, modify, and nest dictionaries, and how to loop through dictionaries by using keys, then values.</p>
			<p>
				This chapter also introduced you to JSON. You learned how it’s similar to Python dictionaries and lists, and how to read in JSON data. You can store <span epub:type="pagebreak" id="Page_174" title="174"/>dictionary and list data in JSON files to separate your Python code from your data. If you’re looking for interesting data to work with, many online sources host JSON datasets that you can access for free.</p>
			<p>
				In <span class="xref">Chapter 9</span>, you’ll learn how to define and work with functions, which are named sections of code. You decide what to name your functions, and whenever you want to run a function, you call it by its name. This helps reduce repetition in your code because you can repeat a one-line function call instead of many lines of code. Think of functions as reusable blocks of code that will make your sketches more efficient and easier to maintain. You’ll write functions, including some to generate elliptical and wave-like motion, and then you’ll use these functions to program animated effects that employ trigonometry.</p>
		</section>
	</body></html>