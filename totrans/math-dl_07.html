<html><head></head><body><div id="sbo-rt-content"><h2 class="h2" id="ch07"><span epub:type="pagebreak" id="page_163"/><strong><span class="big">7</span><br/>DIFFERENTIAL CALCULUS</strong></h2>&#13;
<div class="imagec"><img src="Images/common.jpg" alt="image" width="189" height="189"/></div>&#13;
<p class="noindents">The discovery of “the calculus” by Sir Issac Newton, and separately by Gottfried Wilhelm Leibniz, was one of the greatest achievements in the history of mathematics. Calculus is typically split into two main parts: differential and integral. Differential calculus talks about rates of change and their relationships, embodied in the notion of the derivative. Integral calculus is concerned with things like the area under a curve.</p>&#13;
<p class="indent">We don’t need integral calculus for deep learning, but we’ll use differential calculus often. For example, we use differential calculus to train neural networks; we adjust the weights of a neural network using gradient descent, which relies on derivatives calculated via the backpropagation algorithm.</p>&#13;
<p class="indent">The derivative will be the star of this chapter. We’ll begin by introducing the idea of slope and seeing how it leads to the notion of a derivative. We’ll then formally define the derivative and learn how to calculate derivatives of functions of one variable. After that, we’ll learn how to use derivatives to find the minima and maxima of functions. Next come partial derivatives, the derivatives with respect to a single variable for functions of more than one variable. We’ll use partial derivatives extensively in the backpropagation <span epub:type="pagebreak" id="page_164"/>algorithm. We’ll conclude with gradients, which will introduce us to matrix calculus, the subject of <a href="ch08.xhtml#ch08">Chapter 8</a>.</p>&#13;
<h3 class="h3" id="ch07lev1_1">Slope</h3>&#13;
<p class="noindent">In algebra class, we learned all about lines. One way to define a line is the slope-intercept form,</p>&#13;
<p class="center"><em>y</em> = <em>mx</em> + <em>b</em></p>&#13;
<p class="noindent">where <em>m</em> is the slope and <em>b</em> is the <em>y</em> intercept, the place where the line crosses the y-axis. We’re interested in the slope. If we know two points on the line, (<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>) and (<em>x</em><sub>0</sub>, <em>y</em><sub>0</sub>), we know the slope of the line:</p>&#13;
<div class="imagec"><img src="Images/164equ01.jpg" alt="Image" width="108" height="44"/></div>&#13;
<p class="indent">The <em>slope</em> tells us how much of a change in <em>y</em> we will get for any given change in <em>x</em> position. If the slope is positive, then a positive change in <em>x</em> leads to a positive change in <em>y</em>. On the other hand, a negative slope means that a positive change in <em>x</em> leads to a negative change in <em>y</em>.</p>&#13;
<p class="indent">The slope-intercept form of the line tells us that the slope is the proportionality constant between <em>x</em> and <em>y</em>. The intercept, <em>b</em>, is a constant offset. This means a change in <em>x</em> position from <em>x</em><sub>1</sub> to <em>x</em><sub>0</sub> leads to an <em>m</em>(<em>x</em><sub>1</sub> − <em>x</em><sub>0</sub>) change in <em>y</em>. Slopes relate two things, telling us how changing one affects the other. We’ll get back to this idea several times in the book.</p>&#13;
<p class="indent">Now, let’s visualize this with some examples. <a href="ch07.xhtml#ch07fig01">Figure 7-1</a> shows the plot of a curve and some lines that intersect it.</p>&#13;
<div class="image" id="ch07fig01"><img src="Images/07fig01.jpg" alt="image" width="674" height="438"/></div>&#13;
<p class="figcap"><em>Figure 7-1: A curve with a secant line (</em>A<em>) and a tangent line (</em>B<em>)</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_165"/>The line labeled <em>A</em> crosses the curve at two points, <em>x</em><sub>1</sub> and <em>x</em><sub>0</sub>. A line passing between two points on a curve is called a <em>secant</em> line. The other line, <em>B</em>, just touches the curve at the point <em>x</em><em><sub>t</sub></em>. Lines that touch a curve at one point are called <em>tangent</em> lines. We’ll get back to secant lines in the next section, but, for now, notice that the tangent line has a particular slope at <em>x</em><em><sub>t</sub></em> and that a secant line becomes a tangent line as the distance between the points <em>x</em><sub>1</sub> and <em>x</em><sub>0</sub> goes toward zero.</p>&#13;
<p class="indent">Imagine that we move the point <em>x</em><em><sub>t</sub></em> from place to place along the curve; we can see that the slope of the tangent line at <em>x</em><em><sub>t</sub></em> would change with it. As we approach the minimum point of the curve, near <em>x</em> = 0.3, we see that the slope becomes more and more shallow. If we approach from the left, the slope is negative and becomes less and less negative. If we approach from the right, the slope is positive but becomes smaller and smaller. At the actual minimum point, near <em>x</em> = 0.3, the tangent line is horizontal, with a slope of zero. Similarly, if we approach the maximum of the curve, near <em>x</em> = −0.8, the slope also approaches zero.</p>&#13;
<p class="indent">We can see that the tangent line tells us how the curve is changing at a point. As we’ll see later in the chapter, the fact that the slope of a tangent line is zero at the minima and maxima of a curve points us toward a method for finding these points. The points where the slope of the tangent line is zero are known as <em>stationary points</em>.</p>&#13;
<p class="indent">Of course, to take advantage of the slope of the tangent line, we need to be able to find its value for any <em>x</em> on the curve. The next section will show us how.</p>&#13;
<h3 class="h3" id="ch07lev1_2">Derivatives</h3>&#13;
<p class="noindent">The previous section introduced the idea of secant and tangent lines and hinted that knowing the slope of the tangent line at any point on a curve is a potentially useful thing. The slope of the tangent line at a point <em>x</em> is known as the <em>derivative</em> at <em>x</em>. It tells us how the curve (function) is changing at the point <em>x</em>, that is, how the function value changes with an infinitesimal change in <em>x</em>. In this section, we’ll formally define the derivative and learn shortcut rules for calculating derivatives of functions of a single variable, <em>x</em>.</p>&#13;
<h4 class="h4" id="ch07lev2_1">A Formal Definition</h4>&#13;
<p class="noindent">A typical first-semester calculus course introduces you to derivatives through studying limits. I mentioned above how the slope of the secant line between two points on a curve becomes a tangent line when the points collapse on top of each other, and that’s one place where limits come into play.</p>&#13;
<p class="indent">For example, if <em>y</em> = <em>f</em>(<em>x</em>) is a curve, and we have two points on the curve, <em>x</em><sub>0</sub> and <em>x</em><sub>1</sub>, then the slope, Δ<em>y</em>/Δ<em>x</em>, between these points is</p>&#13;
<div class="imagec" id="ch07equ01"><img src="Images/07equ01.jpg" alt="Image" width="476" height="50"/></div>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_166"/>This is the <em>rise over run</em> you may remember learning in school. The <em>rise</em>, <em>Δy</em> = <em>y</em><sub>1</sub> − <em>y</em><sub>0</sub> = <em>f</em>(<em>x</em><sub>1</sub>) − <em>f</em>(<em>x</em><sub>0</sub>), is divided by the <em>run</em>, Δ<em>x</em> = <em>x</em><sub>1</sub> − <em>x</em><sub>0</sub>. We typically use Δ as a prefix to mean the change in some variable.</p>&#13;
<p class="indent">If we define <em>h</em> = <em>x</em><sub>1</sub> − <em>x</em><sub>0</sub>, we can rewrite <a href="ch07.xhtml#ch07equ01">Equation 7.1</a> as</p>&#13;
<div class="imagec"><img src="Images/166equ01.jpg" alt="Image" width="202" height="45"/></div>&#13;
<p class="noindent">since <em>x</em><sub>1</sub> = <em>x</em><sub>0</sub> + <em>h</em>.</p>&#13;
<p class="indent">In this new form, we can find the slope of the tangent line at <em>x</em><sub>0</sub> by letting <em>h</em> get closer and closer to zero, <em>h</em> → 0. Letting a value approach another value is a <em>limit</em>. Letting <em>h</em> → 0 moves the two points we’re calculating the slope between closer and closer. This leads directly to the definition of the derivative</p>&#13;
<div class="imagec" id="ch07equ02"><img src="Images/07equ02.jpg" alt="Image" width="485" height="45"/></div>&#13;
<p class="noindent">where <em>dy</em>/<em>dx</em> or <em>f′</em>(<em>x</em>) is used to represent the derivative of <em>f</em>(<em>x</em>).</p>&#13;
<p class="indent">Before we get into what the derivative means, let’s take a minute to discuss notation. Using <em>f</em>′(<em>x</em>) for the derivative follows Joseph-Louis Lagrange. Leibniz used <em>dy</em>/<em>dx</em> to mirror the notation for slope with Δ → <em>d</em>. If Δ<em>y</em> is a change in <em>y</em> between two points, <em>dy</em> is the infinitesimal change in <em>y</em> at a single point. Newton used yet another notation, <img src="Images/166equ02.jpg" alt="Image" width="14" height="25"/>, with the dot representing the derivative of <em>f</em>. Physicists often use Newton’s notation for the specific case of derivatives with respect to time. For example, if <em>f</em>(<em>t</em>) is the position of a particle as a function of time, <em>t</em>, then <img src="Images/166equ03.jpg" alt="Image" width="30" height="25"/> is the derivative with respect to <em>t</em>, that is, how the position is changing in time. How a position changes in time is the speed (velocity if using vectors). You’ll see all of these notations in books. My preference is to preserve <img src="Images/166equ02.jpg" alt="Image" width="14" height="25"/> for functions of time and use Lagrange’s <em>f</em>′(<em>x</em>) and Leibniz’s <em>dy</em>/<em>dx</em> interchangeably elsewhere.</p>&#13;
<p class="indent">Although <a href="ch07.xhtml#ch07equ02">Equation 7.2</a> above is quite tedious and the bane of many beginning calculus students, at least until they hit integration, you could work with it if you had to. However, we won’t discuss integration at all in this book, so you can take a deep breath and relax.</p>&#13;
<p class="indent">After the struggle with limits, calculus students are let in on a secret: a small set of rules will allow you to calculate virtually all derivatives <em>without</em> using limits. We’ll start by introducing these rules, one at a time with examples, and then, at the end of this section, we’ll put them all together in a form suitable for a T-shirt.</p>&#13;
<p class="indent">However, before we dive into the rules, let’s spend a little more time discussing <em>what</em> the derivative is telling us. Above, I mentioned that how a position changes in time is given by the derivative. This is true of all derivatives; they tell us how something is changing with respect to how something else is changing. We even see this in Leibniz’s notation, <em>dy</em>/<em>dx</em>, how <em>dy</em> changes for a change in <em>dx</em>. The derivative at <em>x</em> tells us how the function is <span epub:type="pagebreak" id="page_167"/>changing at <em>x</em>. As we’ll see, the derivative of <em>f</em>(<em>x</em>) is itself a new function of <em>x</em>. If we pick a specific <em>x</em><sub>0</sub>, then we know that <em>f</em>(<em>x</em><sub>0</sub>) is the value of the function at <em>x</em><sub>0</sub>.</p>&#13;
<p class="indent">Similarly, if we know the derivative, then <em>f</em>′(<em>x</em><sub>0</sub>) is how quickly, and in which direction, the function, <em>f</em>(<em>x</em>), is changing at <em>x</em><sub>0</sub>. Consider the definition of speed as how the position changes with time. We even say it in words: my current speed is 30 mph—<em>miles per hour</em>—a change in position with respect to a change in time.</p>&#13;
<p class="indent">We’ll use derivatives like rates and see how changing one thing affects another. In the end, for deep learning, we want to know how changing the value of a parameter in a network will ultimately change the loss function, the error between what the network should have output and what it actually output.</p>&#13;
<p class="indent">If <em>f</em>′(<em>x</em>) is a function of <em>x</em>, then we should be able to take the derivative of it. We call <em>f</em>′(<em>x</em>) the <em>first derivative</em>. Its derivative, which we denote as <em>f</em>′′(<em>x</em>), is the <em>second derivative</em>. In Leibniz’s notation, we write <em>d</em><sup>2</sup><em>y</em>/<em>dx</em><sup>2</sup>. The second derivative tells us how the first derivative is changing with respect to <em>x</em>. Physics helps here. The first derivative of the position as a function of time (<em>f</em>) is the <em>velocity</em>, <img src="Images/167equ01.jpg" alt="Image" width="13" height="25"/>—how the position is changing with time. Therefore, the second derivative of the position, <img src="Images/167equ02.jpg" alt="Image" width="13" height="25"/>, which is the first derivative of the velocity, is how the velocity is changing with time. We call this the <em>acceleration</em>.</p>&#13;
<p class="indent">In theory, there is no end to how many derivatives we can calculate. In reality, many functions ultimately end up with a derivative that is a constant value. Since a constant value doesn’t change, its derivative is zero.</p>&#13;
<p class="indent">To sum up, the derivative of <em>f</em>(<em>x</em>) is another function, <em>f</em>′(<em>x</em>) or <em>dy</em>/<em>dx</em>, that tells us the slope of the line tangent to <em>f</em>(<em>x</em>) at every point. And, since <em>f</em>′(<em>x</em>) is a function of <em>x</em>, it also has a derivative, <em>f</em>′′(<em>x</em>) or <em>d</em><sup>2</sup><em>y</em>/<em>dx</em><sup>2</sup>, the second derivative, telling us how <em>f</em>′(<em>x</em>) changes at each <em>x</em>, and so on. We’ll see below how to make use of first and second derivatives. For now, let’s learn the rules of <em>differentiation</em>, the act of calculating a derivative.</p>&#13;
<h4 class="h4" id="ch07lev2_2">Basic Rules</h4>&#13;
<p class="noindent">We mentioned one rule in the previous section: that the derivative of a constant, <em>c</em>, is zero. So, we write</p>&#13;
<div class="imagec"><img src="Images/167equ03.jpg" alt="Image" width="67" height="44"/></div>&#13;
<p class="noindent">where we’re using Leibniz’s notation in operator form: <em>d</em>/<em>dx</em>. Think of <em>d</em>/<em>dx</em> as something operating on what follows; it does this the same way that negation does: to negate <em>c</em>, we write <em>−c</em>; to differentiate <em>c</em>, we write <img src="Images/167equ04.jpg" alt="Image" width="25" height="26"/>. If our expression has no <em>x</em>, then we will treat it as a constant, and the derivative will be zero.</p>&#13;
<h5 class="h5" id="ch07lev3_1"><span epub:type="pagebreak" id="page_168"/>The Power Rule</h5>&#13;
<p class="noindent">The derivative of a power of <em>x</em> uses the <em>power rule</em>,</p>&#13;
<div class="imagec"><img src="Images/168equ01.jpg" alt="Image" width="136" height="44"/></div>&#13;
<p class="noindent">where <em>a</em> is a constant and <em>n</em> is an exponent that doesn’t need to be an integer. Let’s see some examples:</p>&#13;
<div class="imagec"><img src="Images/168equ02.jpg" alt="Image" width="306" height="376"/></div>&#13;
<p class="indent">We often build algebraic expressions out of terms that are added and subtracted. Differentiation is a linear operator, so we can write</p>&#13;
<div class="imagec"><img src="Images/168equ03.jpg" alt="Image" width="295" height="43"/></div>&#13;
<p class="noindent">This means we calculate derivatives term by term. For example, with the set of rules we have so far, we now know how to calculate the derivative of a polynomial:</p>&#13;
<div class="imagec"><img src="Images/168equ04.jpg" alt="Image" width="349" height="125"/></div>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_169"/>In general, then,</p>&#13;
<div class="imagec"><img src="Images/169equ01.jpg" alt="Image" width="568" height="106"/></div>&#13;
<p class="noindent">where we see that the derivative of a polynomial of degree <em>n</em> is another polynomial of degree <em>n</em> − 1 and that any constant term in the original polynomial drops to zero.</p>&#13;
<h5 class="h5" id="ch07lev3_2">The Product Rule</h5>&#13;
<p class="noindent">Differentiation of functions multiplied together has its own rule, the <em>product rule</em>:</p>&#13;
<div class="imagec"><img src="Images/169equ02.jpg" alt="Image" width="288" height="43"/></div>&#13;
<p class="noindent">The derivative of the product is the derivative of the first function times the second plus the derivative of the second times the first. Consider the following examples:</p>&#13;
<div class="imagec"><img src="Images/169equ03.jpg" alt="Image" width="524" height="316"/></div>&#13;
<h5 class="h5" id="ch07lev3_3">The Quotient Rule</h5>&#13;
<p class="noindent">The derivative of a function divided by another function follows the <em>quotient rule</em>:</p>&#13;
<div class="imagec"><img src="Images/169equ04.jpg" alt="Image" width="300" height="51"/></div>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_170"/>This leads to examples like these:</p>&#13;
<div class="imagec"><img src="Images/170equ01.jpg" alt="Image" width="518" height="270"/></div>&#13;
<h5 class="h5" id="ch07lev3_4">The Chain Rule</h5>&#13;
<p class="noindent">The next rule concerns the composition of functions. Two functions are composed when the output of one is used as the input to another. The <em>chain rule</em> applies to function compositions, and it’s of fundamental importance in the training of neural networks. The rule is</p>&#13;
<div class="imagec"><img src="Images/170equ02.jpg" alt="Image" width="213" height="43"/></div>&#13;
<p class="noindent">We multiply the derivative of the outer function, using <em>g</em>(<em>x</em>) as the variable, by the derivative of the inner function with respect to <em>x</em>.</p>&#13;
<p class="indent">As a first example, consider the function <em>f</em>(<em>x</em>) = (<em>x</em><sup>2</sup> + 2<em>x</em> + 3)<sup>2</sup>. Is this the composition of two functions? It is. Let’s define <em>f</em>(<em>g</em>) = <em>g</em><sup>2</sup> and <em>g</em>(<em>x</em>) = <em>x</em><sup>2</sup> + 2<em>x</em> + 3. Then, we can find <em>f</em>(<em>x</em>) by replacing every instance of <em>g</em> in <em>f</em>(<em>g</em>) with the definition of <em>g</em> in terms of <em>x</em>: <em>g</em>(<em>x</em>) = <em>x</em><sup>2</sup> + 2<em>x</em> + 3. This gives</p>&#13;
<p class="center"><em>f</em>(<em>x</em>) = <em>g</em><sup>2</sup> = (<em>x</em><sup>2</sup> + 2<em>x</em> + 3)<sup>2</sup></p>&#13;
<p class="noindent">which is, naturally, what we started with. To find <em>f</em>′(<em>x</em>), we first find <em>f</em>′(<em>g</em>), the derivative of <em>f</em> with respect to <em>g</em>, and then multiply by <em>g</em>′(<em>x</em>), the derivative of <em>g</em> with respect to <em>x</em>. As a final step, we replace references to <em>g</em> with its definition in terms of <em>x</em>. So, we calculate <em>f</em>′(<em>x</em>) as</p>&#13;
<div class="imagec"><img src="Images/170equ03.jpg" alt="Image" width="268" height="115"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_171"/>We typically don’t explicitly call out <em>f</em>(<em>g</em>) and <em>g</em>(<em>x</em>), but mentally we work through the same process. Let’s see some more examples. In this one, we want to find</p>&#13;
<div class="imagec"><img src="Images/171equ01.jpg" alt="Image" width="164" height="43"/></div>&#13;
<p class="indent">If we use the chain rule, we see that we have <em>f</em>(<em>g</em>) = 2<em>g</em><sup>2</sup> + 3 and <em>g</em>(<em>x</em>) = 4<em>x</em> − 5. Therefore, we can write</p>&#13;
<div class="imagec"><img src="Images/171equ02.jpg" alt="Image" width="300" height="136"/></div>&#13;
<p class="noindent">where <em>f</em>′(<em>g</em>) = 2<em>g</em> and <em>g</em>′(<em>x</em>) = 4. With some practice, we’d mentally picture the 4<em>x</em> − 5 of <em>f</em>(<em>x</em>) as its own variable (the substitution of <em>g</em>) and then remember to multiply the derivative of 4<em>x</em> − 5 when done. What if we didn’t see the composition? What if we expanded the entire function, <em>f</em>(<em>x</em>), and then took the derivative? We’d better get the answer we found above by using the chain rule. Let’s see . . .</p>&#13;
<div class="imagec"><img src="Images/171equ03.jpg" alt="Image" width="275" height="210"/></div>&#13;
<p class="noindent">This is what we found above, so our application of the chain rule is correct.</p>&#13;
<p class="indent">Let’s look at another example. If <img src="Images/171equ04.jpg" alt="Image" width="91" height="26"/>, how should we think of calculating the derivative? If we look at the function as <img src="Images/171equ05.jpg" alt="Image" width="92" height="32"/>, with <em>u</em>(<em>x</em>) = 1 and <em>v</em>(<em>x</em>) = 3<em>x</em><sup>2</sup>, we can use the quotient rule and get the following.</p>&#13;
<span epub:type="pagebreak" id="page_172"/>&#13;
<div class="imagec"><img src="Images/172equ01.jpg" alt="Image" width="203" height="252"/></div>&#13;
<p class="noindent">Here, we used a shorthand notation with <em>u</em> and <em>v</em> that drops the formal function of <em>x</em> notation.</p>&#13;
<p class="indent">We can also picture <em>f</em>(<em>x</em>) as (3<em>x</em><sup>2</sup>)<sup>−1</sup>. If we think of it this way, we can apply the chain rule and power rule to get</p>&#13;
<div class="imagec"><img src="Images/172equ02.jpg" alt="Image" width="216" height="158"/></div>&#13;
<p class="noindent">proving that sometimes there’s more than one way to calculate a derivative.</p>&#13;
<p class="indent">We presented the chain rule using Lagrange’s notation. Later in the chapter, we’ll see it again using Leibniz’s notation. Let’s move on now and present a set of rules for trigonometric functions.</p>&#13;
<h4 class="h4" id="ch07lev2_3">Rules for Trigonometric Functions</h4>&#13;
<p class="noindent">The derivatives of the basic trigonometric functions are straightforward:</p>&#13;
<div class="imagec"><img src="Images/172equ03.jpg" alt="Image" width="154" height="208"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_173"/>We can see the last rule is correct if we apply the basic differentiation rules to the definition of the tangent:</p>&#13;
<div class="imagec"><img src="Images/173equ01.jpg" alt="Image" width="324" height="294"/></div>&#13;
<p class="noindent">Remember that sec <em>x</em> = 1/ cos <em>x</em> and sin<sup>2</sup> <em>x</em> + cos<sup>2</sup> <em>x</em> = 1.</p>&#13;
<p class="indent">Let’s look at some examples using the new trig rules. We’ll start with one composing a function with a trig function:</p>&#13;
<div class="imagec"><img src="Images/173equ02.jpg" alt="Image" width="350" height="90"/></div>&#13;
<p class="indent">We can see that this is a composition of <em>f</em>(<em>g</em>) = sin(<em>g</em>) and <em>g</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 3<em>x</em>, so we know we can apply the chain rule to get the derivative as <em>f</em>′(<em>g</em>)<em>g</em>′(<em>x</em>) with <em>f</em>′(<em>g</em>) = cos(<em>g</em>) and <em>g</em>′(<em>x</em>) = 3<em>x</em><sup>2</sup> − 3. The second line simplifies the answer.</p>&#13;
<p class="indent">Let’s look at a more complicated composition:</p>&#13;
<div class="imagec"><img src="Images/173equ03.jpg" alt="Image" width="478" height="90"/></div>&#13;
<p class="noindent">This time, we break up the composition as <em>f</em>(<em>g</em>) = <em>g</em><sup>2</sup> and <em>g</em>(<em>x</em>) = sin(<em>x</em><sup>3</sup> − 3<em>x</em>). However, <em>g</em>(<em>x</em>) is itself a composition of <em>g</em>(<em>u</em>) = sin(<em>u</em>) and <em>u</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 3<em>x</em>, as we had in the previous example. So, the first step is to write the following.</p>&#13;
<span epub:type="pagebreak" id="page_174"/>&#13;
<div class="imagec"><img src="Images/174equ01.jpg" alt="Image" width="232" height="116"/></div>&#13;
<p class="noindent">The first line is the definition of the derivative of a composition. The second line substitutes the derivative of <em>f</em>(<em>g</em>), which is <em>2g</em>, and the third line replaces <em>g</em>(<em>x</em>) with sin(<em>x</em><sup>3</sup> − 3<em>x</em>). Now, we just need to find <em>g</em>′(<em>x</em>), which we can do by using the chain rule a second time with <em>g</em>(<em>u</em>) = sin <em>u</em> and <em>u</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 3<em>x</em>, as we did for the example above. Doing this gives us <em>g</em>′(<em>x</em>) = cos(<em>x</em><sup>3</sup> − 3<em>x</em>)(3<em>x</em><sup>2</sup> − 3), so now we know that <em>f</em>′(<em>x</em>) is</p>&#13;
<div class="imagec"><img src="Images/174equ02.jpg" alt="Image" width="384" height="117"/></div>&#13;
<p class="indent">Let’s do one more example. This one will involve more than one trig function. We want to see how to calculate</p>&#13;
<div class="imagec"><img src="Images/174equ03.jpg" alt="Image" width="317" height="63"/></div>&#13;
<p class="indent">As is often the case when working with trig functions, identities come into play. Here, we see that <em>f</em>(<em>x</em>) can be rewritten:</p>&#13;
<div class="imagec"><img src="Images/174equ04.jpg" alt="Image" width="213" height="177"/></div>&#13;
<p class="noindent">Now the derivative uses the trig rules, the definition of the secant, the chain rule, and the product rule, as shown next.</p>&#13;
<span epub:type="pagebreak" id="page_175"/>&#13;
<div class="imagec"><img src="Images/175equ01.jpg" alt="Image" width="413" height="291"/></div>&#13;
<p class="indent">Let’s move on and look at derivatives of exponentials and logarithms.</p>&#13;
<h4 class="h4" id="ch07lev2_4">Rules for Exponentials and Logarithms</h4>&#13;
<p class="noindent">The derivative of <em>e</em><em><sup>x</sup></em>, where <em>e</em> is the base of the natural logarithm (<em>e</em> ≈ 2.718 . . .), is particularly simple. It is itself:</p>&#13;
<div class="imagec"><img src="Images/175equ02.jpg" alt="Image" width="87" height="43"/></div>&#13;
<p class="indent">When the argument is a function of <em>x</em>, this becomes</p>&#13;
<div class="imagec" id="ch07equ03"><img src="Images/07equ03.jpg" alt="Image" width="427" height="43"/></div>&#13;
<p class="noindent">If the derivative of <em>e<sup>x</sup></em> is <em>e<sup>x</sup></em>, what is the derivative of <em>a<sup>x</sup></em> when <em>a</em> is a real number other than <em>e</em>? To see the answer, we need to remember that <em>e<sup>x</sup></em> and ln <em>x</em>, the natural logarithm using base <em>e</em>, are inverse functions, so <em>e</em><sup>ln<em>a</em></sup> = <em>a</em>. Then, we can write</p>&#13;
<p class="center"><em>a<sup>x</sup></em> = (<em>e</em><sup>ln <em>a</em></sup>)<sup><em>x</em></sup> = <em>e<sup>x</sup></em><sup>ln <em>a</em></sup></p>&#13;
<p class="noindent">We know how to find the derivative of <em>e<sup>x</sup></em><sup>ln<em>a</em></sup> from <a href="ch07.xhtml#ch07equ03">Equation 7.3</a> above. It is</p>&#13;
<div class="imagec"><img src="Images/175equ03.jpg" alt="Image" width="180" height="43"/></div>&#13;
<p class="noindent">but <em>e x</em> ln <em>a</em> = <em>a<sup>x</sup></em>, so we have</p>&#13;
<div class="imagec"><img src="Images/175equ04.jpg" alt="Image" width="128" height="43"/></div>&#13;
<p class="noindent">and, in general,</p>&#13;
<div class="imagec" id="ch07equ04"><img src="Images/07equ04.jpg" alt="Image" width="454" height="43"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_176"/>Notice, if <em>a</em> = <em>e</em>, we have ln(<em>e</em>) = 1, and <a href="ch07.xhtml#ch07equ04">Equation 7.4</a> becomes <a href="ch07.xhtml#ch07equ03">Equation 7.3</a>.</p>&#13;
<p class="indent">Let’s look now at the derivative of the natural log itself. It is</p>&#13;
<div class="imagec"><img src="Images/176equ01.jpg" alt="Image" width="98" height="43"/></div>&#13;
<p class="indent">When the argument is a function of <em>x</em>, this becomes</p>&#13;
<div class="imagec" id="ch07equ05"><img src="Images/07equ05.jpg" alt="Image" width="423" height="50"/></div>&#13;
<p class="indent">You may be wondering: How do we find the derivative of a logarithm that uses a base other than <em>e</em>? For example, what is the derivative of log<sub>10</sub> <em>x</em>? To answer this question, we do something similar to what we did above for the derivative of <em>a</em><em><sup>x</sup></em>. We write the logarithm of <em>x</em> for some base, <em>b</em>, in terms of the natural log, as</p>&#13;
<div class="imagec"><img src="Images/176equ02.jpg" alt="Image" width="110" height="43"/></div>&#13;
<p class="noindent">Here, ln <em>b</em> is a constant that does not depend on <em>x</em>. Also, we now know how to find the derivative of ln <em>x</em>, so we see that the derivative of log<em><sub>b</sub> x</em> must be</p>&#13;
<div class="imagec"><img src="Images/176equ03.jpg" alt="Image" width="148" height="43"/></div>&#13;
<p class="noindent">for any real number base <em>b</em> ≠ 1. And, still more generally,</p>&#13;
<div class="imagec" id="ch07equ06"><img src="Images/07equ06.jpg" alt="Image" width="445" height="50"/></div>&#13;
<p class="noindent">where, again, we notice that if <em>b</em> = <em>e</em>, we get ln <em>e</em> = 1, and <a href="ch07.xhtml#ch07equ06">Equation 7.6</a> becomes <a href="ch07.xhtml#ch07equ05">Equation 7.5</a>.</p>&#13;
<p class="indent">With <a href="ch07.xhtml#ch07equ06">Equation 7.6</a>, we’ve reached the end of our rules for derivatives. Let’s now put them together in a single table we can refer back to throughout the remainder of the book. The result is <a href="ch07.xhtml#ch07tab01">Table 7-1</a>.</p>&#13;
<p class="indent">We know how to find derivatives now. I would encourage you to look for practice sheets with worked-out answers to convince yourself that you understand the rules and how to apply them. Let’s move on and look at how we can use derivatives to find the minima and maxima of functions. Finding minima is critical to the training of neural networks.</p>&#13;
<p class="tabcap" id="ch07tab01"><span epub:type="pagebreak" id="page_177"/><strong>Table 7-1:</strong> The Rules of Differentiation</p>&#13;
<table class="bordertb">&#13;
<colgroup>&#13;
<col style="width:50%"/>&#13;
<col style="width:50%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr class="borderb">&#13;
<th style="vertical-align: top"><p class="tab"><strong>Type</strong></p></th>&#13;
<th style="vertical-align: top"><p class="tab"><strong>Rule</strong></p></th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">Constants</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ01.jpg" alt="Image" width="75" height="35"/></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">Powers</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ02.jpg" alt="Image" width="122" height="37"/></p></td>&#13;
</tr>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">Sums</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ03.jpg" alt="Image" width="223" height="37"/></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">Products</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ04.jpg" alt="Image" width="246" height="37"/></p></td>&#13;
</tr>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">Quotients</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ05.jpg" alt="Image" width="266" height="45"/></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">Chain</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ06.jpg" alt="Image" width="183" height="37"/></p></td>&#13;
</tr>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">Trigonometry</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ07.jpg" alt="Image" width="245" height="148"/></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">Exponents</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ08.jpg" alt="Image" width="189" height="84"/></p></td>&#13;
</tr>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">Logarithms</p></td>&#13;
<td style="vertical-align: top"><p class="tab"><img src="Images/177equ09.jpg" alt="Image" width="170" height="98"/></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h3 class="h3" id="ch07lev1_3">Minima and Maxima of Functions</h3>&#13;
<p class="noindent">Earlier, I defined stationary points as places where the first derivative of a function is zero, that is, places where the slope of the tangent line is zero. We can use this information to decide if a particular point, call it <em>x<sub>m</sub></em>, is a minimum or maximum of the function, <em>f</em>(<em>x</em>). If <em>x<sub>m</sub></em> is a minimum, it is a low point of the function, where <em>f</em>(<em>x<sub>m</sub></em>) is smaller than any point to the immediate left or right of <em>f (x<sub>m</sub></em>). Similarly, if <em>f</em>(<em>x<sub>m</sub></em>) is higher than any point to the immediate left or right, <em>f</em>(<em>x<sub>m</sub></em>) is a maximum. We collectively refer to minima and maxima as <em>extrema</em> of <em>f</em>(<em>x</em>) (singular, <em>extremum</em>).</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_178"/>In terms of the derivative, a <em>minimum</em> is a place where the derivative of points immediately to the left of <em>x<sub>m</sub></em> are negative, and derivatives of points directly to the right of <em>x<sub>m</sub></em> are positive. <em>Maxima</em> are the reverse: derivatives to the left are positive, and derivatives to the right of <em>x<sub>m</sub></em> are negative.</p>&#13;
<p class="indent">Look back at <a href="ch07.xhtml#ch07fig01">Figure 7-1</a>. There, we have a local maximum at about <em>x</em> = −0.8 and a local minimum at about <em>x</em> = 0.3. Let’s say that the maximum is actually at <em>x<sub>m</sub></em> = −0.8. This is a maximum because if we look at any point <em>x<sub>p</sub></em> in the vicinity of <em>x<sub>m</sub></em>, <em>f</em>(<em>x<sub>p</sub></em>) is less than <em>f</em>(<em>x<sub>m</sub></em>). Likewise, if the minimum is at <em>x<sub>m</sub></em> = 0.3, that’s because any point <em>x<sub>p</sub></em> near it has <em>f</em>(<em>x<sub>p</sub></em>) &gt; <em>f</em>(<em>x<sub>m</sub></em>). If we imagine the tangent line sliding along the graph, as it approaches <em>x</em> = −0.8, we see that the slope is positive but heading toward zero. If we move past <em>x</em> = −0.8, the slope is now negative. The reverse is true for the minimum at <em>x</em> = 0.3. Tangent lines approaching from the left have negative slope, but once they’re past <em>x</em> = 0.3, the slope is positive.</p>&#13;
<p class="indent">You’ll read and hear the terms <em>global</em> and <em>local</em> applied to minima and maxima. The global minimum of <em>f</em>(<em>x</em>) is the lowest of all the minima of <em>f</em>(<em>x</em>), and the global maximum is the highest of all the maxima. Other minima and maxima, then, are considered local; they are effective over a particular region, but there are other minima that are lower or maxima that are higher. We should note that not all functions have minima or maxima. For example, a line, <em>f</em>(<em>x</em>) = <em>mx</em> + <em>b</em>, has no minima or maxima, because there are no points on the line that satisfy the requirements for either.</p>&#13;
<p class="indent">So, if the first derivative, <em>f</em>′(<em>x</em>), is zero, we have a minimum or maximum, right? Not so fast. At other stationary points, the first derivative may be zero, but the remaining criteria for a minimum or maximum are not met. These points are often called <em>inflection points</em> or, if in multiple dimensions, <em>saddle points</em>. For example, consider <em>y</em> = <em>x</em><sup>3</sup>. The first derivative is <em>y</em>′ = 3<em>x</em><sup>2</sup>, and the second derivative is <em>y</em>′′ = 6<em>x</em>. Both the first and second derivative are zero at <em>x</em> = 0. However, as we can see in <a href="ch07.xhtml#ch07fig02">Figure 7-2</a>, the slope is positive to both the immediate left and immediate right of <em>x</em> = 0. Therefore, the slope never switches from positive to negative or negative to positive, meaning <em>x</em> = 0 is not an extremum but is an inflection point.</p>&#13;
<div class="image" id="ch07fig02"><img src="Images/07fig02.jpg" alt="image" width="561" height="326"/></div>&#13;
<p class="figcap"><em>Figure 7-2: A graph of y = x<sup>3</sup> showing an inflection point at x = 0</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_179"/>Now assume that <em>x<sub>s</sub></em> is a stationary point so that <em>f</em>′(<em>x<sub>s</sub></em>) = 0. If we pick two other points, <em>x<sub>s−∊</sub></em> and <em>x<sub>s+∊</sub></em>, one just to the left of <em>x<sub>s</sub></em> and the other just to the right, for some very small ∊ (epsilon), we have four possibilities for the values of <em>f</em>′(<em>x<sub>s</sub></em><sub>−∊</sub>) and <em>f</em>′(<em>x<sub>s</sub></em><sub>+∊</sub>), shown in <a href="ch07.xhtml#ch07tab02">Table 7-2</a>.</p>&#13;
<p class="tabcap" id="ch07tab02"><strong>Table 7-2:</strong> Identifying Stationary Points</p>&#13;
<table class="bordertb">&#13;
<colgroup>&#13;
<col style="width:50%"/>&#13;
<col style="width:50%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr class="borderb">&#13;
<th style="vertical-align: top"><p class="tab"><strong>Sign of <em>f’</em>(<em>x<sub>s</sub></em> – ∊), <em>f’</em>(<em>x<sub>s</sub></em> + ∊)</strong></p></th>&#13;
<th style="vertical-align: top"><p class="tab"><strong>Type of stationary point at <em>x<sub>s</sub></em> – ∊ &lt; <em>x<sub>s</sub></em> &lt; <em>x<sub>s</sub></em> + ∊</strong></p></th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">+, –</p></td>&#13;
<td style="vertical-align: top"><p class="tab">Maximum</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">–, +</p></td>&#13;
<td style="vertical-align: top"><p class="tab">Minimum</p></td>&#13;
</tr>&#13;
<tr class="bg-g">&#13;
<td style="vertical-align: top"><p class="tab">+, +</p></td>&#13;
<td style="vertical-align: top"><p class="tab">Neither</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="tab">–, –</p></td>&#13;
<td style="vertical-align: top"><p class="tab">Neither</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Therefore, the value of the first derivative at a candidate stationary point isn’t enough to tell us whether the point represents a minimum or maximum. We can look at the region around the candidate point to help us decide. We can also look at the value of <em>f</em>′′(<em>x</em>), the second derivative of <em>f</em>(<em>x</em>). If <em>x<sub>s</sub></em> is a stationary point where <em>f</em>′(<em>x<sub>s</sub></em>) = 0, the sign of <em>f</em>′′(<em>x<sub>s</sub></em>) can tell us about what type of stationary point <em>x<sub>s</sub></em> might be. If <em>f</em>′′(<em>x<sub>s</sub></em>) &lt; 0, then <em>x<sub>s</sub></em> is a <em>maximum</em> of <em>f</em>(<em>x</em>). If <em>f</em>′′(<em>x<sub>s</sub></em>) &gt; 0, <em>x<sub>s</sub></em> is a minimum. If <em>f</em>′′(<em>x<sub>s</sub></em>) = 0, the second derivative isn’t helpful; we will need to explicitly test nearby points with the first derivative.</p>&#13;
<p class="indent">How do we find candidate stationary points in the first place? For algebraic functions, we solve <em>f</em>′(<em>x</em>) = 0; we find the solution set of all the <em>x</em> values that make the first derivative of <em>f</em>(<em>x</em>) zero. We then use the derivative tests to decide which are minima, maxima, or inflection points.</p>&#13;
<p class="indent">For many functions, we can find the solutions to <em>f</em>′(<em>x</em>) = 0 directly. For example, if <em>f</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 2<em>x</em> + 4, we have <em>f</em>′(<em>x</em>) = 3<em>x</em><sup>2</sup> − 2. If we set this equal to zero, <em>3x</em><sub>2</sub> − 2 = 0, and solve using the quadratic formula, we find that there are two stationary points: <img src="Images/179equ01.jpg" alt="Image" width="119" height="24"/> and <img src="Images/179equ02.jpg" alt="Image" width="103" height="24"/>. The second derivative of <em>f</em>(<em>x</em>) is <em>f</em>′′(<em>x</em>) = 6<em>x</em>. The sign of <em>f</em>′′(<em>x</em><sub>0</sub>) is negative; therefore, <em>x</em><sub>0</sub> represents a maximum. And because the sign of <em>f</em>′′(<em>x</em><sub>1</sub>) is positive, <em>x</em><sub>1</sub> is a minimum.</p>&#13;
<p class="indent">We can see that the derivative tests are correct. The top of <a href="ch07.xhtml#ch07fig03">Figure 7-3</a> shows us a plot of <em>f</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 2<em>x</em> + 4, where <em>x</em><sub>0</sub> is a maximum and <em>x</em><sub>1</sub> is a minimum.</p>&#13;
<p class="indent">Let’s look at one more example. This time, we have <em>f</em>(<em>x</em>) = <em>x</em><sup>5</sup>−2<em>x</em><sup>3</sup>+<em>x</em>+2, the bottom plot of <a href="ch07.xhtml#ch07fig03">Figure 7-3</a>. We find the first derivative and set it to zero:</p>&#13;
<p class="center"><em>f</em>′(<em>x</em>) = 5<em>x</em><sup>4</sup> − 6<em>x</em><sup>2</sup> + 1 = 0</p>&#13;
<p class="indent">If we substitute <em>u</em> = <em>x</em><sup>2</sup>, we can solve for the roots of <em>f</em>′(<em>x</em>) by finding the roots of 5<em>u</em><sup>2</sup>−6<em>u</em>+1 and setting those equal to <em>x</em><sup>2</sup>. Doing this gives us <img src="Images/179equ03.jpg" alt="Image" width="70" height="26"/> and <img src="Images/179equ04.jpg" alt="Image" width="100" height="30"/>, so we have four stationary points. To test them, we can use the second derivative test. The second derivative is <em>f</em>′′(<em>x</em>) = 20<em>x</em><sup>3</sup> − 12<em>x</em>.</p>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_180"/>Substituting the stationary points into <em>f</em>′′ gives</p>&#13;
<div class="imagec"><img src="Images/180equ01.jpg" alt="Image" width="223" height="213"/></div>&#13;
<p class="noindent">meaning <em>x</em><sub>0</sub> is a maximum, <em>x</em><sub>1</sub> is a minimum, <em>x</em><sub>2</sub> is another maximum, and <em>x</em><sub>3</sub> is a minimum. <a href="ch07.xhtml#ch07fig03">Figure 7-3</a> again confirms our conclusions.</p>&#13;
<div class="image" id="ch07fig03"><img src="Images/07fig03.jpg" alt="image" width="586" height="766"/></div>&#13;
<p class="figcap"><em>Figure 7-3: Plots of f(x) = x<sup>3</sup> – 2x + 4 (top) and x<sup>5</sup> – 2x<sup>3</sup> + x + 2 (bottom), with extrema marked</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_181"/>What if we can’t easily find the stationary points of a function? Perhaps we can’t solve the function algebraically, or maybe it can’t be expressed in closed form, meaning no finite set of operations represents it. A typical calculus course isn’t interested in these situations. Still, we need to be, because one way to think of a neural network is as a function approximator, one whose function can’t be expressed directly. Can we still profitably use our new knowledge of derivatives? The answer is yes, we can. We can use the derivative as a pointer to tell us how to move closer and closer to the extrema. This is what gradient descent does, and we’ll spend quite a bit of time discussing it later in the book.</p>&#13;
<p class="indent">For now, however, let’s move on and examine functions of more than one variable and see what this does to the idea of a derivative.</p>&#13;
<h3 class="h3" id="ch07lev1_4">Partial Derivatives</h3>&#13;
<p class="noindent">So far, we’ve focused exclusively on functions of one variable, <em>x</em>. What happens to the notion of differentiation when we have functions of more than one variable, say, <em>f</em>(<em>x</em>, <em>y</em>), or <em>f</em>(<em>x</em><sub>0</sub>, <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, . . . , <em>x<sub>n</sub></em>)? To handle these cases, we’ll introduce the idea of a <em>partial derivative</em>. Note that, for clarity, we’ll use Leibniz’s notation in this section.</p>&#13;
<p class="indent"><a href="ch07.xhtml#ch07equ02">Equation 7.2</a> defined the derivative of <em>f</em>(<em>x</em>) with respect to <em>x</em>. If <em>x</em> is the only variable, why did we add the extra phrase “with respect to <em>x</em>”? Now we’ll find out why: the partial derivative with respect to one of the variables in the expression is found by holding all the other variables fixed. We treat them as if they were constants. Then we say we’re calculating the partial derivative with respect to the one not held fixed.</p>&#13;
<p class="indent">Let’s look at an example. Let <em>f</em>(<em>x</em>, <em>y</em>) = <em>xy</em> + <em>x</em>/<em>y</em>. Then, we can calculate <em>two</em> partial derivatives, one with respect to <em>x</em> and the other with respect to <em>y</em>:</p>&#13;
<div class="imagec"><img src="Images/181equ01.jpg" alt="Image" width="232" height="138"/></div>&#13;
<p class="noindent">The rules of differentiation we learned earlier in the chapter still apply. Notice the <em>d</em> has changed to ∂. This indicates that the function, <em>f</em>, is of more than one variable. Also, see that when calculating the respective derivatives, we held the other variable fixed as if it were a parameter. As far as calculating partial derivatives, that’s all there is to it. Let’s see a few more examples to help you make the idea more concrete.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_182"/>If <em>f</em>(<em>x</em>, <em>y</em>, <em>z</em>) = <em>x</em><sup>2</sup> + <em>y</em><sup>2</sup> + <em>z</em><sup>2</sup> + 3<em>xyz</em>, we can find three partial derivatives:</p>&#13;
<div class="imagec"><img src="Images/182equ01.jpg" alt="Image" width="123" height="216"/></div>&#13;
<p class="noindent">The other two variables are considered constant. This is why, for example, in the partial derivative with respect to <em>x</em>, <em>y</em><sup>2</sup> and <em>z</em><sup>2</sup> become 0, and 3<em>xyz</em> becomes <em>3yz</em>.</p>&#13;
<p class="indent">If <img src="Images/182equ02.jpg" alt="Image" width="246" height="25"/>, we have four partial derivatives:</p>&#13;
<div class="imagec"><img src="Images/182equ03.jpg" alt="Image" width="201" height="483"/></div>&#13;
<p class="indent">As a more complex example, consider <em>f</em>(<em>x</em>, <em>y</em>) = <em>e<sup>xy</sup></em> cos <em>x</em> sin <em>y</em>. The partial derivatives are listed next where we use the product rule in each case.</p>&#13;
<span epub:type="pagebreak" id="page_183"/>&#13;
<div class="imagec"><img src="Images/183equ01.jpg" alt="Image" width="364" height="213"/></div>&#13;
<h4 class="h4" id="ch07lev2_5">Mixed Partial Derivatives</h4>&#13;
<p class="noindent">Just as with the derivative of a function of a single variable, we can take partial derivatives of a partial derivative. These are known as <em>mixed partials</em>. Additionally, we have more flexibility because we can change which variable we take the next partial derivative with respect to. For example, above, we saw that the partial derivative of <img src="Images/183equ02.jpg" alt="Image" width="220" height="25"/> with respect to <em>z</em> is</p>&#13;
<div class="imagec"><img src="Images/183equ03.jpg" alt="Image" width="154" height="49"/></div>&#13;
<p class="noindent">which is still a function of <em>x</em>, <em>y</em>, <em>z</em>, and <em>t</em>. Therefore, we can calculate second partial derivatives like so:</p>&#13;
<div class="imagec"><img src="Images/183equ04.jpg" alt="Image" width="428" height="472"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_184"/>I’ll explain the notation. We started with the partial derivative of <em>f</em> with respect to <em>z</em>, so we write ∂<em>f</em>/∂<em>z</em>. Then, from this starting point, we are taking other partial derivatives. So, if we want to denote the partial with respect to <em>x</em>, we think of it this way:</p>&#13;
<div class="imagec"><img src="Images/184equ01.jpg" alt="Image" width="152" height="48"/></div>&#13;
<p class="noindent">where we can think of the partial derivative operator “multiplying” the “numerator” and “denominator” like a fraction. To be clear, however, these are not fractions; the notation has just inherited the flavor of a fraction from its slope origins. Still, if the mnemonic is helpful, then it’s helpful. For a second partial derivative, the variable it’s taken with respect to is on the left. Also, if the variables are the same, an exponent (of sorts) is used, as in ∂<sup>2</sup><em>f</em>/∂<em>z</em><sup>2</sup>.</p>&#13;
<h4 class="h4" id="ch07lev2_6">The Chain Rule for Partial Derivatives</h4>&#13;
<p class="noindent">To apply the chain rule to partial derivatives, we need to track all the variables. So, if we have <em>f</em>(<em>x</em>, <em>y</em>), where both <em>x</em> and <em>y</em> are functions of other variables, <em>x</em>(<em>r</em>, <em>s</em>) and <em>y</em>(<em>r</em>, <em>s</em>), then we can find the partials of <em>f</em> with respect to <em>r</em> and <em>s</em> by applying the chain rule for each variable, <em>x</em> and <em>y</em>. Specifically,</p>&#13;
<div class="imagec"><img src="Images/184equ02.jpg" alt="Image" width="296" height="140"/></div>&#13;
<p class="indent">As an example, let <em>f</em>(<em>x</em>, <em>y</em>) = <em>x</em><sup>3</sup>+<em>y</em><sup>3</sup> with <em>x</em>(<em>r</em>, <em>s</em>) = 3<em>r</em>+2<em>s</em> and <em>y</em>(<em>r</em>, <em>s</em>) = <em>r</em><sup>2</sup>−3<em>s</em>. Now find ∂<em>f</em>/∂<em>r</em> and ∂<em>f</em>/∂<em>s</em>. To find these partials, we’ll need to calculate six expressions,</p>&#13;
<div class="imagec"><img src="Images/184equ03.jpg" alt="Image" width="540" height="50"/></div>&#13;
<p class="noindent">so that the desired partials are</p>&#13;
<span epub:type="pagebreak" id="page_185"/>&#13;
<div class="imagec"><img src="Images/185equ01.jpg" alt="Image" width="296" height="516"/></div>&#13;
<p class="indent">Just as with a function of a single variable, the chain rule for functions of more than one variable is recursive, such that if <em>r</em> and <em>s</em> were themselves functions of another variable, we could apply the chain rule one more time to find the partial of <em>f</em> with respect to that variable. For example, if we have <em>x</em>(<em>r</em>, <em>s</em>), <em>y</em>(<em>r</em>, <em>s</em>), with <em>r</em>(<em>w</em>), <em>s</em>(<em>w</em>), we find ∂<em>f</em>/∂<em>w</em> by using</p>&#13;
<div class="imagec"><img src="Images/185equ02.jpg" alt="Image" width="445" height="140"/></div>&#13;
<p class="indent">In the end, we need to remember that ∂<em>f</em>/∂<em>w</em> tells us how <em>f</em> will change for a small change in <em>w</em>. We’ll use this fact during gradient descent.</p>&#13;
<p class="indent">This section concerned itself with the mechanical calculation of partial derivatives. Let’s move on to explore more of the meaning behind these quantities. This will lead us to the idea of a gradient.</p>&#13;
<h3 class="h3" id="ch07lev1_5"><span epub:type="pagebreak" id="page_186"/>Gradients</h3>&#13;
<p class="noindent">In <a href="ch08.xhtml#ch08">Chapter 8</a>, we will dive into the matrix calculus representation we use in deep learning. However, before we do that, we will conclude this chapter by introducing the idea of a <em>gradient</em>. The gradient builds on the derivatives we’ve been calculating. In short, the gradient tells us how a function of more than one variable is changing and the direction in which it is changing the most.</p>&#13;
<h4 class="h4" id="ch07lev2_7">Calculating the Gradient</h4>&#13;
<p class="noindent">If we have <em>f</em>(<em>x</em>, <em>y</em>, <em>z</em>), we saw above how to calculate partial derivatives with respect to each of the variables. If we interpret the variables as positions on coordinate axes, we see that <em>f</em> is a function that returns a scalar, a single number, for any position in 3D space, (<em>x</em>, <em>y</em>, <em>z</em>). We could even go so far as to write <em>f</em>(<em><strong>x</strong></em>) where <em><strong>x</strong></em> = (<em>x</em>, <em>y</em>, <em>z</em>) to acknowledge that <em>f</em> is a function of a vector input. As in previous chapters, we’ll use lowercase bold letters to represent vectors, <em><strong>x</strong></em>. Note, some people use <img src="Images/xbar.jpg" alt="Image" width="10" height="15"/> to represent vectors.</p>&#13;
<p class="indent">We can write vectors horizontally, as a row vector, like in the previous paragraph, or vertically,</p>&#13;
<div class="imagec"><img src="Images/186equ01.jpg" alt="Image" width="69" height="68"/></div>&#13;
<p class="noindent">as a column vector, where we’ve also used square brackets instead of parentheses. Either notation is acceptable. Unless we’re intentionally sloppy, usually when we’re discussing a vector in code, we’ll assume that our vectors are column vectors. This means a vector is a matrix with <em>n</em> rows and one column, <em>n</em> × 1.</p>&#13;
<p class="indent">A function that accepts a vector input and returns a single number as output is known as a <em>scalar field</em>. The canonical example of a scalar field is temperature. We can measure the temperature at any point in a room. We represent the location as a 3D vector relative to some chosen origin point, and the temperature is the value at that point, the average kinetic energy of the molecules in that region. We can also talk about functions that accept vectors as input and return a vector as output. These are known as <em>vector fields</em>. In both cases, the field part refers to the fact that, over some suitable domain, the function has a value for all inputs.</p>&#13;
<p class="indent">The gradient is the derivative of a function that accepts a vector as input. Mathematically, we represent the gradient as a generalization of the idea of partial derivatives to <em>n</em> dimensions. For example, in 3D space, we can write</p>&#13;
<span epub:type="pagebreak" id="page_187"/>&#13;
<div class="imagec"><img src="Images/187equ01.jpg" alt="Image" width="124" height="161"/></div>&#13;
<p class="noindent">where the gradient operator, ▽, takes the partial derivative of <em>f</em> along each of its dimensions. The ▽ operator goes by multiple names, like <em>del</em>, <em>grad</em>, or <em>nabla</em>. We’ll use ▽ and call it <em>del</em> when we’re not simply saying “gradient operator.”</p>&#13;
<p class="indent">In general, we can write</p>&#13;
<div class="imagec" id="ch07equ07"><img src="Images/07equ07.jpg" alt="Image" width="526" height="254"/></div>&#13;
<p class="indent">Let’s parse <a href="ch07.xhtml#ch07equ07">Equation 7.7</a>. First, we have a function, <em>f</em>, that accepts a vector input, <em><strong>x</strong></em>, and returns a scalar value. To this function, we apply the gradient operator:</p>&#13;
<div class="imagec"><img src="Images/187equ02.jpg" alt="Image" width="102" height="255"/></div>&#13;
<p class="noindent">This returns a <em>vector</em> (<em><strong>y</strong></em>). The gradient operator turns the scalar output of <em>f</em> into a vector. Let’s spend some time thinking about what this means, what it’s telling us about the value of the scalar field at a given position in space. (We’ll use <em>space</em> when working with vectors, even if there’s no meaningful way to visualize the space. An analogy to 3D space is helpful but only goes so far; mathematically, the idea of space is more general.)</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_188"/>As an example, consider a function in 2D space, <em>f</em>(<em><strong>x</strong></em>) = <em>f</em>(<em>x</em>, <em>y</em>) = <em>x</em><sup>2</sup> + <em>xy</em> + <em>y</em><sup>2</sup>. The gradient of <em>f</em> is then</p>&#13;
<div class="imagec" id="ch07equ08"><img src="Images/07equ08.jpg" alt="Image" width="568" height="105"/></div>&#13;
<p class="indent">Since <em>f</em> is a scalar field, every point on the 2D plane has a function value. This is the output of <em>f</em>(<em><strong>x</strong></em>) = <em>f</em>(<em>x</em>, <em>y</em>). So, we can plot <em>f</em> in 3D to show us a surface changing with position. The gradient, however, gives us a set of equations. These equations collectively tell us the direction and magnitude of the change in the function value at a point, <em><strong>x</strong></em> = (<em>x</em>, <em>y</em>).</p>&#13;
<p class="indent">For a function of a single variable, there’s only one slope at each point. Look again at the tangent line of <a href="ch07.xhtml#ch07fig01">Figure 7-1</a>. At the point <em>x<sub>t</sub></em>, there’s only one slope. The sign of the derivative at <em>x<sub>t</sub></em> gives the direction of the slope, and the absolute value of the derivative gives the magnitude (steepness) of the slope.</p>&#13;
<p class="indent">However, once we change to more than one dimension, we have a bit of a conundrum. Instead of only one slope tangent to the function, we now have an infinite number. We can imagine a line tangent to the function at some point and that the line points in any direction we so desire. The slope of the line tells us how the function value is changing in that particular direction. We can find the value of this change from the <em>directional derivative</em>, the dot product between the gradient at the point under consideration and a unit vector in the direction we’re interested in:</p>&#13;
<p class="center"><em>D<strong><sub>u</sub></strong>f</em>(<em><strong>x</strong></em>) ≡ <em><strong>u</strong>• ▽f</em>(<em><strong>x</strong></em>) = <em><strong>u</strong><sup>T</sup></em>▽<em>f</em>(<em><strong>x</strong></em>) = ||<em><strong>u</strong></em>||||▽<em>f</em>(<em><strong>x</strong></em>)|| cos <em>θ</em></p>&#13;
<p class="noindent">where <em><strong>u</strong></em> is a unit vector in a particular direction, ▽<em>f</em>(<em><strong>x</strong></em>) is the gradient of the function at the point <em><strong>x</strong></em>, and <em>θ</em> is the angle between them. The directional derivative is maximized when cos <em>θ</em> is maximized, and this happens at <em>θ</em> = 0. Therefore, the direction of the maximum change in a function at any point is the gradient at that point.</p>&#13;
<p class="indent">As an example, let’s pick a point on the 2D plane, say <em><strong>x</strong></em> = (<em>x</em>, <em>y</em>) = (0.5, −0.4) with <em>f</em>(<em>x</em>, <em>y</em>) = <em>x</em><sup>2</sup> + <em>xy</em> + <em>y</em><sup>2</sup> from above. Then, the function value at <em><strong>x</strong></em> is <em>x</em><sup>2</sup> + <em>xy</em> + <em>y</em><sup>2</sup> = (0.5)<sup>2</sup> + (0.5)(−0.4) + (−0.4)<sup>2</sup> = 0.21, a scalar. However, the gradient at this point is</p>&#13;
<div class="imagec"><img src="Images/188equ01.jpg" alt="Image" width="449" height="51"/></div>&#13;
<p class="indent">Therefore, we now know that at the point (0.5, −0.4), the direction of the largest change in <em>f</em> is in the direction (0.6, −0.3) and has a magnitude of <img src="Images/188equ02.jpg" alt="Image" width="228" height="26"/>.</p>&#13;
<h4 class="h4" id="ch07lev2_8"><span epub:type="pagebreak" id="page_189"/>Visualizing the Gradient</h4>&#13;
<p class="noindent">Let’s make all of this less abstract. The top part of <a href="ch07.xhtml#ch07fig04">Figure 7-4</a> shows a plot of <em>f</em>(<em>x</em>, <em>y</em>) = <em>x</em><sup>2</sup> + <em>xy</em> + <em>y</em><sup>2</sup> at selected points.</p>&#13;
<div class="image" id="ch07fig04"><img src="Images/07fig04.jpg" alt="image" width="680" height="883"/></div>&#13;
<p class="figcap"><em>Figure 7-4: A plot of <span class="literal">x</span><sup>2</sup> + <span class="literal">xy</span> + <span class="literal">y</span><sup>2</sup> (top) and a 2D projection of the associated gradient field (bottom)</em></p>&#13;
<p class="indent">The code to generate this plot is straightforward:</p>&#13;
<p class="programs"><span class="codestrong1">import</span> numpy as np<br/>&#13;
x = np.linspace(-1.0,1.0,50)<br/>&#13;
<span epub:type="pagebreak" id="page_190"/>&#13;
y = np.linspace(-1.0,1.0,50)<br/>&#13;
xx = []; yy = []; zz = []<br/>&#13;
<span class="codestrong1">for</span> i <span class="codestrong1">in range</span> (50):<br/>&#13;
    <span class="codestrong1">for</span> j <span class="codestrong1">in range</span> (50):<br/>&#13;
        xx.append(x[i])<br/>&#13;
        yy.append(y[j])<br/>&#13;
        zz.append(x[i]*x[i]+x[i]*y[j]+y[j]*y[j])<br/>&#13;
x = np.array(xx)<br/>&#13;
y = np.array(yy)<br/>&#13;
z = np.array(zz)</p>&#13;
<p class="indent">Here, we explicitly loop to generate the set of scatter plot points, <span class="literal">x</span>, <span class="literal">y</span>, and <span class="literal">z</span>, to clearly show what’s happening. First, we use NumPy to generate vectors of 50 evenly spaced points [−1, 1] in <span class="literal">x</span> and <span class="literal">y</span>. Then we set up a double loop so that each <span class="literal">x</span> gets paired with each <span class="literal">y</span> to calculate the function value, <span class="literal">z</span>. Temporary lists <span class="literal">xx</span>, <span class="literal">yy</span>, and <span class="literal">zz</span> hold the triplets. Finally, we convert the lists to NumPy arrays for plotting.</p>&#13;
<p class="indent">The code to generate the scatter plot is</p>&#13;
<p class="programs"><span class="codestrong1">from</span> mpl_toolkits.mplot3d <span class="codestrong1">import</span> Axes3D<br/>&#13;
<span class="codestrong1">import</span> matplotlib.pylab as plt<br/>&#13;
fig = plt.figure()<br/>&#13;
ax = fig.add_subplot(111, projection='3d')<br/>&#13;
ax.scatter(x, y, z, marker='.', s=2, color='b')<br/>&#13;
ax.view_init(30,20)<br/>&#13;
plt.draw()<br/>&#13;
plt.show()</p>&#13;
<p class="noindent">We first load the <span class="literal">matplotlib</span> extension for 3D plotting, and then we set the subplot for a 3D projection. The plot itself is made with <span class="literal">ax.scatter</span>, while <span class="literal">ax.view_init</span> and <span class="literal">plt.draw</span> rotate the plot to give us a better view of the shape of the function before showing it.</p>&#13;
<p class="indent">In the bottom part of <a href="ch07.xhtml#ch07fig04">Figure 7-4</a>, we see a vector plot of the gradient field for <em>x</em><sup>2</sup> + <em>xy</em> + <em>y</em><sup>2</sup>. This plot shows the direction and relative magnitude of the gradient vector at a grid of points, (<em>x</em>, <em>y</em>). Recall, the gradient is a vector field, so each point on the <em>xy</em>-plane has an associated vector pointing in the direction of the greatest change in the function value. Mentally, we can see how the vector plot relates to the function plot in the top part of <a href="ch07.xhtml#ch07fig04">Figure 7-4</a>, where function values near (−1, −1) and (1, 1) are changing quickly, whereas for points near (0, 0) they’re changing slowly.</p>&#13;
<p class="indent">The code to generate the vector field plot is</p>&#13;
<p class="programs">fig = plt.figure()<br/>&#13;
ax = fig.add_subplot(111)<br/>&#13;
x = np.linspace(-1.0,1.0,20)<br/>&#13;
y = np.linspace(-1.0,1.0,20)<br/>&#13;
xv, yv = np.meshgrid(x, y, indexing='ij', sparse=False)<br/>&#13;
dx = 2*xv + yv<br/>&#13;
dy = 2*yv + xv<br/>&#13;
<span epub:type="pagebreak" id="page_191"/>&#13;
ax.quiver(xv, yv, dx, dy, color='b')<br/>&#13;
plt.axis('equal')<br/>&#13;
plt.show()</p>&#13;
<p class="indent">We first define the figure (<span class="literal">fig</span>) and subplot for 2D (no <span class="literal">projection</span> keyword). Then, we need a grid of points. Above, we looped to get this grid so we could understand what needed to be generated. Here, we use NumPy to generate the grid for us via <span class="literal">np.meshgrid</span>. Note, we pass <span class="literal">np.meshgrid</span> the same <span class="literal">x</span> and <span class="literal">y</span> vectors we had above to define the domain.</p>&#13;
<p class="indent">The next two lines are a direct implementation of the gradient of <em>f</em>, <a href="ch07.xhtml#ch07equ08">Equation 7.8</a>. These are the vectors we want to plot, with <span class="literal">dx</span> and <span class="literal">dy</span> giving us the direction and magnitude, while <span class="literal">xv</span> and <span class="literal">yv</span> are the set of input points—400 total.</p>&#13;
<p class="indent">The plot uses <span class="literal">ax.quiver</span> (since it plots arrows). The arguments are the grid of points (<span class="literal">xv</span>, <span class="literal">yv</span>) and associated <em>x</em> and <em>y</em> values of the vectors at those points (<span class="literal">dx</span>, <span class="literal">dy</span>). Finally, we ensure the axes are equal (<span class="literal">plt.axis</span>) to avoid warping the vector display, then show the plot.</p>&#13;
<p class="indent">We’ll conclude our introduction of gradients here. We’ll see them again throughout the remainder of the book, in the notation in <a href="ch08.xhtml#ch08">Chapter 8</a> and the gradient descent discussions of <a href="ch11.xhtml#ch11">Chapter 11</a>.</p>&#13;
<h3 class="h3" id="ch07lev1_6">Summary</h3>&#13;
<p class="noindent">This chapter introduced the main concepts of differential calculus. We started with the notion of slope and learned the difference between secant and tangent lines for a function of a single variable. We then formally defined the derivative as the slope of a secant line as it approaches a single point. From there, we learned the basic rules of differentiation and saw how to apply them.</p>&#13;
<p class="indent">Next, we learned about the minima and maxima of a function and how to find these points using derivatives. We then introduced partial derivatives as a way to calculate derivatives for functions of more than one variable. Partial derivatives then led us to the gradient, which turns a scalar field into a vector field and tells us the direction in which the function is changing the most. We calculated an example gradient in 2D and saw how to generate plots showing the relationship between the function and the gradient. We learned the crucial fact that the gradient of a function points in the direction of the maximum change in the function value at a point.</p>&#13;
<p class="indent">Let’s continue our exploration of the math behind deep learning and move into the world of matrix calculus.<span epub:type="pagebreak" id="page_192"/></p>&#13;
</div></body></html>