## 第一章：入门指南

![image](img/common.jpg)

编程涉及编写代码来解决问题。因此，我希望从一开始就和你一起解决问题。也就是说，我们不会一项一项地学习 Python 的概念再去解决问题，而是通过问题来指导我们需要学习的概念。

在这一章中，我们将解决两个问题：确定一行中的单词数量（类似于文字处理软件中的字数统计功能）和计算圆锥的体积。解决这些问题需要我们遍历许多 Python 概念。你可能觉得需要更多的细节才能完全理解我在这里介绍的一些内容，以及这些内容如何在 Python 程序设计中协同工作。别担心：我们将在后面的章节中回顾并详细讲解最重要的概念。

### 我们将做的事情

如引言中所述，我们将使用 Python 编程语言解决竞争性编程问题。这些竞争性编程问题可以在在线评测网站上找到。我假设你已经按照引言中的指示安装了 Python，并创建了评测账户。

对于每个问题，我们将编写一个程序来解决它。每个问题都指定了我们的程序将接受的*输入*类型，以及期望的*输出*（或结果）类型。如果我们的程序能够接受任何有效的输入并产生正确的输出，那么它就成功地解决了问题。

通常，会有数百万或数十亿种可能的输入。每种输入被称为一个*问题实例*。例如，在我们将要解决的第一个问题中，输入是一行文本，比如 `hello there` 或 `bbaabbb aa abab`。我们的任务是输出这行文本中的单词数。在编程中，最强大的理念之一是，通常一小段通用代码可以解决看似无穷无尽的多种问题实例。无论这一行有 2 个单词、3 个单词还是 50 个单词，程序都会每次都正确输出。

我们的程序将执行三个任务：

**读取输入** 我们需要确定我们正在解决的问题的具体实例，因此我们首先读取提供的输入。

**过程** 我们处理输入以确定正确的输出。

**写出输出** 解决问题后，我们产生所需的输出。

这些步骤之间的界限可能并不总是那么明确——例如，我们可能需要将一些处理和输出结合起来——但记住这三个大致的步骤将非常有帮助。

你可能每天都在使用遵循这种输入—处理—输出模型的程序。举个例子，一个计算器程序：你输入一个公式（输入），程序计算你的数字（处理），然后程序显示答案（输出）。或者考虑一个网页搜索引擎：你输入搜索查询（输入），搜索引擎确定最相关的结果（处理），然后显示它们（输出）。

将这类程序与*交互式*程序进行对比，后者将输入、处理和输出融合在一起。例如，我正在使用文本编辑器编写本书。当我输入一个字符时，编辑器会响应并将该字符添加到我的文档中。它不会等我输入完整个文档后才显示给我，而是会随着我的输入实时显示内容。在本书中，我们不会编写交互式程序。如果你在学习完本书后有兴趣编写此类程序，你会很高兴地知道，Python 完全能够胜任这项任务。

每个问题的文本都可以在这里和在线评测平台上找到。然而，文本内容可能有所不同，因为我已经为确保整本书的一致性对其进行了改写。别担心：我所写的内容传达的信息和官方问题陈述是一样的。

### Python Shell

对于书中的每个问题，我们都需要编写一个程序并将其保存在文件中。但这前提是我们知道要写什么程序！对于书中的许多问题，我们需要先学习一些新的 Python 特性，才能解决这些问题。

尝试 Python 功能的最佳方式是使用 Python shell。这是一个交互式环境，你输入一些 Python 代码并按下 ENTER 键，Python 会显示结果。一旦我们学到足够的知识来解决当前问题，我们就会停止使用 shell，而开始在文本文件中输入解决方案。

首先，在桌面上创建一个名为*programming*的文件夹。我们将使用这个文件夹来存储本书中所有的工作文件。

现在，我们将导航到*programming*文件夹并启动 Python shell。每当你想要启动 Python shell 时，请根据你的操作系统遵循这些步骤。

#### Windows

在 Windows 上，执行以下操作：

1.  按住 SHIFT 键，然后右键点击你的**programming**文件夹。

1.  从弹出的菜单中，点击**在此处打开 PowerShell 窗口**。如果没有这个选项，点击**在此处打开命令窗口**。

1.  在弹出的窗口底部，你会看到一行以大于号（`>`）结尾。这是你的操作系统*提示符*，它在等待你输入命令。在这里，你输入的是操作系统命令，而*不是*Python 代码。每输入一个命令后，记得按下 ENTER 键。

1.  你现在已经进入了*programming*文件夹。你可以输入 dir（表示*目录*）来查看当前文件夹中的内容。如果你还看不到任何文件，那是因为我们还没有创建任何文件。

1.  现在，输入 python 来启动 Python shell。

启动 Python shell 时，你应该看到类似这样的界面：

```py
Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:30:23)

[MSC v.1928 32 bit (Intel)] on win32

Type "help", "copyright", "credits" or "license" for more information.

>>>
```

这里需要注意的是，在第一行你应该看到至少为 3.6 版本的 Python。如果你的版本较旧，特别是 2.*x*版本，或者 Python 根本没有加载，请按照引言中的说明安装一个更新的 Python 版本。

在窗口底部，你会看到一个 `>>>` 的 Python 提示符。这是你输入 Python 代码的地方。切勿自己输入 `>>>` 符号。一旦编程完成，你可以按 CTRL-Z，然后按 ENTER 退出。

#### macOS

在 macOS 上，执行以下操作：

1.  打开终端。你可以通过按下 COMMAND + 空格键，输入 **terminal**，然后双击结果来打开。

1.  在弹出的窗口中，你会看到一行以美元符号（`$`）结尾。这是你的操作系统 *提示符*，它在等待你输入命令。你在这里输入的是操作系统命令，而不是 Python 代码。每输入完一条命令后，一定要按下 ENTER 键。

1.  你可以输入 ls 命令来获取当前文件夹中的文件列表。你的 *桌面* 应该会出现在列表中。

1.  输入 cd Desktop 进入你的 *桌面* 文件夹。cd 命令表示 *更改目录*；*目录* 是文件夹的另一种说法。

1.  输入 cd programming 来进入你的 *编程* 文件夹。

1.  现在，输入 python3 来启动 Python Shell。（你也可以尝试输入 `python`，不带 `3`，但那可能会启动旧版本的 Python 2。Python 2 不适合本书的学习。）

当你启动 Python Shell 时，你应该看到类似这样的内容：

```py
Python 3.9.2 (default, Mar 15 2021, 17:23:44)

[Clang 11.0.0 (clang-1100.0.33.17)] on darwin

Type "help", "copyright", "credits" or "license" for more information.

>>>
```

这里重要的是你看到第一行显示的 Python 版本至少为 3.6。如果你的版本较旧，尤其是 2.*x*，或者 Python 根本没有加载，请根据引言中的说明安装最新版本的 Python。

在窗口底部，你会看到一个 `>>>` 的 Python 提示符。这是你输入 Python 代码的地方。切勿自己输入 `>>>` 符号。一旦编程完成，你可以按 CTRL-D 来退出。

#### Linux

在 Linux 上，执行以下操作：

1.  右键点击你的 *编程* 文件夹。

1.  在弹出的菜单中，点击 *在终端中打开*。（如果你更习惯那样，也可以直接打开终端并进入你的 *编程* 文件夹。）

1.  在弹出的窗口底部，你会看到以美元符号（`$`）结尾的一行。这是你的操作系统 *提示符*，它在等待你输入命令。你在这里输入的是操作系统命令，而不是 Python 代码。每输入完一条命令后，一定要按下 ENTER 键。

1.  你现在位于你的 *编程* 文件夹内。你可以输入 `ls` 来查看文件夹中的内容。如果你什么都没看到，那是因为我们还没有创建任何文件。

1.  现在，输入 python3 来启动 Python Shell。（你也可以尝试输入 `python`，不带 `3`，但那可能会启动旧版本的 Python 2。Python 2 不适合本书的学习。）

当你启动 Python Shell 时，你应该看到类似这样的内容：

```py
Python 3.9.2 (default, Feb 20 2021, 20:57:50)

[GCC 7.5.0] on linux

Type "help", "copyright", "credits" or "license" for more information.

>>>
```

这里重要的是你看到第一行显示的 Python 版本至少为 3.6。如果你的版本较旧，尤其是 2.*x*，或者 Python 根本没有加载，请根据引言中的说明安装最新版本的 Python。

在这个窗口的底部，你会看到一个`>>>`的 Python 提示符。这是你输入 Python 代码的地方。请不要自己输入`>>>`符号。编程完成后，你可以按 CTRL-D 退出。

### 问题 #1：单词计数

现在是时候解决我们的第一个问题了！我们将使用 Python 编写一个小型的单词计数程序。我们将学习如何从用户获取输入，处理输入以解决问题，并输出结果。我们还将学习如何在程序中操作文本和数字，利用 Python 内置操作，并在解决问题的过程中存储中间结果。

这是 DMOJ 问题`dmopc15c7p2`。

#### 挑战

计算提供的单词数。对于这个问题，*单词*是任何由小写字母组成的序列。例如，`hello`是一个单词，但像`bbaabbb`这样的非英语“单词”也是有效的。

#### 输入

输入是一行文本，由小写字母和空格组成。每对单词之间有且只有一个空格，且第一个单词之前和最后一个单词之后没有空格。

每行的最大长度为 80 个字符。

#### 输出

输出输入行中的单词数量。

### 字符串

*值*是 Python 程序的基本构建块。每个值都有一个*类型*，类型决定了可以对该值执行的操作。在词频统计问题中，我们处理的是一行文本。文本在 Python 中作为字符串值存储，因此我们需要了解字符串。为了解决这个问题，我们输出文本中的单词数量，因此我们还需要了解数值类型。让我们从字符串开始。

#### 字符串表示

*字符串*是 Python 类型，用于存储和操作文本。要写一个字符串值，我们将其字符放在单引号之间。在 Python shell 中跟随操作：

```py
>>> 'hello'

'hello'

>>> 'a bunch of words'

'a bunch of words'
```

Python shell 会回显我输入的每个字符串。

当我们的字符串包含一个单引号作为字符时会发生什么？

```py
>>> 'don't say that'

  File "<stdin>", line 1

    'don't say that'

         ^

SyntaxError: invalid syntax
```

单引号在单词`don't`中结束了字符串。因此，剩下的部分`t say that'`是无意义的，这就导致了语法错误。*语法错误*意味着我们违反了 Python 的规则，写出了无效的 Python 代码。

为了修正这个问题，我们可以利用双引号也可以用来定界字符串这一事实：

```py
>>> "don't say that"

"don't say that"
```

除非字符串中包含单引号，否则我在本书中不会使用双引号。

#### 字符串操作符

我们可以使用字符串来保存我们想要统计单词的文本。要计算单词数——或者对字符串做其他操作——我们需要学习如何使用字符串。

字符串有丰富的操作可供我们执行。其中一些操作符在其操作数之间使用特殊符号。例如，`+`操作符用于字符串连接：

```py
>>> 'hello' + 'there'

'hellothere'
```

哎呀——我们需要在这两个单词之间加个空格。让我们在第一个字符串的末尾加一个空格：

```py
>>> 'hello ' + 'there'

'hello there'
```

还有`*`操作符，用于将字符串复制指定次数：

```py
>>> '-' * 30

'------------------------------'
```

那个`30`是一个整数值。稍后我会详细讲解整数。

**概念检查**

以下代码的输出是什么？

```py
>>> '' * 3
```

A. `''''''`

B. `''`

C. 这段代码会产生语法错误（无效的 Python 代码）

答案：B. `''`是空字符串——一个零字符的字符串。重复三次空字符串仍然是空字符串！

#### 字符串方法

一个*方法*是特定类型值的操作。字符串有许多方法。例如，有一个叫做`upper`的方法，它可以生成一个字符串的大写版本：

```py
>>> 'hello'.upper()

'HELLO'
```

我们从一个方法得到的信息被称为该方法的*返回值*。例如，在之前的示例中，我们可以说`upper`返回了字符串`'HELLO'`。

对一个值执行方法称为*调用*该方法。调用方法时需要在值和方法名之间放置*点操作符*（`.`）。方法名后还需要加上圆括号。对于一些方法，我们可以不传递任何参数，就像调用`upper`一样。

对于其他方法，我们可以选择性地在其中包含信息。还有一些方法需要信息，且没有信息将无法正常工作。当我们调用一个方法时所包含的信息被称为该方法的*参数*。

例如，字符串有一个`strip`方法。如果不带参数调用，`strip`会去掉字符串的所有前导和尾随空格：

```py
>>> '   abc'.strip()

'abc'

>>> '   abc       '.strip()

'abc'

>>> 'abc'.strip()

'abc'
```

但我们也可以用一个字符串作为参数来调用它。如果这样做，那个参数决定了从字符串的开始和结尾去除哪些字符：

```py
>>> 'abc'.strip('a')

'bc'

>>> 'abca'.strip('a')

'bc'

>>> 'abca'.strip('ac')

'b'
```

让我们再讨论一个字符串方法：`count`。我们传递给它一个字符串参数，它会告诉我们该参数在字符串中出现了多少次：

```py
>>> 'abc'.count('a')

1

>>> 'abc'.count('q')

0

 >>> 'aaabcaa'.count('a')

5

>>> 'aaabcaa'.count('ab')

1
```

如果参数的出现是重叠的，只有第一个算数：

```py
>>> 'ababa'.count('aba')

1
```

与我之前描述的其他方法不同，`count`对我们的单词计数问题直接有用。

想象一个字符串，比如`'this is a string with a few words'`。注意到每个单词后面都有一个空格。事实上，如果你需要手动计算单词的数量，你可能会利用空格来判断每个单词的结束位置。如果我们计算字符串中的空格数量会怎样呢？为此，我们可以将一个仅包含一个空格字符的字符串传递给`count`。它看起来是这样的：

```py
>>> 'this is a string with a few words'.count(' ')

7
```

我们得到一个值`7`。这不是准确的单词数量——字符串有八个单词——但我们接近了。为什么我们得到的是`7`而不是`8`呢？

这是因为每个单词后面都有一个空格，除了最后一个单词。因此，计算空格的数量无法考虑最后一个单词。为了解决这个问题，我们需要学习如何处理数字。

### 整数和浮动点数

一个*表达式*由值和操作符组成。接下来我们将看到如何写出数字值并将它们与操作符结合。

有两种不同的 Python 类型代表数字：整数（没有小数部分）和浮动点数（有小数部分）。

我们将整数值写成没有小数点的数字。这里有一些例子：

```py
>>> 30

30

>>> 7

7

>>> 1000000

1000000

>>> -9

-9
```

单独的一个值是最简单的表达式类型。

熟悉的数学运算符可以作用于整数。我们有 `+` 用于加法，`-` 用于减法，`*` 用于乘法。我们可以使用这些运算符来编写更复杂的表达式。

```py
>>> 8 + 10

18

>>> 8 - 10

-2

>>> 8 * 10

80
```

注意运算符周围的空格。虽然 `8+10` 和 `8 + 10` 对 Python 来说是一样的，但后者使得表达式对我们人类更易读。

Python 有两个除法运算符，而不是一个！`//` 运算符执行整数除法，会丢弃任何余数并将结果向下舍入：

```py
>>> 8 // 2

4

>>> 9 // 5

1

>>> -9 // 5

-2
```

如果你想得到除法的余数，使用模运算符 `%`。例如，将 8 除以 2 没有余数：

```py
>>> 8 % 2

0
```

将 8 除以 3 会剩余 2：

```py
>>> 8 % 3

2
```

`/` 运算符与 `//` 不同，它不会进行任何四舍五入：

```py
>>> 8 / 2

4.0

>>> 9 / 5

1.8

>>> -9 / 5

-1.8
```

这些结果值不是整数！它们有一个小数点，并属于另一种 Python 类型，称为 *浮点数*（用于“浮动小数点数”）。你可以通过包含小数点来编写浮点值：

```py
>>> 12.5 * 2

25.0
```

我们现在先集中讨论整数，稍后在本章解决圆锥体体积时再回到浮点数的内容。

当我们在一个表达式中使用多个运算符时，Python 使用优先级规则来确定运算符应用的顺序。每个运算符都有一个优先级。就像在纸面上计算数学表达式一样，Python 会先执行乘法和除法（优先级更高），然后才执行加法和减法（优先级较低）：

```py
>>> 50 + 10 * 2

70
```

再次和纸面上一样，括号内的操作具有最高的优先级。我们可以利用这一点来强制 Python 按照我们期望的顺序执行操作：

```py
>>> (50 + 10) * 2

120
```

程序员经常在不需要的情况下也添加括号。这是因为 Python 有很多运算符，正如我们将看到的那样，追踪它们的优先级容易出错，而且这通常不是程序员做的事。

如果你在想整数值和浮点值是否像字符串一样有方法，那答案是有的！但是它们并不太有用。例如，有一个方法可以告诉我们一个整数占用了多少计算机内存。整数越大，占用的内存就越多：

```py
>>> (5).bit_length()

3

>>> (100).bit_length()

7

>>> (99999).bit_length()

17
```

我们需要在整数周围加上括号；否则，点运算符会与小数点混淆，从而导致语法错误。

#### 变量

我们现在知道如何编写字符串和数值类型的值。我们也会发现能够存储它们以便稍后访问是非常有用的。在词频统计中，将一行单词存储在某个地方，然后统计单词数是非常方便的。

#### 赋值语句

*变量* 是一个引用值的名称。每当我们稍后使用变量的名称时，它会被替换成该变量所引用的值。为了让一个变量引用一个值，我们使用 *赋值语句*。赋值语句由一个变量、一个等号（`=`）和一个表达式组成。Python 会计算表达式并使变量引用结果。以下是一个赋值语句的例子：

```py
>>> dollars = 250
```

现在，每当我们使用`dollars`时，它就被替换为`250`：

```py
>>> dollars

250

>>> dollars + 10

260

>>> dollars

250
```

一个变量一次只能指向一个值。一旦我们用赋值语句让一个变量指向另一个值，它就不再指向旧的值：

```py
>>> dollars = 250

>>> dollars

250

>>> dollars = 300

>>> dollars

300
```

我们可以有任意多个变量。大型程序通常使用成百上千个变量。这是一个使用两个变量的例子：

```py
>>> purchase_price1 = 58

>>> purchase_price2 = 9

>>> purchase_price1 + purchase_price2

67
```

注意，我选择的变量名有助于表达它们所存储的内容。例如，这两个变量与两笔购买的价格有关。如果使用变量名`p1`和`p2`会更容易输入，但过几天我们可能就会忘记这些名字的含义了！

我们也可以让变量指向字符串：

```py
>>> start = 'Monday'

>>> end = 'Friday'

>>> start

'Monday'

>>> end

'Friday'
```

就像指代数字的变量一样，我们可以在更大的表达式中使用这些变量：

```py
>>> start + '-' + end

'Monday-Friday'
```

Python 的变量名应该以小写字母开头，之后可以包含其他字母、下划线分隔单词，以及数字。

#### 改变变量值

假设我们有一个变量`dollars`，它表示值`250`：

```py
>>> dollars = 250
```

现在我们想增加值，使得`dollars`表示 251。这样做是行不通的：

```py
>>> dollars + 1

251
```

结果是 251，但该值已经消失，没有存储在任何地方：

```py
>>> dollars

250
```

我们需要的是一个赋值语句，它捕获`dollars + 1`的结果：

```py
>>> dollars = dollars + 1

>>> dollars

251

>>> dollars = dollars + 1

>>> dollars

252
```

学习者常常把赋值符号`=`误认为是等号。但不要这样做！赋值语句是一个命令，用来让变量指向一个表达式的值，而不是声称两个实体相等。

**概念检查**

以下代码执行后，`y`的值是多少？

```py
>>> x = 37

>>> y = x + 2

>>> x = 20
```

A. `39`

B. `22`

C. `35`

D. `20`

E. `18`

答案：A. 只有一个对`y`的赋值操作，它让`y`指向值`39`。`x = 20`赋值语句改变了`x`指向的值，从`37`变为`20`，但这对`y`指向的值没有影响。

### 使用变量计数单词

让我们回顾一下在解决单词计数问题上取得的进展：

+   我们已经了解了字符串，并且可以使用字符串来存储一行文字。

+   我们已经了解了字符串`count`方法，可以用它来计算文字行中空格的数量。这给我们一个比所需输出值少 1 的结果。

+   我们已经了解了整数，我们可以使用其`+`运算符将`1`加到一个数字上。

+   我们了解了变量和赋值语句，它们帮助我们保存值，以便我们不会丢失它们。

将所有这些内容结合起来，我们可以让一个变量指向一个字符串，然后计算单词的数量：

```py
>>> line = 'this is a string with a few words'

>>> total_words = line.count(' ') + 1

>>> total_words

8
```

`line`和`total_words`这两个变量在这里不是必须的；我们可以不用它们来实现：

```py
>>> 'this is a string with a few words'.count(' ') + 1

8
```

但是使用变量来捕捉中间结果是保持代码可读性的好习惯。一旦我们的程序超过几行，变量将变得不可或缺。

### 读取输入

我们编写的代码存在一个问题，那就是它只能在我们输入的特定字符串上工作。它告诉我们字符串 `'this is a string with a few words'` 中有八个单词，但它只能做这些。如果我们想知道另一个字符串中有多少个单词，我们就得把当前字符串替换成新的字符串。然而，要解决单词计数问题，我们需要让程序能够处理任何作为输入提供的*字符串*。

为了读取一行输入，我们使用 `input` 函数。*函数*类似于方法：我们调用它，可能会传递一些参数，它会返回一个值给我们。方法和函数之间的一个区别是，函数不使用点操作符。所有传递给函数的信息都是通过参数传递的。

这是一个调用 `input` 函数并输入内容的示例——在这种情况下，输入的内容是 `testing`：

```py
 >>> input()

testing

'testing'
```

当你输入 `input()` 并按下 ENTER 键时，你不会看到 `>>>` 提示符。相反，Python 会等待你在键盘上输入内容并按下 ENTER 键。然后，`input` 函数返回你输入的字符串。像往常一样，如果我们没有将这个字符串保存到任何地方，那么它就会丢失。我们可以使用赋值语句来保存我们输入的内容：

```py
>>> result = input()

testing

>>> result

'testing'

>>> result.upper()

'TESTING'
```

注意到在最后一行，我对 `input` 返回的值使用了 `upper` 方法。这是允许的，因为 `input` 返回的是一个字符串，而 `upper` 是字符串方法。

### 输出内容

你已经看到，在 Python shell 中输入表达式会导致其值被显示：

```py
>>> 'abc'

'abc'

>>> 'abc'.upper()

 'ABC'

>>> 45 + 9

54
```

这只是 Python shell 提供的一种便利。它假设如果你输入一个表达式，那么你可能想看到它的值。但在 Python 程序外运行时，这种便利就不复存在了。相反，当我们想输出内容时，我们必须显式地使用 `print` 函数。`print` 函数在 shell 中也能工作：

```py
>>> print('abc')

abc

>>> print('abc'.upper())

ABC

>>> print(45 + 9)

54
```

注意，`print` 输出的字符串没有引号。这是好的——我们可能并不希望在与程序用户的交互中包含引号！

`print` 的一个优点是你可以提供任意多个参数，它们会用空格分开一起输出：

```py
>>> print('abc', 45 + 9)

abc 54
```

### 解决问题：一个完整的 Python 程序

我们现在准备通过编写一个完整的 Python 程序来解决单词计数问题。退出 Python shell，你将回到操作系统的命令提示符。

#### 启动文本编辑器

我们将使用文本编辑器来编写代码。根据你的操作系统，按照步骤操作。

##### Windows

在 Windows 上，我们将使用 Notepad，一个简单的文本编辑器。在操作系统的命令提示符下，如果你还没有在 *编程* 文件夹中，请导航到该文件夹。然后输入 `notepad word_count.py` 并按 ENTER 键。由于 *word_count.py* 文件不存在，Notepad 会问你是否希望创建一个新的 *word_count.py* 文件。点击 **是**，然后你就可以开始输入你的 Python 程序了。

##### macOS

在 macOS 上，你可以使用任何你喜欢的文本编辑器。你可能已经安装的一个编辑器是 TextEdit。在操作系统命令提示符下，如果你还不在*编程*文件夹中，请导航到该文件夹。然后依次输入以下两个命令，并在每个命令后按下 ENTER 键：

```py
$ touch word_count.py

$ open -a TextEdit word_count.py
```

`touch`命令会创建一个空文件，以便你的文本编辑器可以打开它。现在，你可以开始编写 Python 程序了。

##### Linux

在 Linux 上，你可以使用任何你喜欢的文本编辑器。你可能已经安装的一个编辑器是 gedit。在操作系统命令提示符下，如果你还不在*编程*文件夹中，请导航到该文件夹。然后输入`gedit word_count.py`并按 ENTER 键。现在你可以开始编写 Python 程序了。

#### 程序

打开文本编辑器后，你可以开始编写我们的 Python 程序代码。代码位于列表 1-1。

```py
❶ line = input()

❷ total_words = line.count(' ') + 1

❸ print(total_words)
```

*列表 1-1：解决单词计数问题*

在输入代码时，不要输入❶、❷或❸。这些符号是为了帮助我们逐步讲解代码，它们不是代码的一部分。

我们首先从输入中获取一行文本并将其赋值给变量❶。这将给我们一个字符串，接着我们可以使用`count`方法。在计算空格数量时，我们加 1 以考虑字符串中的最后一个单词，并使用变量`total_words`来引用这个结果❷。最后一步是输出`total_words`所引用的值❸。

在完成代码输入后，记得保存文件。

#### 运行程序

要运行程序，我们将在操作系统命令提示符下使用`python`命令。如前所述，输入`python`本身会启动 Python 交互式环境，但这次我们不想这样做。相反，我们希望告诉 Python 去运行*word_count.py*中的程序。为此，导航到你的*编程*文件夹，输入`python word_count.py`。在本书中，如果需要，请使用`python3`命令代替`python`命令。

你的程序现在在`input`提示符下等待你输入内容。输入几个单词，按下 ENTER，你应该看到程序正确运行。例如，输入以下内容：

```py
this is my first python program
```

你应该看到程序输出`6`。

如果你看到 Python 错误，请仔细检查代码，确保输入的完全正确。Python 要求精确输入，哪怕是缺少一个括号或单引号也会导致错误。

如果程序运行需要一些时间，不要感到沮丧。第一次让程序运行可能需要很多工作。我们必须能够将程序输入到文件中，调用 Python 来运行该程序，并修复因程序错误而产生的任何错误。但不管程序有多复杂，运行程序的过程都不会改变，因此你在这里花费的时间会非常值得，特别是在你完成本书后续章节时。

#### 提交给评测系统

恭喜！希望在你的电脑上运行第一个 Python 程序让你感到满意。但我们如何知道这个程序是正确的呢？它能处理所有可能的字符串吗？我们可以在更多的字符串上测试它，但我们获得更多信心的方式是将它提交给在线评测系统。评测系统会自动运行多个测试，告诉我们是否通过了测试，或者是否有问题。

访问 *[`dmoj.ca/`](https://dmoj.ca/)* 并登录。（如果你没有 DMOJ 账户，请根据介绍中的说明创建一个。）点击**问题**，搜索单词计数问题代码 `dmopc15c7p2`。点击搜索结果加载问题—它叫做 "Not a Wall of Text" 而不是 "Word Count"。

然后你应该看到问题的文本，按照问题作者的写法。点击**提交解答**，并将我们的代码粘贴到文本区域。确保选择 Python 3 作为编程语言。最后，点击**提交**按钮。

DMOJ 会对我们的代码进行测试，并展示结果。对于每个测试用例，你将看到一个状态码。*AC* 代表 *通过*，是你希望在每个测试用例上看到的状态。其他状态码包括 *WA*（*错误答案*）和 *TLE*（*超时*）。如果你看到其中之一，检查一下你粘贴的代码，确保它与文本编辑器中的代码完全一致。

假设所有测试用例都被接受，我们应该看到我们的分数是 100/100，并且我们已经为我们的工作赚取了 3 分。

对于每个问题，我们将遵循解决单词计数问题时使用的方法。首先，我们将探索使用 Python shell，根据需要学习新的 Python 特性。然后，我们将编写一个解决问题的程序。在电脑上通过输入我们自己的测试用例来测试这个程序。最后，我们将代码提交给评测系统。如果有任何测试用例失败，我们会再次检查代码并修复问题。

### 问题 #2：圆锥体积

在单词计数问题中，我们需要从输入中读取一个字符串。在这个问题中，我们需要从输入中读取整数。这样做需要额外的步骤，将字符串转换为整数。我们还将学习更多关于如何在 Python 中进行数学计算的内容。

这是 DMOJ 问题 `dmopc14c5p1`。

#### 挑战

计算直圆锥的体积。

#### 输入

输入包括两行文本。第一行包含整数 *r*，表示圆锥的半径。第二行包含整数 *h*，表示圆锥的高度。*r* 和 *h* 都在 1 到 100 之间。（也就是说，*r* 和 *h* 的最小值是 1，最大值是 100。）

#### 输出

输出直圆锥的体积，已知半径 *r* 和高度 *h*。计算体积的公式是 (*πr*²*h*)/3。

### 更多 Python 数学运算

假设我们有 `r` 和 `h` 两个变量，分别代表半径和高度：

```py
>>> r = 4

>>> h = 6
```

现在我们想要计算(*πr*²*h*)/3。将半径`4`和高度`6`代入，公式变为(*π* * 4² * 6)/3。使用`3.14159`作为*π*的值，计算器给出的结果是`100.531`。我们该如何在 Python 中实现这个呢？

#### 访问 Pi

为了访问*π*的值，我们将使用一个合适的变量。这里是一个赋值语句，将`PI`的值设定为具有高精度的值：

```py
PI = 3.141592653589793
```

这更像是一个*常量*而不是变量，因为我们在代码中永远不希望更改`PI`的值。按照 Python 的惯例，像这种变量使用大写字母，就像我在这里做的那样。

#### 指数运算

回顾我们的公式，(*πr*²*h*)/3，我们还没有讨论的是如何进行*r*²的运算。由于*r*²等同于*r* * *r*，我们可以使用乘法而不是指数运算。

```py
>>> r

4

>>> r * r

16
```

但直接使用指数运算更为直观。我们总是希望编写尽可能清晰的代码。此外，总有一天你可能需要计算更大的指数，在那时，重复的乘法会变得越来越难以处理。Python 的指数运算符是`**`：

```py
>>> r ** 2

16
```

这是完整的公式：

```py
>>> (PI * r ** 2 * h) / 3

100.53096491487338
```

太棒了——这接近我们预期的`100.531`结果！

请注意，我们在这里得到的是一个浮点数。正如我们在本章的“整数与浮点数”部分讨论过的，`/`除法运算符会产生浮点结果。

### 字符串与整数的转换

最终，我们需要将半径和高度作为输入来读取。然后，我们将使用这些值来计算体积。我们来试试看：

```py
>>> r = input()

4

>>> h = input()

6
```

`input`函数始终返回一个字符串，即使用户输入的是整数：

```py
>>> r

'4'

>>> h

'6'
```

单引号确认了这些值是字符串。字符串不能用于进行数学计算。如果我们尝试，程序会报错：

```py
>>> (PI * r ** 2 * h) / 3

Traceback (most recent call last):

  File "<stdin>", line 1, in <module>

TypeError: unsupported operand type(s) for ** or pow(): 'str' and 'int'
```

当我们使用错误类型的值时，会生成`TypeError`。Python 拒绝我们在字符串`r`和整数`2`之间使用`**`运算符。`**`运算符是纯数学运算，不能用于字符串。

为了将字符串转换为整数，我们可以使用 Python 的`int`函数：

```py
>>> r

'4'

>>> h

'6'

>>> r = int(r)

>>> h = int(h)

>>> r

4

>>> h

6
```

现在我们可以再次将这些值代入公式：

```py
>>> (PI * r ** 2 * h) / 3

100.53096491487338
```

每当你有一个字符串，其中的字符表示一个整数时，你可以使用`int`函数将其转换为整数类型的值。它可以处理前导和尾随空格，但无法处理非数字字符：

```py
>>> int('  12  ')

12

>>> int('12x')

Traceback (most recent call last):

  File "<stdin>", line 1, in <module>

ValueError: invalid literal for int() with base 10: '12x'
```

当将`input`返回的字符串转换为整数时，我们可以分两步进行，首先将`input`的返回值赋给一个变量，然后将该值转换为整数：

```py
>>> num = input()

82

>>> num = int(num)

>>> num

82
```

或者我们可以将`input`和`int`函数结合使用：

```py
>>> num = int(input())

82

>>> num

82
```

这里，传递给`int`的参数是`input`返回的字符串。`int`函数将该字符串转换并返回一个整数。

如果我们需要进行反向转换，即从整数转换为字符串，我们可以使用`str`函数：

```py
>>> num = 82

>>> 'my number is ' + num

Traceback (most recent call last):

  File "<stdin>", line 1, in <module>

TypeError: can only concatenate str (not "int") to str

>>> str(num)

'82'

>>> 'my number is ' + str(num)

'my number is 82'
```

我们不能将字符串和整数连接在一起。`str`函数将`82`转换为字符串`'82'`，使其可以用于字符串拼接。

### 解决问题

我们准备解决圆锥体积问题。创建一个名为 *cone_volume.py* 的文本文件，并输入列表 1-2 中的代码。

```py
❶ PI = 3.141592653589793

❷ radius = int(input())

❸ height = int(input())

❹ volume = (PI * radius ** 2 * height) / 3

❺ print(volume)
```

*列表 1-2：解决圆锥体积问题*

我在代码中加入了空行，以将其分成逻辑块。Python 会忽略这些空行，但这些空行可以让我们更容易阅读和组织代码。

请注意，我使用了描述性的变量名：`radius` 代替 `r`，`height` 代替 `h`，以及 `volume`。单字母变量名在数学公式中是常见的，但在编写代码时，我们可以使用更具信息性的变量名。

我们首先创建一个名为 `PI` 的变量，表示 pi 的近似值 ❶。然后我们从输入中读取半径 ❷ 和高度 ❸，将两者从字符串转换为整数。我们使用圆锥体积的公式计算体积 ❹。最后，我们输出体积 ❺。

保存你的 *cone_volume.py* 文件。

运行你的程序，输入 `python cone_volume.py`，然后输入半径和高度的值。使用计算器验证你的程序是否输出正确结果！

如果你输入无效的半径或高度会发生什么？例如，运行你的程序并输入以下内容：

```py
xyz
```

你应该会看到一个错误：

```py
Traceback (most recent call last):

  File "cone_volume.py", line 3, in <module>

    radius = int(input())

ValueError: invalid literal for int() with base 10: 'xyz'
```

这肯定一点也不友好。但为了学习编程，我们不需要担心这个问题。裁判的所有测试用例都符合问题的输入规范，因此我们不需要担心如何处理无效输入。

说到裁判，DMOJ 应该给我们三分，因为我们已经完成了这个问题的正确代码。赶紧提交你的作业吧！

### 总结

我们开始了！我们通过编写 Python 代码解决了前两个问题。我们学习了编程的基础，包括值、类型、字符串、整数、方法、变量、赋值语句以及输入和输出。

一旦你熟悉了这些内容——也许通过做一些以下的练习——我们就可以继续学习第二章。在那里，我们将学习如何让程序做出决策。我们将不再编写从上到下始终执行的程序。它们将更加灵活，根据特定问题的实例进行调整。

### 章节练习

每一章的结尾都会有一些练习题供你尝试。我鼓励你尽可能多地完成这些练习。

有些练习可能需要很长时间。你可能会因为反复出现 Python 错误而感到沮丧。就像任何值得学习的技能一样，需要有针对性的练习。当你开始做一个练习时，我建议先手动解决几个例子。这样你就能知道问题在问什么，以及你的程序应该做什么。否则，你可能会在没有计划的情况下编写代码，一边组织思路一边编写程序。

如果你的代码不工作，问问自己：你到底想要的行为是什么？哪些代码行可能是你遇到的错误的罪魁祸首？你是否可以尝试另一种，也许更简单的方法？

我已经在书籍网站上提供了练习的解答 (*[`nostarch.com/learn-code-solving-problems/`](https://nostarch.com/learn-code-solving-problems/)*)。但在你诚实尝试完所选的练习之前，不要偷看那些解答。尝试一次，两次，或者三次。如果你查看了解答，并了解了一个可能的解决方案，休息一下，然后从头开始自己尝试解决。解决问题的方式通常不止一种。如果你的解法做对了事情，但与我的解法不同，这并不意味着我们其中有一个是错的。相反，这为你提供了一个机会，可以将你的代码与我的代码进行对比，也许你能在过程中学习到不同的技巧。

1.  DMOJ 题目`wc16c1j1`，一个恐怖的季节

1.  DMOJ 题目`wc15c2j1`，新的希望

1.  DMOJ 题目`ccc13j1`，排队等待

1.  DMOJ 题目`wc17c1j2`，天气怎么样？（注意转换方向！）

1.  DMOJ 题目`wc18c3j1`，诚实的一天工作（提示：你如何确定瓶盖的数量以及这些瓶盖所需的总油漆量？）

### 注意事项

字数统计最初来自 DMOPC ’15 年 4 月比赛。圆锥体体积最初来自 DMOPC ’14 年 3 月比赛。
