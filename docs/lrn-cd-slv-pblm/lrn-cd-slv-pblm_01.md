## 1

开始

![image](img/common.jpg)

编程就是编写代码来解决问题。因此，我希望从一开始就和你一起解决问题。也就是说，我们不是一个个地学习 Python 的概念，然后再解决问题，而是通过问题来决定我们需要学习的概念。

在这一章中，我们将解决两个问题：确定一行中的单词数（类似于文字处理软件中的字数统计功能）和计算圆锥体的体积。解决这些问题需要我们了解一些 Python 的概念。你可能会觉得要完全理解我在这里介绍的某些内容以及它们如何在 Python 程序设计中结合起来，你需要更多的细节。别担心：我们将在后续章节中重新访问并详细阐述最重要的概念。

### 我们将做什么

如介绍中所述，我们将使用 Python 编程语言来解决竞赛编程问题。每个竞赛编程问题都可以在一个在线评测网站上找到。我假设你已经按照介绍中的说明安装了 Python，并且创建了评测平台账号。

对于每个问题，我们将编写一个程序来解决它。每个问题都会指定程序将接收到的*输入*类型和期望的*输出*（或结果）类型。如果我们的程序能接受任何有效输入并产生正确的输出，那么它就能正确解决该问题。

一般来说，可能有数百万或数十亿个可能的输入。每个这样的输入被称为*问题实例*。例如，在我们要解决的第一个问题中，输入是一个文本行，如 hello there 或 bbaabbb aa abab。我们的任务是输出该行中的单词数。编程中最强大的一个概念就是，通常少量通用代码可以解决看似无尽的多个问题实例。无论这行文字有 2 个单词、3 个单词，还是 50 个单词，都无关紧要。我们的程序每次都能正确处理。

我们的程序将执行三个任务：

**读取输入** 我们需要确定我们要解决的问题的具体实例，因此我们首先读取提供的输入。

**处理** 我们处理输入，确定正确的输出。

**输出结果** 解决问题后，我们生成所需的输出。

这些步骤之间的界限可能并不总是很清晰——例如，我们可能需要在生成输出的同时进行一些处理——但牢记这三个大致的步骤会很有帮助。

你可能每天都在使用遵循这种输入-处理-输出模型的程序。考虑一下计算器程序：你输入一个公式（输入），程序进行计算（处理），然后显示答案（输出）。或者考虑一下网页搜索引擎：你输入一个搜索查询（输入），搜索引擎确定最相关的结果（处理），然后显示它们（输出）。

将这些程序与*交互式*程序进行对比，后者将输入、处理和输出结合在一起。例如，我正在使用文本编辑器编写这本书。当我输入一个字符时，编辑器会响应并将该字符添加到文档中。它不会等我输入完整个文档才显示给我，而是随着我的输入实时显示。我们在本书中不会编写交互式程序。如果你在学习完本书后有兴趣编写此类程序，你会很高兴地得知 Python 完全能够胜任这项任务。

每个问题的文本内容都可以在这里和在线评测系统中找到。然而，文本内容并不完全一致，因为我已根据书中的一致性要求重新编写了内容。别担心：我写的内容传达了与官方问题陈述相同的信息。

### Python Shell

对于书中的每个问题，我们都想编写一个程序并将其保存在文件中。但这要求我们知道该编写什么程序！对于书中的许多问题，我们需要学习一些新的 Python 特性，才能解决问题。

实验 Python 特性最好的方式是使用 Python Shell。它是一个交互式环境，你输入一些 Python 代码并按下 ENTER，Python 会显示结果。当我们学到足够的知识来解决当前的问题时，我们就会停止使用 Shell，而开始将解决方案输入到文本文件中。

首先，在桌面上创建一个名为*programming*的新文件夹。我们将使用这个文件夹来存储本书中所有的工作文件。

现在，我们将进入*programming*文件夹并启动 Python Shell。根据你的操作系统，按照以下步骤操作，每当你想启动 Python Shell 时，都可以参考。

#### Windows

在 Windows 上，执行以下操作：

1.  按住 SHIFT 并右键点击你的**programming**文件夹。

1.  从出现的菜单中，点击**在此处打开 PowerShell 窗口**。如果该选项不存在，请点击**在此处打开命令窗口**。

1.  在结果窗口的底部，你会看到一行以大于号（>）结尾的内容。这是你的操作系统*提示符*，它在等待你输入命令。你在这里输入的是操作系统命令，而*不是* Python 代码。每次输入命令后，记得按下 ENTER。

1.  你现在在你的*programming*文件夹中。如果你想查看文件夹中的内容，可以输入 dir（*目录*）。你现在应该看不到任何文件，因为我们还没有创建任何文件。

1.  现在，输入 python 启动 Python Shell。

当你启动 Python Shell 时，你应该会看到类似如下的内容：

Python 3.9.2 (tags/v3.9.2:1a79785, 2021 年 2 月 19 日，13:30:23)

[MSC v.1928 32 位（Intel）] 在 win32 上

输入 "help"、"copyright"、"credits" 或 "license" 获取更多信息。

>>>

这里重要的是，你在第一行看到的 Python 版本至少是 3.6。如果你使用的是较老的版本，尤其是 2.*x*，或者如果 Python 根本无法加载，请按照引言中的说明安装一个最新版本的 Python。

在这个窗口的底部，你会看到一个>>> Python 提示符。在这里你输入 Python 代码。不要自己输入>>>符号。编程完成后，你可以按 CTRL-Z，然后按 ENTER 退出。

#### macOS

在 macOS 上，请执行以下操作：

1.  打开终端。你可以通过按 COMMAND-空格键，输入**terminal**，然后双击结果来打开。

1.  在结果窗口中，你会看到一行以美元符号（$）结尾。这是你的操作系统*提示符*，它在等待你输入命令。你在这里输入操作系统命令，*不是*Python 代码。确保每输入一条命令后按 ENTER 键。

1.  你可以输入 ls 命令来查看当前文件夹中的内容。你的*桌面*应该会列在其中。

1.  输入 cd 桌面以导航到你的*桌面*文件夹。cd 命令代表*更改目录*；*目录*是文件夹的另一种说法。

1.  输入 cd 编程以导航到你的*编程*文件夹。

1.  现在，输入 python3 启动 Python shell。（你也可以尝试输入 python，没有 3，但那可能会启动 Python 2 的旧版本。Python 2 不适合用来学习本书内容。）

当你启动 Python shell 时，你应该看到类似这样的内容：

Python 3.9.2（默认，2021 年 3 月 15 日，17:23:44）

[Clang 11.0.0 (clang-1100.0.33.17)] 在 Darwin 上

输入"help"、"copyright"、"credits"或"license"获取更多信息。

>>>

这里重要的是，你应该在第一行看到至少 3.6 版本的 Python。如果你使用的是旧版本，尤其是 2.*x*，或者如果 Python 根本没有加载，请按照介绍中的说明安装一个较新的 Python 版本。

在这个窗口的底部，你会看到一个>>> Python 提示符。在这里你输入 Python 代码。不要自己输入>>>符号。编程完成后，你可以按 CTRL-D 退出。

#### Linux

在 Linux 上，请执行以下操作：

1.  右击你的*编程*文件夹。

1.  在弹出的菜单中，点击*在终端中打开*。（如果你更习惯的话，也可以先打开终端并导航到你的*编程*文件夹。）

1.  在结果窗口的底部，你会看到一行以美元符号（$）结尾。这是你的操作系统*提示符*，它在等待你输入命令。你在这里输入操作系统命令，*不是*Python 代码。确保每输入一条命令后按 ENTER 键。

1.  你现在在你的*编程*文件夹中。如果你想查看文件夹里的内容，可以输入 ls 命令。你应该还看不见任何文件，因为我们还没有创建文件。

1.  现在，输入 python3 启动 Python shell。（你也可以尝试输入 python，没有 3，但那可能会启动 Python 2 的旧版本。Python 2 不适合用来学习本书内容。）

当你启动 Python shell 时，你应该看到类似这样的内容：

Python 3.9.2（默认，2021 年 2 月 20 日，20:57:50）

[GCC 7.5.0] 在 Linux 上

输入"help"、"copyright"、"credits"或"license"获取更多信息。

>>>

这里最重要的是你看到的 Python 版本至少是 3.6。如果你使用的是旧版本，尤其是 2.*x*，或者 Python 根本没有加载，请按照介绍中的说明安装一个最新版本的 Python。

在这个窗口的底部，你会看到一个 >>> Python 提示符。这是你输入 Python 代码的地方。切记不要自己输入 >>> 符号。一旦编程完成，你可以按 CTRL-D 退出。

### 问题 #1：单词计数

现在是时候解决第一个问题了！我们将使用 Python 编写一个简单的单词计数程序。我们将学习如何从用户那里读取输入，处理输入以解决问题，并输出结果。我们还将学习如何在程序中操作文本和数字，利用 Python 的内置操作，并在解决问题的过程中存储中间结果。

这是 DMOJ 问题 dmopc15c7p2。

#### 挑战

计算提供的单词数。对于这个问题，*单词*是任何一串小写字母。例如，hello 是一个单词，但像 bbaabbb 这样的非英语“单词”也算。

#### 输入

输入是一行文本，由小写字母和空格组成。每对单词之间正好有一个空格，且第一个单词前和最后一个单词后没有空格。

该行的最大长度为 80 个字符。

#### 输出

输出输入行中的单词数量。

### 字符串

*值*是 Python 程序的基本构建块。每个值都有一个 *类型*，而类型决定了可以对该值执行哪些操作。在单词计数问题中，我们正在处理一行文本。文本在 Python 中作为字符串值存储，所以我们需要了解字符串。为了解决问题，我们需要输出文本中的单词数量，因此我们还需要了解数值。让我们从字符串开始。

#### 字符串的表示

*字符串*是 Python 中用于存储和处理文本的类型。要写一个字符串值，我们将它的字符放在单引号之间。可以在 Python shell 中跟着操作：

>>> 'hello'

'hello'

>>> '一堆词'

'一堆词'

Python shell 会回显我输入的每个字符串。

当我们的字符串包含单引号作为其中一个字符时，会发生什么？

>>> '别这么说'

文件 "<stdin>"，第 1 行

'别这么说'

^

SyntaxError: 无效的语法

单引号在单词 don’t 中终止了字符串。剩下的部分，t say that'，因此没有意义，这就导致了语法错误。*语法错误*意味着我们违反了 Python 的规则，写出了无效的 Python 代码。

为了解决这个问题，我们可以利用双引号也可以用来界定字符串的事实：

>>> "别这么说"

"别这么说"

除非字符串中包含单引号，否则我在这本书中不会使用双引号。

#### 字符串操作符

我们可以使用一个字符串来保存我们想要计数的单词文本。要统计单词数——或者对字符串做任何其他操作——我们需要学习如何处理字符串。

字符串提供了丰富多样的操作，我们可以进行各种操作。其中一些操作在操作数之间使用特殊符号。例如，+ 运算符用于字符串连接：

>>> 'hello' + 'there'

'hellothere'

哎呀——我们需要在这两个单词之间加个空格。让我们在第一个字符串的末尾加一个空格：

>>> 'hello ' + 'there'

'hello there'

还有 * 运算符，它会将字符串复制指定的次数：

>>> '-' * 30

'------------------------------'

那个 30 是一个整数值。稍后我会详细讲解整数。

**概念检查**

以下代码的输出是什么？

>>> '' * 3

A. ''''''

B. ''

C. 这段代码会产生语法错误（无效的 Python 代码）

答案：B. '' 是空字符串——一个零字符的字符串。重复三次空字符串仍然是空字符串！

#### 字符串方法

*方法* 是特定于某种类型值的操作。字符串有大量的方法。例如，有一个名为 upper 的方法，它返回字符串的大写版本：

>>> 'hello'.upper()

'HELLO'

我们从方法中得到的结果叫做方法的 *返回值*。例如，对于之前的例子，我们可以说 upper 返回了字符串 'HELLO'。

对一个值调用方法叫做 *调用* 方法。调用方法时，我们需要在值和方法名称之间加上 *点运算符* (.)，并且方法名称后面还需要有括号。对于一些方法，我们可以保持括号为空，比如调用 upper 方法时。

对于其他方法，我们可以选择性地在其中包含信息。还有一些方法需要信息，并且没有它就无法正常工作。我们在调用方法时包含的信息被称为方法的 *参数*。

例如，字符串有一个 strip 方法。如果不带参数调用 strip，它会删除字符串的所有前导和尾随空格：

>>> '   abc'.strip()

'abc'

>>> '   abc       '.strip()

'abc'

>>> 'abc'.strip()

'abc'

但我们也可以将其与字符串作为参数一起调用。如果这样做，参数决定了从字符串的开头和结尾去除哪些字符：

>>> 'abc'.strip('a')

'bc'

>>> 'abca'.strip('a')

'bc'

>>> 'abca'.strip('ac')

'b'

让我们再谈谈一个字符串方法：count。我们传入一个字符串参数，它会告诉我们该参数在字符串中出现的次数：

>>> 'abc'.count('a')

1

>>> 'abc'.count('q')

0

>>> 'aaabcaa'.count('a')

5

>>> 'aaabcaa'.count('ab')

1

如果参数的出现重叠，那么只有第一次的出现会被计算：

>>> 'ababa'.count('aba')

1

与我之前描述的其他方法不同，count 方法对我们的字数统计问题直接有用。

想象一个字符串，比如'this is a string with a few words'。注意每个单词后面都有一个空格。事实上，如果你需要手动计算单词的数量，可能会使用空格来告诉你每个单词的结束位置。如果我们数一下字符串中的空格数量呢？为此，我们可以传入一个由单个空格字符组成的字符串来计数。它看起来是这样的：

>>> 'this is a string with a few words'.count(' ')

7

我们得到了 7 这个值。虽然这不是准确的单词数——字符串有八个单词——但我们已经接近了。为什么我们得到的是 7 而不是 8 呢？

原因在于每个单词后面都有一个空格，除了最后一个单词。因此，计数空格无法计算最后一个单词。为了解决这个问题，我们需要学习如何处理数字。

### 整数和浮点数

一个*表达式*由值和运算符组成。现在我们将看到如何编写数值并将它们与运算符结合。

Python 有两种不同的数字类型：整数（没有小数部分）和浮点数（有小数部分）。

我们将整数值写成没有小数点的数字。以下是一些例子：

>>> 30

30

>>> 7

7

>>> 1000000

1000000

>>> -9

-9

独立的值是最简单的表达式形式。

常见的数学运算符作用于整数。我们有+表示加法，-表示减法，*表示乘法。我们可以使用这些运算符编写更复杂的表达式。

>>> 8 + 10

18

>>> 8 - 10

-2

>>> 8 * 10

80

注意运算符两边的空格。虽然 8+10 和 8 + 10 在 Python 看来是一样的，但后者让我们人类更容易阅读这个表达式。

Python 有两个除法运算符，而不是一个！//运算符执行整数除法，它会舍弃余数并向下舍入结果：

>>> 8 // 2

4

>>> 9 // 5

1

>>> -9 // 5

-2

如果你想要除法的余数，可以使用取模运算符，写作%。例如，8 除以 2 没有余数：

>>> 8 % 2

0

8 除以 3 留下余数 2：

>>> 8 % 3

2

与//运算符不同，/运算符不会做任何四舍五入：

>>> 8 / 2

4.0

>>> 9 / 5

1.8

>>> -9 / 5

-1.8

这些结果值不是整数！它们有小数点，并且属于另一种 Python 类型，叫做*float*（浮点数）。你可以通过包含小数点来写浮点值：

>>> 12.5 * 2

25.0

我们现在将专注于整数，并在本章稍后的圆锥体体积问题中再回到浮点数。

当我们在一个表达式中使用多个运算符时，Python 会根据优先级规则来确定运算符应用的顺序。每个运算符都有一个优先级。就像我们在纸上计算数学表达式时一样，Python 会先进行乘法和除法（优先级高），再进行加法和减法（优先级低）：

>>> 50 + 10 * 2

70

同样的，和在纸上计算一样，括号内的操作有最高的优先级。我们可以利用这一点强制 Python 按照我们期望的顺序执行操作：

>>> (50 + 10) * 2

120

程序员经常即使在技术上不需要时也加上括号。这是因为 Python 有许多操作符，正如我们将看到的那样，跟踪它们的优先级容易出错，而程序员通常不会这么做。

如果你在想整数值和浮点值是否也有方法，就像字符串一样，它们是有的！但它们并不总是非常有用。例如，有一个方法告诉我们一个整数占用了多少计算机内存。整数越大，它所需的内存就越多：

>>> (5).bit_length()

3

>>> (100).bit_length()

7

>>> (99999).bit_length()

17

我们需要在整数周围加上括号，否则点操作符会被误认为是小数点，导致语法错误。

#### 变量

我们现在知道如何编写字符串和数字值。我们还会发现能够存储它们，以便以后访问会很有用。在“字数统计”中，能够把一行文字存储起来，然后统计单词数将非常方便。

#### 赋值语句

一个*变量*是一个表示值的名称。每当我们使用变量名称时，它会被替换为该变量所表示的值。为了使变量指向一个值，我们使用*赋值语句*。赋值语句由一个变量、一个等号（=）和一个表达式组成。Python 会评估表达式并使变量指向结果。以下是一个赋值语句的示例：

>>> dollars = 250

现在，每当我们使用 dollars 时，它都会被替换为 250：

>>> dollars

250

>>> dollars + 10

260

>>> dollars

250

一个变量一次只指向一个值。一旦我们使用赋值语句使变量指向另一个值，它就不再指向旧值：

>>> dollars = 250

>>> dollars

250

>>> dollars = 300

>>> dollars

300

我们可以有任意数量的变量。大型程序通常使用数百个变量。以下是使用两个变量的示例：

>>> purchase_price1 = 58

>>> purchase_price2 = 9

>>> purchase_price1 + purchase_price2

67

请注意，我选择的变量名称能够大致说明它们存储的内容。例如，这两个变量与两项购买的价格有关。使用 p1 和 p2 这样的变量名可能更容易输入，但几天后我们可能就会忘记这些名称代表什么！

我们也可以让变量指向字符串：

>>> start = 'Monday'

>>> end = 'Friday'

>>> 开始

'Monday'

>>> 结束

'Friday'

与指向数字的变量一样，我们也可以在更大的表达式中使用它们：

>>> start + '-' + end

'Monday-Friday'

Python 变量名应该以小写字母开头，然后可以包含额外的字母、下划线分隔单词以及数字。

#### 变量值的改变

假设我们有一个名为 dollars 的变量，它表示值 250：

>>> dollars = 250

现在我们想增加值，使 dollars 指向 251。这样做是行不通的：

>>> dollars + 1

251

结果是 251，但该值已消失，并未存储在任何地方：

>>> dollars

250

我们需要的是一个赋值语句，它捕捉到 dollars + 1 的结果：

>>> dollars = dollars + 1

>>> 美元

251

>>> dollars = dollars + 1

>>> dollars

252

学习者常常把赋值符号 = 当作等式来理解。但千万不要那样想！赋值语句是一个命令，它使得一个变量指向一个表达式的值，而不是声明两个实体相等。

**概念检查**

执行以下代码后，y 的值是多少？

>>> x = 37

>>> y = x + 2

>>> x = 20

A. 39

B. 22

C. 35

D. 20

E. 18

答案：A. y 只被赋值一次，并且它指向值 39。x = 20 的赋值语句改变了 x 的值，从 37 变为 20，但这对 y 的值没有影响。

### 使用变量计数单词

让我们回顾一下在解决单词计数问题中的进展：

+   我们了解字符串，可以使用字符串存储一行单词。

+   我们了解字符串的 count 方法，可以用它来计算一行单词中的空格数量。这样会给我们比需要的输出值少 1 的结果。

+   我们了解整数，可以使用其 + 操作符给一个数字加 1。

+   我们了解变量和赋值语句，它们帮助我们保留值，防止丢失。

把这些都放在一起，我们可以让一个变量指向一个字符串，然后计算单词的数量：

>>> line = 'this is a string with a few words'

>>> total_words = line.count(' ') + 1

>>> total_words

8

这里不需要 line 和 total_words 变量；我们可以不使用它们，直接这样做：

>>> 'this is a string with a few words'.count(' ') + 1

8

但是使用变量来捕捉中间结果是保持代码可读性的好习惯。一旦我们的程序超过几行，变量将变得不可或缺。

### 读取输入

我们写的代码的一个问题是，它只对我们输入的特定字符串有效。它告诉我们'this is a string with a few words'中有八个单词，但它只能做到这一点。如果我们想知道另一个字符串中有多少个单词，我们就必须替换当前字符串为一个新的字符串。然而，为了完成单词计数，我们需要我们的程序能够处理*任何*作为输入提供给程序的字符串。

要读取一行输入，我们使用输入函数。*函数*类似于方法：我们调用它，可能带有一些参数，然后它会返回一个值。方法和函数的区别在于，函数不使用点操作符。所有传递给函数的信息都是通过参数传递的。

这是一个调用输入函数并输入内容的示例——在这个例子中，输入的是单词 testing：

>>> input()

testing

'testing'

当你输入 input() 并按下 ENTER 时，你不会看到 >>> 提示符。相反，Python 会等待你在键盘上输入内容并按 ENTER。然后 input 函数会返回你输入的字符串。像往常一样，如果我们没有把这个字符串存储起来，它就会丢失。让我们使用赋值语句来存储我们输入的内容：

>>> result = input()

测试

>>> result

'testing'

>>> result.upper()

'TESTING'

请注意，在最后一行中，我对 input 返回的值使用了 upper 方法。之所以可以这样做，是因为 input 返回的是一个字符串，而 upper 是一个字符串方法。

### 写入输出

你已经看到，在 Python shell 中输入表达式会导致显示其值：

>>> 'abc'

'abc'

>>> 'abc'.upper()

'ABC'

>>> 45 + 9

54

这只是 Python shell 提供的一种便利。它假设你输入一个表达式时，可能想要看到其值。但是在 Python shell 之外运行 Python 程序时，这种便利就消失了。相反，我们必须在每次想要输出内容时明确使用 print 函数。print 函数在 shell 中也能工作：

>>> print('abc')

abc

>>> print('abc'.upper())

ABC

>>> print(45 + 9)

54

请注意，print 输出的字符串没有引号。这很好——因为我们大概不希望在与程序用户交流时包括引号！

print 的一个不错的功能是，你可以提供任意多个参数，它们都会用空格分隔并输出：

>>> print('abc', 45 + 9)

abc 54

### 解决问题：一个完整的 Python 程序

现在我们准备通过编写一个完整的 Python 程序来解决 Word Count 问题。退出 Python shell 后，你将回到操作系统的命令提示符。

#### 启动文本编辑器

我们将使用文本编辑器来编写代码。按照你的操作系统的步骤进行。

##### Windows

在 Windows 上，我们将使用 Notepad，一个简易文本编辑器。在操作系统命令提示符下，如果你还不在*编程*文件夹中，请导航到该文件夹。然后输入 notepad word_count.py 并按 ENTER。由于*word_count.py*文件不存在，Notepad 会询问你是否要创建一个新的*word_count.py*文件。点击**是**，你就可以开始输入你的 Python 程序了。

##### macOS

在 macOS 上，你可以使用任何你喜欢的文本编辑器。你可能已经安装的一个编辑器是 TextEdit。在操作系统的命令提示符下，如果你还不在*编程*文件夹中，请导航到该文件夹。然后输入以下两个命令，每输入一个命令后按 ENTER：

$ touch word_count.py

$ open -a TextEdit word_count.py

touch 命令创建一个空文件，供文本编辑器打开。现在你可以开始输入你的 Python 程序了。

##### Linux

在 Linux 上，你可以使用任何你喜欢的文本编辑器。你可能已经安装的一个编辑器是 gedit。在操作系统的命令提示符下，如果你还没有在那里，请导航到你的*编程*文件夹。然后输入 gedit word_count.py 并按回车键。现在你可以输入你的 Python 程序了。

#### 程序

在加载好文本编辑器后，你可以输入我们的 Python 程序代码。代码位于清单 1-1。

❶ line = input()

❷ total_words = line.count(' ') + 1

❸ print(total_words)

*清单 1-1：解决单词计数*

输入代码时，请不要输入 ❶、❷ 或 ❸。它们是用来帮助我们逐步讲解代码的，不是代码的一部分。

我们首先从输入中获取一行文本，并将其赋值给变量 ❶。这将得到一个字符串，我们可以在其上使用 count 方法。我们将空格的计数加 1，以考虑字符串中的最后一个单词，并使用变量 total_words 来引用这个结果 ❷。最后一步是输出 total_words 所引用的值 ❸。

完成代码输入后，请务必保存文件。

#### 运行程序

要运行程序，我们将在操作系统命令提示符下使用 python 命令。正如我们之前看到的，单独输入 python 会运行 Python shell，但这次我们不想这样做。相反，我们要告诉 Python 运行 *word_count.py* 程序。为此，导航到你的 *编程* 文件夹，输入 python word_count.py。这里以及在全书中，如果需要，请使用 python3 命令，而不是 python 命令。

现在你的程序在输入提示符下等待你输入内容。输入几个单词，按回车键，你应该能看到程序正确运行。例如，输入以下内容：

这是我的第一个 Python 程序

你应该看到程序输出 6 作为结果。

如果你看到 Python 错误，请仔细检查代码，确保你完全输入正确。Python 要求精确。即使缺少一个括号或单引号，也会导致错误。

如果你花一些时间才让程序运行，不要感到沮丧。让第一个程序运行可能需要做很多工作。我们必须能够将程序输入到文件中，调用 Python 运行该程序，并修复由于程序错误导致的问题。但运行程序的过程是固定的，无论程序多复杂，所以在这里花的时间会为你完成书中的其余内容打下坚实的基础。

#### 提交给评测系统

恭喜！希望你运行第一个 Python 程序时感到满足。但我们怎么知道这个程序是正确的呢？它对所有可能的字符串都有效吗？我们可以再对几个字符串进行测试，但我们将通过将代码提交给在线评测来更有信心地判断它的正确性。评测系统会自动对我们的代码进行一系列测试，并告诉我们是否通过了测试，或者是否有错误。

访问 *[`dmoj.ca/`](https://dmoj.ca/)* 并登录。（如果你没有 DMOJ 账户，请按照介绍中的说明创建一个。）点击 **Problems**，并搜索 Word Count 问题代码 dmopc15c7p2。点击搜索结果加载问题——它被称为 "Not a Wall of Text" 而不是 Word Count。

然后你应该看到问题的描述，正如问题作者所写的那样。点击 **Submit Solution**，并将我们的代码粘贴到文本区域。确保选择 Python 3 作为编程语言。最后，点击 **Submit** 按钮。

DMOJ 会对我们的代码进行测试并显示结果。对于每个测试用例，你会看到一个状态代码。*AC* 代表 *accepted*（接受），这是你希望看到的每个测试用例的状态。其他状态代码包括 *WA*（错误答案）和 *TLE*（超时）。如果你看到这些，请再次检查你粘贴的代码，确保它与文本编辑器中的代码完全一致。

假设所有测试用例都通过，我们应该能看到我们的得分为 100/100，并且我们为此获得了 3 分。

对于每个问题，我们将遵循解决 Word Count 时使用的方法。首先，我们将探索使用 Python Shell，根据需要学习新的 Python 特性。然后，我们将编写一个解决问题的程序。我们将在自己的计算机上测试该程序，提供我们自己的测试用例。最后，我们将代码提交给评测系统。如果任何测试用例失败，我们将再次检查代码并修复问题。

### 问题 #2：圆锥体积

在 Word Count 中，我们需要从输入中读取一个字符串。在这个问题中，我们需要从输入中读取整数。这样做需要一个额外的步骤，将字符串转换为整数。我们还将学习如何在 Python 中进行数学运算。

这是 DMOJ 的问题 dmopc14c5p1。

#### 挑战

计算一个直圆锥的体积。

#### 输入

输入由两行文本组成。第一行包含整数 *r*，表示圆锥的半径。第二行包含整数 *h*，表示圆锥的高度。*r* 和 *h* 的值在 1 到 100 之间。（也就是说，*r* 和 *h* 的最小值是 1，最大值是 100。）

#### 输出

输出具有半径 *r* 和高度 *h* 的直圆锥的体积。计算体积的公式是 (*πr*²*h*)/3。

### 在 Python 中更多的数学运算

假设我们有表示半径和高度的变量 r 和 h：

>>> r = 4

>>> h = 6

现在我们要计算 (*πr*²*h*)/3。将半径 4 和高度 6 代入公式，我们得到 (*π* * 4² * 6)/3。使用 3.14159 作为 *π* 的值，计算器给出的结果是 100.531。我们如何在 Python 中实现这个计算呢？

#### 访问 Pi

为了访问 *π* 的值，我们将使用一个合适的变量。下面是一个赋值语句，将 PI 赋予一个非常精确的值：

PI = 3.141592653589793

这更像是一个 *常量* 而不是变量，因为我们永远不希望在代码中更改 PI 的值。根据 Python 的惯例，对于这样的变量，我们使用大写字母，就像我这里做的那样。

#### 指数

回顾我们的公式，(*πr*²*h*)/3，唯一还没讨论的是如何计算 *r*² 部分。因为 *r*² 等同于 *r* * *r*，所以我们可以使用乘法而非指数运算。

>>> r

4

>>> r * r

16

但直接使用指数运算更加直观。我们总是希望写出尽可能清晰的代码。而且，某一天你可能需要计算更大的指数，这时候重复的乘法会变得越来越难以处理。Python 的指数运算符是 **：

>>> r ** 2

16

这是完整的公式：

>>> (π * r ** 2 * h) / 3

100.53096491487338

太棒了——这接近我们预期的 100.531 结果！

请注意，我们在这里产生的是一个浮点数。正如我们在本章“整数和浮点数”中讨论的那样，/ 除法运算符会产生浮点数结果。

### 字符串与整数之间的转换

最终我们将不得不读取半径和高度作为输入。然后我们将使用这些值来计算体积。让我们尝试一下：

>>> r = input()

4

>>> h = input()

6

`input` 函数总是返回一个字符串，即使用户输入的是整数：

>>> r

'4'

>>> h

'6'

单引号确认这些值是字符串。字符串不能用于执行数学运算。如果我们尝试，就会得到错误：

>>> (π * r ** 2 * h) / 3

Traceback (most recent call last):

文件 "<stdin>"，第 1 行，在 <module> 中

TypeError: 不支持 ** 或 pow() 运算符的操作数类型：'str' 和 'int'

当我们使用错误类型的值时，会生成 TypeError。Python 不允许我们在 r 字符串和整数 2 之间使用 ** 运算符。** 运算符是纯数学运算符，当与字符串一起使用时没有意义。

为了将我们的字符串转换为整数，我们可以使用 Python 的 `int` 函数：

>>> r

'4'

>>> h

'6'

>>> r = int(r)

>>> h = int(h)

>>> r

4

>>> h

6

现在我们可以再次使用这些值代入我们的公式：

>>> (π * r ** 2 * h) / 3

100.53096491487338

每当你有一个表示整数的字符串时，你可以使用`int`函数将其转换为整数类型的值。它可以处理前后空格，但不能处理非数字字符：

>>> int('  12  ')

12

>>> int('12x')

Traceback (most recent call last):

文件 "<stdin>"，第 1 行，在 <module> 中

ValueError: int() 的参数 '12x' 不是有效的数字字符串

当将 `input` 返回的字符串转换为整数时，我们可以分两步进行，首先将 `input` 的返回值赋给一个变量，然后再将这个值转换为整数：

>>> num = input()

82

>>> num = int(num)

>>> num

82

或者我们可以将输入和 `int` 调用结合起来：

>>> num = int(input())

82

>>> num

82

这里，传递给 `int` 的参数是 `input` 返回的字符串。`int` 函数将这个字符串转换为整数类型的值。

如果我们需要将整数转换为字符串，可以使用 `str` 函数：

>>> num = 82

>>> 'my number is ' + num

Traceback (most recent call last):

文件 "<stdin>"，第 1 行，在 <模块> 中

TypeError: 只能将 str（而不是 "int"）与 str 连接

>>> str(num)

'82'

>>> '我的数字是 ' + str(num)

'我的数字是 82'

我们不能将字符串和整数连接在一起。`str` 函数将 82 转换为 '82'，这样它就可以用于字符串连接。

### 问题解决

我们准备好解决圆锥体积问题了。创建一个名为 *cone_volume.py* 的文本文件，并输入 列表 1-2 中的代码。

❶ PI = 3.141592653589793

❷ radius = int(input())

❸ height = int(input())

❹ volume = (PI * radius ** 2 * height) / 3

❺ print(volume)

*列表 1-2：求解圆锥体积*

我在代码中添加了空行，将其分为逻辑块。Python 会忽略这些空行，但它们可以让我们更容易阅读和分块代码。

注意，我使用了描述性的变量名：radius 代替 r，height 代替 h，以及 volume。单字母变量名在数学公式中很常见，但在编写代码时，我们可以使用更具描述性的变量名。

我们首先定义一个变量 PI 来表示 pi 的近似值 ❶。然后我们从输入中读取半径 ❷ 和高度 ❸，将它们从字符串转换为整数。我们使用圆锥体积公式来计算体积 ❹。最后，输出体积 ❺。

保存你的 *cone_volume.py* 文件。

通过输入 python cone_volume.py 运行你的程序，然后输入半径和高度的值。使用计算器验证你的程序输出是否正确！

如果你输入无效的半径或高度会发生什么？例如，运行程序并输入以下内容：

xyz

你应该会看到一个错误：

最近的调用堆栈（Traceback）：

文件 "cone_volume.py"，第 3 行，在 <模块> 中

radius = int(input())

ValueError: int() 的参数无效，不能将 'xyz' 转换为整数

这肯定不够用户友好。但为了学习编程，我们不需要担心这个问题。裁判上的所有测试用例都会符合问题的输入规范，所以我们不必担心如何处理无效输入。

说到裁判，DMOJ 欠我们三分，因为我们已经写好了这道题目的正确代码。继续提交你的代码吧！

### 总结

我们开始了！通过编写 Python 代码，我们解决了前两个问题。我们学习了编程的基础，包括值、类型、字符串、整数、方法、变量、赋值语句、输入和输出。

一旦你掌握了这部分内容——也许通过做一些接下来的练习——就可以进入 第二章。在那里，我们将学习如何让程序做出决策。我们将不再编写单纯从上到下运行的程序。它们将更加灵活，能够根据解决的特定问题实例做出相应的处理。

### 章节练习

每一章结尾都有一些习题供你尝试。我鼓励你完成尽可能多的习题。

有些习题可能会花费你很多时间。你可能会因为重复的 Python 错误感到沮丧。就像任何值得学习的技能一样，需要专注的练习。当你开始做一个习题时，我建议先手动解决几个例子。这样你就能知道问题的要求是什么，以及你的程序应该做什么。否则，你可能在没有计划的情况下编写代码，同时还要面对组织思路和编写程序的双重挑战。

如果你的代码没有运行，问问自己：你到底想要什么样的行为？哪些代码行可能是导致错误的罪魁祸首？有没有其他可能更简单的方法可以尝试？

我已经在书籍网站上提供了习题的解答 (*[`nostarch.com/learn-code-solving-problems/`](https://nostarch.com/learn-code-solving-problems/)*)。但在你没有诚实地尝试过你选择的习题之前，别偷看答案。或许试试两次，三次。如果你确实查看了解答并了解了其中的一种解法，休息一下，然后尝试从头开始自己解决问题。通常解决一个问题的方法不止一种。如果你的解决方案与我的不同，但也能做到正确的事情，这并不意味着我们其中一个错了。相反，这为你提供了一个机会，比较你的代码和我的代码，可能会在这个过程中学到其他的技术。

1.  DMOJ 问题 wc16c1j1, 恐怖季节

1.  DMOJ 问题 wc15c2j1, 新希望

1.  DMOJ 问题 ccc13j1, 排队中的下一个

1.  DMOJ 问题 wc17c1j2, 今天天气怎么样？（小心转换的方向！）

1.  DMOJ 问题 wc18c3j1, 一个诚实的工作日（提示：你如何确定瓶盖的数量以及这些瓶盖所需的总油漆量？）

### 备注

Word Count 原本来自于 DMOPC ’15 年 4 月比赛。Cone Volume 原本来自于 DMOPC ’14 年 3 月比赛。
