## **简介**

![image](img/common01.jpg)

如果你正在阅读本书，那么你很可能已经使用 Python 一段时间了。也许你通过教程学习它，深入研究了一些现有的程序，或者从零开始。无论如何，你都通过*黑客*的方式学会了它。这正是我在开始从事大型开源项目之前的学习方式，大约 10 年前，我就是这样熟悉了 Python。

一旦你写了你的第一个程序，可能很容易认为自己已经了解和掌握了 Python。这个语言确实很容易上手。然而，要精通它并深入理解它的优点和缺点，却需要多年的时间。

当我刚开始学习 Python 时，我在“车库项目”规模上构建了自己的 Python 库和应用程序。但当我开始与数百名开发人员合作开发软件，并为数千名用户提供服务时，情况发生了变化。例如，OpenStack 平台——一个我参与的项目——包含了超过 900 万行 Python 代码，这些代码必须简洁、高效，并能根据用户需求扩展，满足各种云计算应用的需求。当你处理如此规模的项目时，测试和文档工作必须实现自动化，否则根本无法完成。

在开始从事这个规模的项目之前，我认为自己对 Python 已经了解很多——这是我刚开始时难以想象的规模——但我学到了更多。我也有机会遇到一些行业内最顶尖的 Python 黑客并向他们学习。他们教会了我从通用架构和设计原则到各种实用技巧的方方面面。通过本书，我希望分享我所学到的最重要的东西，让你也能构建更好的 Python 程序——而且能更加高效地构建它们！

本书的第一版《黑客的 Python 指南》于 2014 年发布。现在的《Serious Python》是第四版，内容经过更新并加入了全新的内容。希望你喜欢它！

### **谁应该阅读本书及其原因**

本书面向那些希望将 Python 技能提升到更高水平的 Python 程序员和开发者。

本书中，你将找到帮助你充分利用 Python 并构建未来可持续程序的方法和建议。如果你已经在进行一个项目，你可以立即应用书中讨论的技巧来改进你当前的代码。如果你正在启动第一个项目，你将能够根据最佳实践创建一个蓝图。

我将向你介绍一些 Python 的内部机制，以帮助你更好地理解如何编写高效的代码。你将深入了解 Python 的内部工作原理，这将帮助你理解问题或低效之处。

本书还提供了经过实践验证的解决方案，解决了诸如测试、移植和扩展 Python 代码、应用程序和库等问题。这将帮助你避免犯别人已经犯过的错误，并发现有助于长期维护软件的策略。

### **关于本书**

本书不一定是按顺序阅读的。你可以自由跳到感兴趣或与你的工作相关的章节。在全书中，你将找到各种建议和实用的技巧。以下是每个章节的快速概述。

**第一章** 提供了在开始项目之前需要考虑的事项，包括如何构建项目、版本编号、设置自动错误检查等方面的建议。最后还有与 Joshua Harlow 的访谈。

**第二章** 介绍了 Python 模块、库和框架，并简要讲解了它们在背后的工作原理。你将获得有关使用 sys 模块、从 pip 包管理器获取更多信息、选择最适合你的框架以及使用标准和外部库的指导。还有 Doug Hellmann 的访谈。

**第三章** 提供了关于如何在项目发展过程中（即使发布之后）对项目进行文档化以及管理 API 的建议。你将获得使用 Sphinx 自动化某些文档任务的具体指导。本章的访谈对象是 Christophe de Vienne。

**第四章** 讨论了时区这一长期困扰的问题，并介绍了如何在程序中使用 datetime 对象和 tzinfo 对象来处理时区。

**第五章** 帮助你将软件分发给用户，提供了关于分发的指导。你将学习到关于打包、分发标准、distutils 和 setuptools 库的知识，并了解如何通过入口点轻松发现包中的动态功能。Nick Coghlan 接受了采访。

**第六章** 提供了单元测试的最佳实践建议，并通过具体的教程讲解了如何使用 pytest 自动化单元测试。你还将学习如何使用虚拟环境增加测试的隔离性。本章的访谈对象是 Robert Collins。

**第七章** 深入探讨了方法和装饰器。本章介绍了如何使用 Python 进行函数式编程，并提供了关于何时以及如何使用装饰器的建议，还讨论了如何为装饰器创建*装饰器*。我们还将深入探讨静态方法、类方法和抽象方法，并讨论如何将三者结合起来以创建更强大的程序。

**第八章** 展示了你可以在 Python 中实现的更多函数式编程技巧。本章讨论了生成器、列表推导式、函数式函数及其常用工具，以及有用的 functools 库。

**第九章** 探索了 Python 语言本身的内部结构，讨论了抽象语法树（AST），它是 Python 的核心结构。我们还将学习如何扩展 flake8 以使其与 AST 配合使用，从而为你的程序引入更复杂的自动化检查。本章最后有一篇与 Paul Tagliamonte 的访谈。

**第十章** 是关于通过使用适当的数据结构、有效地定义函数以及应用动态性能分析来优化性能的指南。我们还会讨论记忆化和减少数据复制的浪费。你还将看到与 Victor Stinner 的访谈。

**第十一章** 讨论了多线程这一复杂的主题，包括何时以及如何使用多线程而非多进程，以及在创建可扩展程序时是否应使用事件驱动架构或面向服务的架构。

**第十二章** 讲解了关系型数据库。我们将看看它们是如何工作的，以及如何使用 PostgreSQL 有效地管理和流式传输数据。本章包含对 Dimitri Fontaine 的访谈。

最后，**第十三章** 提供了关于多个主题的实用建议：如何让你的代码兼容 Python 2 和 3，如何编写类似 Lisp 的功能性代码，如何使用上下文管理器，以及如何利用 attr 库减少重复代码。
