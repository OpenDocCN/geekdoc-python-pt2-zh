## **介绍**

![image](img/common01.jpg)

如果你正在阅读这本书，那么你很可能已经使用 Python 一段时间了。也许你通过一些教程学习过它，深入研究了一些现有程序，或者从零开始。无论是哪种情况，你都已经通过自己的方式*破解*了学习它的方法。正是我通过这种方式熟悉了 Python，直到十年前开始参与大型开源项目。

一旦你写出第一个程序，可能会觉得自己已经掌握了 Python。这门语言的确很容易理解。然而，掌握它并深入理解它的优点和缺点需要数年的时间。

当我开始学习 Python 时，我是在“车库项目”的规模上构建自己的 Python 库和应用程序。事情在我开始和数百名开发者一起工作，开发成千上万的用户依赖的软件时发生了变化。例如，OpenStack 平台——这是我参与的一个项目——包含超过 900 万行 Python 代码，所有这些代码必须保持简洁、高效，并能够根据用户所需的云计算应用程序的需求进行扩展。当项目达到这种规模时，像测试和文档这样的问题绝对需要自动化，否则根本无法完成。

在开始从事这种规模的项目之前，我曾以为自己对 Python 了解很多——这种规模的项目在我刚开始时几乎无法想象——但我学到了更多。我也有机会结识一些业内最顶尖的 Python 黑客并向他们学习。他们教会了我从通用架构和设计原则到各种实用技巧和窍门的所有知识。通过本书，我希望分享我所学到的最重要的内容，以便你也能构建更好的 Python 程序——并且更高效地构建它们！

本书的第一版《黑客的 Python 指南》于 2014 年发布。现在《Serious Python》是第四版，内容进行了更新并加入了全新的内容。希望你喜欢它！

### **谁应该阅读本书，以及为什么**

本书面向那些希望将自己 Python 技能提升到更高水平的 Python 编程人员和开发者。

在本书中，你将找到一些方法和建议，帮助你最大限度地发挥 Python 的潜力，构建未来可持续的程序。如果你已经在做项目，你将能够立即应用书中讨论的技巧，提升你当前的代码。如果你正在开始你的第一个项目，你将能够根据最佳实践创建一个蓝图。

我将向你介绍一些 Python 内部机制，以帮助你更好地理解如何编写高效的代码。你将深入了解这门语言的内在工作原理，帮助你识别问题或低效之处。

本书还提供了可应用的、经过实战验证的解决方案，解决了诸如测试、移植和扩展 Python 代码、应用程序和库等问题。这将帮助你避免他人曾经犯过的错误，并发现能够帮助你长期维护软件的策略。

### **关于本书**

本书不一定需要按顺序从头到尾阅读。你可以根据自己的兴趣或工作相关性跳到感兴趣的章节。在本书中，你将找到各种建议和实用技巧。以下是每个章节内容的简要概述。

**第一章** 提供了在开始项目之前应考虑的事项，包含关于项目结构、版本编号、设置自动化错误检查等方面的建议。章节最后有对 Joshua Harlow 的采访。

**第二章** 介绍了 Python 模块、库和框架，并简要讨论了它们在幕后是如何工作的。你将获得关于使用`sys`模块、从`pip`包管理器中获得更多信息、选择最适合你的框架以及使用标准库和外部库的指导。还包含对 Doug Hellmann 的采访。

**第三章** 提供了关于如何在项目发展过程中，包括发布后，记录项目和管理 API 的建议。你将获得关于使用 Sphinx 自动化某些文档任务的具体指导。本章还包括对 Christophe de Vienne 的采访。

**第四章** 讨论了关于时区的老生常谈问题，并介绍了如何使用`datetime`对象和`tzinfo`对象在程序中最好地处理它们。

**第五章** 帮助你将软件分发给用户，提供了分发的指导。你将了解打包、分发标准、`distutils`和`setuptools`库，以及如何通过入口点轻松发现包中的动态功能。此章节包含对 Nick Coghlan 的采访。

**第六章** 提供了关于单元测试的建议，包括最佳实践技巧和使用`pytest`自动化单元测试的具体教程。你还将学习如何使用虚拟环境来增强测试的隔离性。该章节的采访对象是 Robert Collins。

**第七章** 深入探讨了方法和装饰器。本文将介绍如何使用 Python 进行函数式编程，提供如何以及何时使用装饰器的建议，以及如何为装饰器创建*装饰器*。我们还将探讨静态方法、类方法和抽象方法，并讨论如何将三者结合起来构建更强大的程序。

**第八章** 向你展示了可以在 Python 中实现的更多函数式编程技巧。该章节讨论了生成器、列表推导式、函数式函数及实现这些功能的常用工具，以及有用的`functools`库。

**第九章** 透视了语言本身，讨论了 Python 的抽象语法树（AST），它是 Python 内部的结构。我们还将学习如何扩展 `flake8` 以与 AST 配合使用，从而为程序引入更复杂的自动检查。本章最后通过一段对 Paul Tagliamonte 的访谈作结。

**第十章** 是关于通过使用合适的数据结构、有效定义函数以及应用动态性能分析来优化性能的指南，目的是识别代码中的瓶颈。我们还将讨论记忆化和减少数据复制中的浪费。你还会看到对 Victor Stinner 的访谈。

**第十一章** 探讨了多线程这一复杂主题，包括如何以及何时使用多线程而不是多进程，以及是否使用面向事件或面向服务的架构来创建可扩展的程序。

**第十二章** 涉及关系型数据库。我们将了解它们的工作原理，以及如何使用 PostgreSQL 高效地管理和流式传输数据。Dimitri Fontaine 进行了访谈。

最后，**第十三章** 提供了关于多个主题的实用建议：如何使代码兼容 Python 2 和 3，如何编写像 Lisp 一样的函数式代码，如何使用上下文管理器，以及如何使用 `attr` 库减少重复代码。
