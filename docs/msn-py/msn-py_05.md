## **5

**准备太空站设备**

![image](../images/common01.jpg)

现在太空站的墙壁已经安装完毕，我们可以开始安装设备了。我们需要关于不同设备的详细信息，包括家具、生存系统和实验设备。在本章中，你将添加有关太空站上所有物品的信息，包括它们的图片和描述。你还将尝试设计自己的房间，并使用你在[第4章](ch04.xhtml#ch04)中创建的*Explorer*程序查看它。

### **创建一个简单的行星字典**

为了存储有关太空站设备的信息，我们将使用一种编程概念，叫做字典。*字典*有点像列表，但内置了搜索引擎。让我们仔细看看它是如何工作的。

#### **理解列表和字典之间的区别**

与纸质字典类似，你可以使用一个单词或短语在Python字典中查找信息。这个单词或短语称为*键*，与键关联的信息称为*值*。与纸质字典不同，Python字典中的条目可以是任意顺序的，不一定要按字母顺序排列。Python可以直接找到你需要的条目，无论它在哪儿。

想象一下你有一个包含以往太空任务信息的列表。你可以通过以下代码行获取该列表中的第一个条目：

print(mission_info[0])

如果mission_info是字典而不是列表，你可以用任务名称代替索引号来获取该任务的信息，像这样：

print(mission_info["Apollo 11"])

键可以是一个单词或短语，也可以是一个数字。我们将从使用单词开始，因为这样更容易理解列表和字典之间的区别。

#### **制作天文学备忘字典**

所有宇航员都需要对太阳系有很好的理解，所以让我们在构建第一个字典时学习关于行星的知识。我们将使用行星的名称作为键，并将每个名称与有关该行星的信息相连接。

看一下[列表5-1](ch05.xhtml#ch05list1)，它创建了一个名为planets的字典。当你创建字典时，使用大括号{}来标记它的开始和结束，而不是你在列表中使用的方括号。

字典中的每个条目由键组成，后跟一个冒号，然后是该条目的信息。与列表一样，我们用逗号分隔条目，并在文本部分加上双引号。

在IDLE中打开一个新文件（**文件** ▸ **新建文件**），并输入以下程序。将其保存为*listing5-1.py*。

*listing5-1.py*

planets = { "水星": "最小的行星，最接近太阳",

"金星": "金星自转需要243天",

"地球": "已知唯一有原生生命的行星",

"火星": "红色行星是第二小的行星",

"木星": "最大行星，木星是一个气体巨星",

"土星": "第二大行星是一个气体巨星",

"天王星": "一颗带有环系的冰巨星",

"海王星": "一颗冰巨星，距离太阳最远"

}

➊ while True:

➋     query = input("你想了解哪个行星的信息？")

➌     print(planets[query])

*清单5-1：你的第一个字典程序*

这个程序不使用Pygame Zero，因此你可以通过点击**运行** ▸ **运行模块**来启动它。 (如果你使用pgzrun运行，它仍然可以正常工作，但使用菜单更方便。) 当你运行程序时，它会使用内置函数input() ➋ 来询问你想了解哪个行星的信息。试着输入“地球”或“木星”作为行星名称。

你想了解哪个行星的信息？ 地球

唯一已知拥有原生生命的行星

你想了解哪个行星的信息？ 木星

最大的行星，木星是一颗气体巨星

无论你输入哪个行星名称，它都会被存储在变量`query`中。这个变量随后被用来在行星字典 ➌ 中查找该行星的信息。与我们在列表中使用索引号不同，这里我们使用输入的单词来获取信息，而该单词存储在变量`query`中。

在Python中，我们可以使用while ➊循环来重复一组指令。与for循环不同，for循环用于重复指定次数，而while循环通常会重复，直到某些条件发生变化。在游戏中，while命令通常会检查一个变量来决定是否继续重复指令。例如，指令while lives > 0可以让游戏继续进行，直到玩家的生命值为0为止。当lives变量变为0时，循环中的指令将停止执行。

在*listing5-1.py*中，我们使用的while True命令会永远重复，因为它意味着“只要True为True”，即始终为真。为了让这个while True命令生效，确保将True的首字母大写，并在行末加上冒号。

在while命令下，我们使用四个空格来缩进应该重复的指令。在这里，我们缩进了要求你输入行星名称并返回行星信息的行，因此这些是需要重复的指令。输入一个行星名称并获得信息后，程序会再次要求你输入另一个行星名称，一直重复，直到你通过按CTRL-C停止程序为止。

虽然这个程序能正常工作，但它还不完整。如果你输入一个字典中没有的行星名称，你可能会遇到一个无用的错误。让我们修改代码，使其返回一个有用的信息。

#### **字典的错误防范**

当你输入一个字典中不存在的键时，你会看到一个错误信息。Python会查找精确匹配。因此，如果你尝试查找字典中没有的内容，或者拼写出现了微小的错误，你将无法获得想要的信息。

字典键（就像变量名一样）是区分大小写的，因此如果你输入earth而不是Earth，程序将崩溃。如果你输入一个不存在的行星，结果会是这样的：

你想要查询哪颗行星的信息？冥王星

Traceback (most recent call last):

文件 "C:\Users\Sean\Documents\Escape\listing5-1.py"，第 13 行，在 <module> 中

print(planets[query])

KeyError: 'Pluto'

>>>

可怜的冥王星！在服务了 76 年后，它在 2006 年被取消了行星资格，所以它不在我们的行星字典中。

**训练任务 #1**

你能在字典中添加一个冥王星的条目吗？特别注意引号、冒号和逗号的位置。你可以将其添加到字典中的任何位置。

当程序在字典中查找不存在的项时，它会停止并将你返回到 Python shell 提示符。为了避免这种情况，我们需要让程序在尝试使用输入的单词之前，先检查它是否是字典中的一个键。

你可以通过输入字典名称后跟点和 keys() 来查看字典中有哪些键。技术术语上，这被称为 *方法*。大致来说，方法是你可以通过一个句点附加到数据上的一组指令。运行以下代码在 Python shell 中：

>>> print(planets.keys())

dict_keys(['火星', '冥王星', '木星', '地球', '天王星', '土星', '水星',

'Neptune', 'Venus'])

你可能会注意到这里有些奇怪的地方。当我完成训练任务 #1 时，我将冥王星作为最后一个条目添加到了字典中。但在这个输出中，它排在了我的键列表的第二位。当你将条目添加到列表中时，它们会被放置到末尾，但在字典中并非总是如此。它取决于你使用的是哪个版本的 Python。（最新版本的 Python 会保持字典项按你添加的顺序排列。）不过，如前所述，字典中键的顺序并不重要。Python 会自动确定键的位置，因此你不需要考虑这一点。

为了防止程序在用户请求查询字典中没有的行星信息时崩溃，请按照 [清单 5-2](ch05.xhtml#ch05list2) 中的新增行修改你的程序。

*listing5-2.py*

--snip--

while True:

query = input("你想要查询哪颗行星的信息？")

➊      if query in planets.keys():

➋          print(planets[query])

否则：

➌          print("没有数据可用！抱歉！")

*清单 5-2：字典查找的错误防范*

将程序保存为 *listing5-2.py*，并通过点击 **运行** ▸ **运行模块** 来运行它。通过正确输入一个行星并运行，然后输入一个不在键列表中的其他行星，来检查它是否有效。这里是一个示例：

你想要查询哪颗行星的信息？金星

金星自转需要 243 天

你想要查询哪颗行星的信息？塔图因

没有数据可用！抱歉！

我们通过检查查询中的键是否存在于字典中来保护程序不崩溃，确保程序在尝试使用它之前不会出错 ➊。如果键存在，我们就像以前一样使用查询 ➋。否则，我们会向用户发送一条消息，告诉他们字典中没有该信息 ➌。现在程序变得更加友好。

#### **将列表放入字典中**

我们的行星字典现在有些有限。如果我们想添加额外的信息，比如行星是否有环以及有多少颗卫星，怎么办呢？为了实现这一点，我们可以使用一个列表来存储关于行星的多个信息，然后将该列表放入字典中。

例如，这是金星的新条目：

"金星": ["金星自转需要243天", False, 0]

方括号标记了列表的开始和结束，列表中有三个项目：简短的描述、一个True或False值，表示该行星是否有环，以及它拥有的卫星数量。由于金星没有环，第二项是False。它也没有卫星，所以第三项是0。

**红色警报**

True *和* False *值需要以大写字母开头，并且不应加引号。当你在IDLE中正确输入这些词时，它们会变成橙色。*

修改你的字典代码，使每个键都有一个列表，如[示例 5-3](ch05.xhtml#ch05list3)所示，保持其余代码不变。记住字典条目之间用逗号分隔，所以除了最后一个列表之外，所有列表后面都有一个逗号。将你的更新程序保存为*listing5-3.py*。

我也加入了冥王星的信息。有些人猜测冥王星可能有环，探索仍在继续。等你读这本书时，我们对冥王星的理解可能已经发生了变化。

*listing5-3.py*

planets = { "水星": ["最小的行星，离太阳最近", False, 0],

"金星": ["金星自转需要243天", False, 0],

"地球": ["唯一已知拥有原生生命的行星", False, 1],

"火星": ["第二小的行星", False, 2],

"木星": ["最大行星，气体巨星", True, 67],

"土星": ["第二大行星，是一颗气体巨星", True, 62],

"天王星": ["一颗有环系的冰巨星", True, 27],

"海王星": ["一颗冰巨星，距离太阳最远", True, 14],

"冥王星": ["太阳系最大的矮行星", False, 5]

}

--省略--

*示例 5-3：将列表放入字典中*

通过选择**运行** ▸ **运行模块**来运行程序。现在，当你请求一个行星的信息时，程序应该显示该行星的整个列表：

你想了解哪个行星的信息？金星

['金星自转需要243天', False, 0]

你想了解哪个行星的信息？火星

['第二小的行星', False, 2]

#### **从字典中的列表中提取信息**

我们知道如何从字典中获取信息列表，因此下一步是从该列表中获取单独的信息。例如，False条目本身意义不大。如果我们能把它从列表中分离出来，就可以在旁边加上解释，这样结果更容易理解。我们之前在[第4章](ch04.xhtml#ch04)的房间地图中使用过字典中的*列表*。现在，和之前一样，我们将使用索引号从*字典*中的列表中获取项目。

因为planets[query]是整个列表，我们可以通过使用planets[query][0]来查看仅描述（列表中的第一个项目）。我们可以通过使用planets[query][1]来查看它是否有环。简而言之，我们正在做的是：

1.  我们使用存储在变量query中的行星名称，从行星字典中访问特定的列表。

1.  我们使用索引号从该列表中提取单个项目。

修改你的程序，使其像[列表 5-4](ch05.xhtml#ch05list4)一样。和之前一样，只修改没有被灰色标记的行。将你的程序保存为*listing5-4.py*，然后点击**运行** ▸ **运行模块**来运行它。

*listing5-4.py*

--省略--

while True:

query = input("你想查看哪颗行星的信息？ ")

if query in planets.keys():

➊         print(planets[query][0])

➋         print("它有环吗？ ", planets[query][1])

else:

print("数据库为空。抱歉！")

*列表 5-4：显示存储在字典中的列表信息*

当你运行*listing5-4.py*程序时，你应该会看到如下所示的内容：

你想查看哪颗行星的信息？ 地球

唯一已知有原生生命的行星

它有环吗？  错误

你想查看哪颗行星的信息？ 土星

第二大行星是气体巨星

它有环吗？  正确

这应该适用于字典中的每颗行星！

当你输入字典中存在的行星名称时，程序现在会打印该行星信息列表中的第一个项目，即描述 ➊。在下一行，程序会询问该行星是否有环，然后显示你“True”或“False”的答案，这是该行星信息列表中的第二个项目 ➋。你可以使用相同的print()指令同时显示一些文本和数据，通过用逗号分隔它们。这样显示比打印整个列表更加清晰，信息也更容易理解。

**训练任务 #2**

你能修改程序，让它也告诉你该行星有多少颗卫星吗？

### **创建空间站物品字典**

让我们将如何使用字典和字典中的列表的知识应用到空间站中。由于空间站需要管理大量家具、生命支持设备、工具和个人物品，所以需要跟踪大量信息。我们将使用一个名为objects的字典来存储游戏中所有不同物品的信息。

我们将使用数字作为物品的键。这比为每个物品使用一个单词更简单。此外，使用数字使得理解房间地图更加容易，如果你想像我们在[第4章](ch04.xhtml#ch04)中那样打印出来也更方便。这样也减少了打字错误的风险。当我们稍后为谜题创建代码时，解决方案不那么明显，这意味着如果你在构建游戏而不是玩游戏时，也会减少剧透。

你可能还记得我们在[第4章](ch04.xhtml#ch04)中使用了数字0、1和2来代表地砖、墙柱和土壤。我们将继续使用这些数字来表示这些物品，其余的物品将使用数字3到81。

字典中的每个条目是一个列表，包含有关物品的信息，类似于我们在本章前面创建行星字典的方式。每个物体的列表包含以下信息：

**物体图像文件** 不同的物品可以使用相同的图像文件。例如，所有通行卡使用相同的图像。

**阴影图像文件** 我们使用阴影来增强游戏中的3D视角。两个标准阴影是*images.full_shadow*，它填满整个瓦片空间，适用于较大的物体；以及*images.half_shadow*，它填满半个瓦片空间，适用于较小的物体。轮廓独特的物体，如仙人掌，有自己的阴影图像文件，仅用于该物体。有些物品，如椅子，其阴影包含在图像文件中。有些物品没有阴影，例如陨石坑和玩家可以携带的任何物品。当一个图像没有阴影时，我们在字典中写“None”来表示它的阴影文件名。“None”是Python中的一个特殊数据类型。像True和False一样，使用它时不需要引号，并且首字母要大写。正确输入时，None在代码中会显示为橙色。

**详细描述** 当你在游戏中检查或选择物品时，详细描述会显示出来。有些详细描述包含线索，其他则仅仅描述环境。

**简短描述** 通常只有几个词，比如“通行卡”，当你在游戏中与物品进行互动时，简短描述会出现在屏幕上。例如，“你已丢弃通行卡”。简短描述仅对玩家可以捡起或使用的物品要求提供，比如通行卡或自动售货机。

游戏可以重用物品字典中的项目。例如，如果一个房间由60个或更多相同的墙柱组成，游戏只需重用相同的墙柱对象。只需要在字典中出现一次。

有一些项目使用相同的图像文件，但有其他差异，这意味着我们必须在字典中将它们单独存储。例如，门禁卡根据其所属人员有不同的描述，而门则有不同的描述告诉你该使用哪个钥匙。每张门禁卡和门在对象字典中都有各自的条目。

#### **在Escape中添加第一个对象**

打开你在[第4章](ch04.xhtml#ch04)中创建的*listing4-3.py*文件。这个代码包含了游戏地图和生成房间地图的代码。我们将在此程序中继续构建*Escape*游戏。

首先，我们需要设置一些额外的变量。在冒险开始之前，一个名为Poodle着陆器的研究飞船将在星球表面迫降。我们将在这些新变量中存储一个随机的坠毁地点坐标。我们现在添加这些变量，因为地图对象（编号27）将需要它们来生成描述。

将[Listing 5-5](ch05.xhtml#ch05list5)中的新行添加到你的现有*listing4-3.py*文件中的VARIABLES部分，该部分用哈希框标出。我建议将它们添加到其他变量的末尾，正好在MAP部分开始之前，这样你的代码和我的代码会保持一致。将程序保存为*listing5-5.py*。如果你现在运行它，程序不会做任何新事情，但如果你想尝试，可以输入pgzrun listing5-5.py。

*listing5-5.py*

--snip--

###############

## 变量 ##

###############

--snip--

DEMO_OBJECTS = [images.floor, images.pillar, images.soil]

LANDER_SECTOR = random.randint(1, 24)

LANDER_X = random.randint(2, 11)

LANDER_Y = random.randint(2, 11)

###############

##    MAP    ##

###############

--snip--

*Listing 5-5：添加坠毁地点变量*

这些新指令创建了变量，用来记住Poodle降落的区域（或房间号）以及该区域内的*x*和*y*位置。指令使用random.randint()函数，它从你提供的两个数字之间随机选择一个数字。这些指令在游戏开始时运行一次，因此每次玩时着陆器的位置都会不同，但在游戏过程中不会改变。

现在，让我们添加对象数据的第一部分，如[Listing 5-6](ch05.xhtml#ch05list6)所示。此部分提供了对象0到12的数据。由于玩家无法拾取或使用这些对象，因此它们没有简短描述。

将此部分代码放置在你现有程序(*listing5-5.py*)的MAKE MAP部分上方。为了帮助你在代码中找到位置，你可以在IDLE中按CTRL-F来搜索特定的单词或短语。例如，试着搜索*make map*，看看在哪里开始添加[Listing 5-6](ch05.xhtml#ch05list6)中的代码。搜索后，点击搜索对话框中的关闭按钮。如果你在代码中迷路了，记得你可以随时参考[附录A](appa.xhtml#appa)中的完整游戏代码。

如果你不想手动输入数据，可以使用位于列表文件夹中的 *data-chapter5.py* 文件。它包含物体字典，你可以将其复制并粘贴到你的程序中。你可以从直接粘贴前12项开始。

*listing5-6.py*

--snip--

assert len(GAME_MAP)-1 == MAP_SIZE, "地图大小与 GAME_MAP 不匹配"

###############

## 物体 ##

###############

objects = {

0: [images.floor, None, "地板光亮且干净"],

1: [images.pillar, images.full_shadow, "墙面光滑且冰冷"],

2: [images.soil, None, "这就像沙漠。还是应该是甜点？"],

3: [images.pillar_low, images.half_shadow, "墙面光滑且冰冷"],

4: [images.bed, images.half_shadow, "一张整洁舒适的床"],

5: [images.table, images.half_shadow, "它由强塑料制成。"],

6: [images.chair_left, None, "一把带有软垫的椅子"],

7: [images.chair_right, None, "一把带有软垫的椅子"],

8: [images.bookcase_tall, images.full_shadow,

"书架，上面堆满了参考书"],

9: [images.bookcase_small, images.half_shadow,

"书架，上面堆满了参考书"],

10: [images.cabinet, images.half_shadow,

"一个小储物柜，用于存放个人物品"],

11: [images.desk_computer, images.half_shadow,

"一台计算机。用它来运行生命支持诊断"],

12: [images.plant, images.plant_shadow, "一种太空莓植物，在这里生长"]

}

###############

## 制作地图 ##

###############

--snip--

*列表 5-6：添加第一个物体*

记住，代码的颜色可以帮助你发现错误。如果你的文本部分不是绿色的，说明你漏掉了开头的双引号。如果绿色部分太多，可能是忘记了闭合的双引号。有些列表会继续到下一行，Python知道列表尚未完成，直到它看到闭合的括号。如果你在运行任何列表时遇到问题，你可以使用我的代码版本（参见“[使用我的示例列表](ch01.xhtml#ch01sb1)”在[第21页](ch01.xhtml#page_21)）并从任何地方继续这个项目。

[列表 5-6](ch05.xhtml#ch05list6) 看起来与我们之前的行星字典相似：我们使用大括号标记字典的开始和结束，每个字典条目都是一个列表，因此它位于方括号内。主要的区别是这次键是一个数字，而不是一个单词。

将你的新程序保存为 *listing5-6.py*。这个程序使用 Pygame Zero 来绘制图形，所以你需要通过输入 `pgzrun listing5-6.py` 来运行你的新程序。它应该和之前一样运行，因为我们只是添加了新的数据，但还没有使用这些数据。无论如何，值得运行这个程序，因为如果你在命令行窗口看到错误信息，你可以在继续之前修复新代码。

#### **使用空间站探索器查看物体**

要查看这些物体，我们必须告诉游戏使用新的字典。将程序中 EXPLORER 部分的以下行从这个修改为：

image_to_draw = DEMO_OBJECTS[room_map[y][x]]

转换为以下内容：

image_to_draw = objects[room_map[y][x]][0]

这个小改动使得*Explorer*代码使用我们新的对象字典，而不是之前指示它使用的DEMO_OBJECTS列表。

请注意，我们现在使用的是小写字母，而不是大写字母。在这个程序中，我使用大写字母来表示常量，其值不会改变。DEMO_OBJECTS列表从未改变：它仅用于查找图像文件名。但对象字典的内容会随着游戏的进行而发生变化。

另一个不同之处是，现在[0]位于行的末尾。这是因为当我们从对象字典中提取一个项目时，它会返回一个完整的信息列表。但我们这里只想使用该列表中的第一项，即图像，所以我们使用索引[0]来提取它。

保存程序并重新运行，你应该会看到房间的样子与之前相同。因为我们还没有添加任何新物品，并且我们保持了地板、墙壁和土壤的物品编号与之前使用的索引编号相同。

#### **设计房间**

让我们往房间展示中添加一些物品。在代码的EXPLORER部分，添加[列表 5-7](ch05.xhtml#ch05list7)中显示的新行：

*listing5-7.py*

--snip--

###############

## EXPLORER  ##

###############

def draw():

global room_height, room_width, room_map

print(current_room)

generate_map()

screen.clear()

room_map[2][4] = 7

room_map[2][6] = 6

room_map[1][1] = 8

room_map[1][2] = 9

room_map[1][8] = 12

room_map[1][9] = 9

--snip--

*列表 5-7：在房间展示中添加一些物品*

这些新指令在房间显示之前，将物品添加到room_map列表的不同位置。

记住，room_map使用的是y坐标在前，x坐标在后。第一个索引数字表示物品距离房间后壁的远近；数字越小，物品离后壁越近。最小的有效数字通常是1，因为墙壁位于第0行。

第二个数字表示物品在房间中的水平位置，从左到右。通常列0是墙壁，所以1是这个位置的最小有效数字。

等号另一边的数字是特定物品的键。你可以通过查看[列表 5-6](ch05.xhtml#ch05list6)中的对象字典，来确认每个数字代表哪个物品。

所以这一行：

room_map[1][1] = 8

将物品8（一个高大的书架）放入房间的左上角。这一行：

room_map[2][6] = 6

将椅子（物品6）放在离顶部三行、左侧七个位置的地方。（记住，索引从0开始。）

保存你的程序为*listing5-7.py*并输入pgzrun listing5-7.py来运行它。[图 5-1](ch05.xhtml#ch05fig1)展示了你现在应该看到的内容。

![image](../images/fig5-1.jpg)

*图 5-1：温馨！在空间站Explorer *程序*中展示的一些物品*

因为*Explorer*程序只是一个演示版，所以有些功能还没有实现。例如，一些物体下面有一个黑色方块，因为那里没有地板砖。而且，由于我们已经将对象编码到EXPLORER部分，所以所有房间看起来都一样，显示的每个房间中都有相同的物体。这意味着你不能再查看所有房间，因为有些房间无法容纳所有物体。因此，你不能使用箭头键查看所有房间。此外，程序还无法正确显示床等宽大的物体。我们稍后会修复这些问题，但在此期间我们可以继续构建和测试空间站。

**训练任务 #3**

尝试修改你添加到*Explorer*程序中的代码，重新定位家具到你喜欢的位置。通过修改这段代码是学习如何在房间中定位物体的好方法。如果你想玩一个更大的房间，可以将VARIABLES部分中的current_room值从31改为40（这是游戏中最大的房间）。保存程序为*mission5-3.py*并通过`pgzrun mission5-3.py`运行。你需要保留现有*Explorer*代码的安全副本（*listing5-7.py*），以便在训练任务#4中使用。

#### **添加其余的对象**

到目前为止，我们已经将对象0到12添加到了对象字典中。游戏中总共有81个对象，接下来我们通过在[Listing 5-8](ch05.xhtml#ch05list8)中添加新行来添加其余的对象。记得在添加字典中剩余项目之前，在第12项后添加一个逗号。

当多个物体使用相同的文件名或相似描述时，你可以直接复制粘贴代码。要复制代码，点击并按住鼠标按钮，从代码块的开头开始，移动鼠标高亮显示它，然后按CTRL-C。接着在你想粘贴代码的位置点击鼠标并按CTRL-V。也记得你可以直接从*data-chapter5.py*文件中复制整个字典，这样可以节省打字时间。

将程序保存为*listing5-8.py*。你可以通过输入`pgzrun listing5-8.py`来测试程序是否仍然有效，尽管目前你不会看到任何新内容。

这是[Listing 5-8](ch05.xhtml#ch05list8)：

*listing5-8.py*

###############

##  对象  ##

###############

objects = {

0: [images.floor, None, "地板光滑干净"],

--snip--

12: [images.plant, images.plant_shadow, "本地种植的太空莓植物"],

➊  13: [images.electrical1, images.half_shadow,

"为空间站供电的电气系统"],

14: [images.electrical2, images.half_shadow,

"为空间站供电的电气系统"],

15: [images.cactus, images.cactus_shadow, "哎呀！小心仙人掌！"],

16: [images.shrub, images.shrub_shadow,

"太空生菜。虽然有点软，但竟然能在这里生长，真是令人惊叹！"],

17: [images.pipes1, images.pipes1_shadow, "水净化管道"],

18: [images.pipes2, images.pipes2_shadow,

"生命支持系统管道"],

19: [images.pipes3, images.pipes3_shadow, 

"为生命支持系统的管道"],

➋     20: [images.door, images.door_shadow, "安全门。自动打开\

为穿着功能性宇航服的宇航员准备的。"],

21: [images.door, images.door_shadow, "空气锁门。\

出于安全原因，它需要两个人操作。"],

22: [images.door, images.door_shadow, "一扇上锁的门。需要" \

+ PLAYER_NAME + "的通行卡"],

23: [images.door, images.door_shadow, "一扇上锁的门。需要" \

+ FRIEND1_NAME + "的通行卡"],

24: [images.door, images.door_shadow, "一扇上锁的门。需要" \

+ FRIEND2_NAME + "的通行卡"],

25: [images.door, images.door_shadow, 

"一扇上锁的门。从主任务控制开启"],

26: [images.door, images.door_shadow, 

"工程舱内的一扇上锁的门。"],

➌     27: [images.map, images.full_shadow, 

"屏幕显示撞击地点为区域："]\

+ str(LANDER_SECTOR) + " // X: " + str(LANDER_X) + \

" // Y: " + str(LANDER_Y)],

28: [images.rock_large, images.rock_large_shadow, 

"一块岩石。它的粗糙表面像磨刀石", "那块岩石"],

29: [images.rock_small, images.rock_small_shadow, 

"一块小而沉重的火星岩"],

30: [images.crater, None, "行星表面上的一个陨石坑"],

31: [images.fence, None, 

"一个细密的纱网围栏。它有助于保护站点免受沙尘暴的影响"],

32: [images.contraption, images.contraption_shadow, 

"其中一项科学实验。它轻轻震动"],

33: [images.robot_arm, images.robot_arm_shadow, 

"一只机器人臂，用于重物搬运"],

34: [images.toilet, images.half_shadow, "一间闪亮干净的厕所"],

35: [images.sink, None, "一只有流水的洗手池", "水龙头"],

36: [images.globe, images.globe_shadow, 

"一个巨大的行星模型。它从内部发出柔和的光"],

37: [images.science_lab_table, None, 

"一个实验桌，分析行星土壤和尘土"],

38: [images.vending_machine, images.full_shadow, 

"一台自动售货机。它需要信用卡。", "自动售货机"],

39: [images.floor_pad, None, 

"一个压力传感器，确保没有人单独出去。"],

40: [images.rescue_ship, images.rescue_ship_shadow, "一艘救援飞船！"],

41: [images.mission_control_desk, images.mission_control_desk_shadow, \

"任务控制站。"],

42: [images.button, images.button_shadow, 

"用于打开工程舱时间锁门的按钮。"],

43: [images.whiteboard, images.full_shadow, 

"白板用于头脑风暴和规划会议。"],

44: [images.window, images.full_shadow, 

"窗户提供了望向行星表面的视野。"],

45: [images.robot, images.robot_shadow, "一台关闭的清洁机器人。"],

46: [images.robot2, images.robot2_shadow,

"一台行星表面探索机器人，待设置。"],

47: [images.rocket, images.rocket_shadow, "一台正在修理中的单人航天器。"],

48: [images.toxic_floor, None, "有毒地板——禁止踏足！"],

49: [images.drone, None, "一架送货无人机"],

50: [images.energy_ball, None, "一个能量球——危险！"],

51: [images.energy_ball2, None, "一个能量球 - 危险！"],

52: [images.computer, images.computer_shadow,

"一个计算机工作站，用于管理空间站系统。"],

53: [images.clipboard, None,

"一个剪贴板。上面有人涂鸦。", "剪贴板"],

54: [images.bubble_gum, None,

"一块粘性的口香糖。太空莓口味。", "口香糖"],

55: [images.yoyo, None, "一个由细结实的绳子和塑料制成的玩具。\

用于反重力实验。", PLAYER_NAME + "的溜溜球"],

56: [images.thread, None,

"一段细且结实的绳子", "一段绳子"],

57: [images.needle, None,

"一根来自仙人掌植物的锋利针刺", "仙人掌针"],

58: [images.threaded_needle, None,

"一根仙人掌针，刺穿了一段绳子", "针和绳子"],

59: [images.canister, None,

"空气罐有泄漏。", "一个漏气的空气罐"],

60: [images.canister, None,

"看起来封印应该没问题！", "一个封闭的空气罐"],

61: [images.mirror, None,

"镜子在墙上投射出一圈光。", "一面镜子"],

62: [images.bin_empty, None,

"一个很少使用的垃圾桶，轻塑料制作", "一个垃圾桶"],

63: [images.bin_full, None,

"一个装满水的重垃圾桶", "一个装水的垃圾桶"],

64: [images.rags, None,

"一块油腻的抹布。如果必须捡起来，请抓住角落！", "一块油腻的抹布"],

65: [images.hammer, None,

"一把锤子。也许可以用来打开东西...", "一把锤子"],

66: [images.spoon, None, "一个大勺子", "一个勺子"],

67: [images.food_pouch, None,

"一个脱水食品袋。需要加水。", "干粮袋"],

68: [images.food, None,

"一个食品袋。用它可以获得100%的能量。", "即食食品"],

69: [images.book, None, "书上写着‘别慌’这几个字，\

封面上大大的、友好的字母", "一本书"],

70: [images.mp3_player, None,

"一个MP3播放器，装有所有最新的曲目", "一台MP3播放器"],

71: [images.lander, None, "贵宾犬号，一个小型太空探索飞船。\

它的黑匣子内有一个无线电系统。", "贵宾犬号着陆器"],

72: [images.radio, None, "一个无线电通信系统，来自\

贵宾犬号", "一个通信无线电"],

73: [images.gps_module, None, "一个GPS模块", "一个GPS模块"],

74: [images.positioning_system, None, "部分定位系统。\

需要一个GPS模块。", "一个定位接口"],

75: [images.positioning_system, None,

"一个正在工作的定位系统", "一个定位计算机"],

76: [images.scissors, None, "剪刀。它们太钝了，无法剪开\

任何东西。你能把它们磨利吗?", "钝的剪刀"],

77: [images.scissors, None,

"锋利的剪刀。小心！", "已磨尖的剪刀"],

78: [images.credit, None,

"一个小硬币，用于车站的自动售货系统",

"一个车站信用卡"],

79: [images.access_card, None,

"这张通行证属于" + PLAYER_NAME, "一张通行证"],

80: [images.access_card, None,

"这张通行证属于" + FRIEND1_NAME, "一张通行证"],

81: [images.access_card, None,

"这张通行证属于" + FRIEND2_NAME, "一张通行证"],

}

➍ items_player_may_carry = list(range(53, 82))

# 以下数字代表地板、压力垫、土壤、有毒地板。

➎ items_player_may_stand_on = items_player_may_carry + [0, 39, 2, 48]

###############

## 创建地图 ##

###############

--snip--

*清单5-8：完成*逃脱*游戏的物品数据*

一些物品的列表在程序中跨越多行 ➊。这是可以接受的，因为Python知道直到看到关闭括号，列表才算完整。要将字符串（或任何其他代码）分成多行，你可以在行末使用 \ ➋。*listing5-8.py*中的换行只是为了让代码在书页上显示得整齐：在屏幕上，代码可以向右扩展，如果你愿意的话。

对象27是显示贵宾犬坠毁地点的地图。它的长描述包括你在[清单5-5](ch05.xhtml#ch05list5)中为贵宾犬位置设置的变量。str()函数用于将这些变量中的数字转换为字符串，以便它们可以与其他字符串结合，组成长描述 ➌。

我们还设置了一些在游戏中需要的附加列表：items_player_may_carry存储玩家可以捡起的物品编号 ➍。这些物品是对象53到81。因为它们被分组在一起，我们可以使用范围来设置items_player_may_carry列表。*范围*是一个从给定的第一个数字开始，并在最后一个数字*之前*结束的数字序列。（我们在[第3章](ch03.xhtml#ch03)中使用过范围。）我们通过list(range(53 to 82))将这个范围转化为列表，这样就能得到从53到81的所有数字。

如果以后你添加了更多玩家可以携带的物品，你可以将它们添加到这个列表的末尾。例如，要添加玩家可以携带的编号为89和93的新物品，使用items_player_may_carry = list(range(54, 82)) + [89, 93]。你也可以将新物品添加到物品列表的末尾，并仅扩展用于设置items_player_may_carry的范围。

另一个新的列表是items_player_may_stand_on，它指定玩家是否允许站在某个物品上 ➎。玩家只能站在足够小，可以捡起的物品和不同类型的地板上。我们通过将不同地板类型的物品编号添加到items_player_may_carry列表中来创建这个列表。

在你输入[清单5-8](ch05.xhtml#ch05list8)之后，你就完成了*逃脱*游戏的物品部分！但我们还没有将物品放入游戏地图中。我们将在[第6章](ch06.xhtml#ch06)开始做这件事。

**训练任务 #4**

尝试一下你刚刚添加到游戏中的一些新物品。通过修改代码，你能……

+   将高书架换成垃圾桶（对象62）？

+   将太空莓植物换成一块小石头（对象29）？

+   将右边的椅子换成一块有毒的地板（对象48）？

要了解哪条指令放置了哪个对象，你可以使用现有代码中的坐标，或者查找对象字典中的对象编号（可以在屏幕上查看或在本章的列表中查找）。运行程序以确保它能正常工作。

### **你适合飞行吗？**

勾选以下框选项，以确认你已经掌握了本章的关键知识点。

![图片](../images/box.jpg)  要从字典中获取信息，你需要使用该信息的键。键可以是一个单词或数字，也可以存储在变量中。

![图片](../images/box.jpg)  如果你尝试使用一个不在字典中的键，将会导致错误。

![图片](../images/box.jpg)  为了避免错误，请在程序尝试使用键之前，检查该键是否在字典中。

![图片](../images/box.jpg)  你可以将列表放入字典中。然后，你可以使用字典的键，后跟列表索引，来获取列表中的特定项。例如：planets["Earth"][1]。

![图片](../images/box.jpg)  *Escape* 游戏使用对象字典来存储游戏中所有对象的信息。字典中的每一项都是一个列表。

![图片](../images/box.jpg)  你可以使用该列表的索引号来访问对象的图像文件、阴影图像文件以及长短描述。

![图片](../images/f0096-01.jpg)
