## 3

使用条件语句的猜测和检查

*“将面团放入烤箱时要确保它是面团：在确保它确实是面团之后。” — Idries Shah，《学习如何学习》*

![image](img/fintro-01.jpg)

在你为本书编写的几乎每一个程序中，你都将指导计算机做出决策。你可以使用一个重要的编程工具叫做*条件语句*来实现这一点。在编程中，我们可以使用条件语句

比如“如果这个变量大于 100，就做这个；否则，做那个”，用来检查某些条件是否满足，然后根据结果决定接下来做什么。事实上，这是一种非常强大的方法，我们将其应用于大问题，甚至它是机器学习的核心。最基本的层面上，程序是在猜测，然后根据反馈修改其猜测。

在本章中，你将学习如何使用 Python 应用猜测和检查的方法，获取用户输入，并根据输入告诉程序打印什么内容。然后，你将使用条件语句比较不同的数值，并在不同的数学情境中使乌龟随机在屏幕上徘徊。你还将创建一个猜数字游戏，并使用相同的逻辑来求大数的平方根。

### 比较运算符

如你在第二章中学到的，True 和 False（我们在 Python 中将其大写）被称为布尔值。当 Python 比较两个值时，会返回布尔值，允许你使用结果来决定接下来做什么。例如，我们可以使用像大于（>）或小于（<）这样的比较运算符来比较两个值，如下所示：

>>> 6 > 5

True

>>> 6 > 7

False

在这里，我们询问 Python 是否 6 大于 5，Python 返回 True。然后我们询问是否 6 大于 7，Python 返回 False。

记住，在 Python 中我们使用一个等号来为变量赋值。但检查是否相等需要两个等号（==），如这里所示：

>>> 6 = 6

SyntaxError: can't assign to literal

>>> 6 == 6

True

如你所见，当我们尝试仅使用一个等号时，会得到语法错误。我们还可以使用比较运算符来比较变量：

>>> y = 3

>>> x = 4

>>> y > x

False

>>> y < 10

True

我们将变量 y 设置为 3，然后将变量 x 设置为 4。接着我们用这两个变量来问 y 是否大于 x，因此 Python 返回 False。然后我们询问 y 是否小于 10，结果返回 True。这就是 Python 进行比较的方式。

### 使用 if 和 else 语句做决定

你可以让程序使用 if 和 else 语句来决定运行哪些代码。例如，如果你设置的条件为 True，程序就会运行一段代码。如果条件为 False，你可以让程序做其他事情，甚至什么也不做。以下是一个示例：

>>> y = 7

>>> if y > 5:

print("yes!")

yes!

在这里，我们说，将变量 y 的值设置为 7。如果 y 的值大于 5，打印“yes!”；否则，不做任何操作。

你还可以通过使用 else 和 elif 给程序提供其他运行代码的选择。由于我们将编写一些较长的代码，打开一个新的 Python 文件并将其保存为 *conditionals.py*。

*conditionals.py*

y = 6

if y > 7:

print("yes!")

else:

print("no!")

在这个例子中，我们说，如果 y 的值大于 7，打印“yes!”；否则，打印“no!”。运行这个程序时，它应该打印“no!”因为 6 不大于 7。

你可以使用 elif 添加更多的替代选项，elif 是 “else if” 的缩写。你可以有任意多的 elif 语句。以下是一个包含三个 elif 语句的示例程序：

*conditionals.py*

age = 50

if age < 10:

print("你上什么学校？")

elif 11 < age < 20:

print("你很酷！")

elif 20 <= age < 30:

print("你做什么工作？")

elif 30 <= age < 40:

print("你结婚了吗？")

else:

print("哇，你好老！")

这个程序根据 age 的值属于哪个指定范围来运行不同的代码。注意，你可以使用 <= 表示“小于或等于”，还可以使用复合不等式，如 if 11 < age < 20: 来表示“如果 age 在 11 到 20 之间”。例如，当 age = 50 时，输出如下：

哇，你好老！

能让你的程序根据你定义的条件快速自动做出决策，是编程中一个重要的方面！

### 使用条件语句找到因数

现在，让我们利用到目前为止学到的知识来分解一个数字！因数是能整除另一个数字的数字；例如，5 是 10 的因数，因为我们可以把 10 整除 5。在数学课上，我们使用因数做从求公共分母到判断一个数字是否是质数等各种事情。但手动找因数可能是一个繁琐的任务，尤其是当你处理更大的数字时。让我们看看如何使用 Python 自动化因数分解。

在 Python 中，你可以使用模运算符（%）来计算两个数字相除后的余数。例如，如果 a % b 等于零，意味着 b 可以整除 a。以下是模运算的一个例子：

>>> 20 % 3

2

这表示当你用 20 除以 3 时，余数是 2，这意味着 3 不是 20 的因数。我们试试 5：

>>> 20 % 5

0

现在我们得到的余数是零，所以我们知道 5 是 20 的因数。

#### 编写 *factors.py* 程序

让我们使用模运算符编写一个函数，它接收一个数字并返回该数字的因数列表。我们不仅仅是打印因数，而是将它们放入一个列表中，以便稍后在其他函数中使用这个因数列表。在我们开始编写这个程序之前，最好先规划一下。以下是 *factors.py* 程序的步骤：

1.  定义因数函数，它接收一个数字作为参数。

1.  创建一个空的因数列表，用来存储因数。

1.  遍历从 1 到给定数字的所有数字。

1.  如果这些数字中有任何一个能整除，就把它添加到因数列表中。

1.  在最后返回因数列表。

示例 3-1 显示了 factors() 函数。将此代码输入到 IDLE 中的新文件中并保存为 *factors.py*。

*factors.py*

def factors(num):

'''返回 num 的因子列表'''

factorList = []

for i in range(1,num+1):

如果 num % i == 0:

factorList.append(i)

return factorList

*示例 3-1：编写* factors.py *程序*

我们首先创建一个名为 factorList 的空列表，稍后我们将在找到因子时将其添加到列表中。然后，我们开始一个循环，从 1 开始（不能除以零），直到 num + 1，以便循环包含 num。在循环内部，我们指示程序做出决策：如果 num 能被当前的 i 值整除（余数为 0），则程序将 i 添加到因子列表中。最后，我们返回因子列表。

现在按 F5 键或点击 **Run** ▸ **Run Module** 来运行 *factors.py*，如图 3-1 所示。

![image](img/f041-01.jpg)

*图 3-1：运行* factors.py *模块*

运行此模块后，您可以通过在普通 IDLE 终端中传递一个数字来使用 factors 函数，以查找该数字的因子，像这样：

>>> factors(120)

[1, 2, 3, 4, 5, 6, 8, 10, 12, 15, 20, 24, 30, 40, 60, 120]

您已经使用 factors 函数找到了 120 的所有因子！这比使用试错法要容易和快速得多。

练习 3-1：查找因子

factors() 函数可以帮助您找到两个数字的最大公因数 (GCF)。编写一个返回两个数字最大公因数的函数，像这样：

>>> gcf(150,138)

6

#### 漫游海龟

现在您知道如何指示程序自动做出决策，我们来探索如何让程序无限执行！首先，我们将让一个海龟在屏幕上四处走动，并使用条件语句让它在超过某个位置时转弯。

海龟的窗口是一个经典的 x-y 坐标网格，默认情况下 x 轴和 y 轴的范围是从 -300 到 300。让我们将海龟的位置限制在 x 和 y 均为 -200 到 200 之间，如图 3-2 所示。

![image](img/f042-01.jpg)

*图 3-2：海龟受限的坐标矩形*

在 IDLE 中打开一个新的 Python 文件并将其保存为 *wander.py*。首先，我们导入 turtle 模块。为此，请添加以下代码：

从 turtle 导入 *

从 random 导入 randint

请注意，我们还需要从 random 模块导入 randint 函数来生成随机整数。

##### 编写 wander.py 程序

现在让我们创建一个名为 wander 的函数，让海龟在屏幕上游走，如示例 3-2 所示。为此，我们使用 Python 的无限 while True 循环，它总是评估为 True。这将使海龟不停地四处走动。要停止它，您可以点击海龟图形窗口中的 X。

*wander.py*

speed(0)

def wander():

while True:

fd(3)

如果 xcor() >= 200 或 xcor() <= -200 或 ycor() <= -200 或 ycor() >= 200:

lt(randint(90,180))

wander()

*清单 3-2：编写* wander.py *程序*

首先，我们将乌龟的速度设置为 0，即最快，然后定义 wander() 函数。在函数内我们使用无限循环，因此 while True 内的所有内容都会永远执行。然后乌龟向前走三步（或 3 像素），并通过条件语句评估它的位置。乌龟的 x 坐标和 y 坐标函数分别是 xcor() 和 ycor()。

使用 if 语句，我们告诉程序，如果任何一个条件判断为 True（即乌龟位于指定区域外），则让乌龟向左转一个随机角度，角度范围在 90 到 180 度之间，以防它偏离轨道。如果乌龟在矩形内，条件判断为 False，则不会执行任何代码。无论哪种情况，程序都会返回到 while True 循环的顶部，重新执行 fd(3)。

##### 运行 wander.py 程序

当你运行 *wander.py* 程序时，应该会看到类似 图 3-3 的内容。

![image](img/f043-01.jpg)

*图 3-3：* wander.py 的输出

正如你所看到的，乌龟沿着直线行走，直到它的 x 坐标达到 200。（乌龟总是从右侧开始沿着正 x 方向行走。）然后它向左转一个随机角度，角度范围在 90 到 180 度之间，再继续直行。有时乌龟会走出边界线，因为在 90 度转弯后，它仍然朝着屏幕外的方向行走，你会看到它在每个循环中都试图转回，重新进入矩形区域。这就造成了你在 图 3-3 中看到的矩形外的小块区域。

### 创建一个数字猜谜游戏

你成功地使用了条件语句创建了一个看似能自行做决策的乌龟！让我们使用条件语句来编写一个看起来像是有意识的互动数字猜谜程序。在这个游戏中，我会想一个介于 1 和 100 之间的数字，你来猜这个数字是多少。你觉得你需要多少次猜测才能正确猜出我的数字？为了缩小你的选择范围，在每次猜错之后，我会告诉你是该猜大一点还是小一点。幸运的是，我们可以使用在 第二章 中编写的平均值函数，让这个任务变得极其简单。

当你猜错时，你的下一次猜测应该根据你上次的猜测是否太低或太高来决定。例如，如果你的猜测太低，那么你的下一次猜测应该是你上次猜测和数字的最大值之间的中间值。如果你的猜测太高，那么你的下一次猜测应该是你上次猜测和数字的最小值之间的中间值。

这听起来像是计算两个数字的平均值——幸运的是我们有平均值函数！我们将利用它来编写 *numberGame.py* 程序，通过每次缩小一半可能的数字范围来进行智能猜测。你会惊讶于你能多快地找到答案。

让我们一步一步来，从制作一个随机数字生成器开始。

#### 制作随机数字生成器

首先，我们需要让计算机在 1 到 100 之间随机选择一个数字。创建一个新文件，在 IDLE 中保存为 *numberGame.py*，然后输入 Listing 3-3 中的代码。

*numberGame.py*

from random import randint

def numberGame():

#选择一个随机数字

#在 1 到 100 之间

number = randint(1,100)

*Listing 3-3：编写 numberGame() 函数*

在这里，我们导入 random 模块，并使用 randint() 函数将随机整数分配给一个变量。然后我们创建一个名为 number 的变量，它将保存一个 1 到 100 之间的随机数字，每次调用时都会生成新的数字。

#### 获取用户输入

现在程序需要要求用户输入，以便他们可以进行猜测！下面是一个你可以在交互式 shell 中输入的示例，看看 input() 函数是如何工作的：

>>> name = input("你的名字是什么？")

你的名字是什么？

程序在 shell 中打印文本“你的名字是什么？”，询问用户输入他们的名字。用户输入内容后按下 ENTER，程序保存该输入。

我们可以检查 Python 是否将用户输入保存到 name 变量中，如下所示：

你的名字是什么？ Peter

>>> print(name)

Peter

当我们要求程序打印名字时，它会打印保存在该变量中的用户输入（在本例中为 Peter）。

我们可以创建一个名为 greet() 的函数，稍后在程序中使用它：

def greet():

name = input("你的名字是什么？")

print("你好，",name)

greet()

输出将是以下内容：

>>>

你的名字是什么？ Al

你好，Al

>>>

尝试编写一个短程序，获取用户的名字作为输入，如果他们输入“Peter”，程序将打印“那也是我的名字！”如果名字不是“Peter”，程序将仅打印“你好”以及名字。

#### 将用户输入转换为整数

现在你知道如何处理用户输入的文本，但在我们的猜数字游戏中，我们将处理数字输入。在 第二章 中，你学习了基本的数据类型，比如整数和浮点数，它们可以用来执行数学运算。在 Python 中，所有用户输入的内容都会被当作 *字符串* 处理。这意味着，如果我们想要数字作为输入，就必须将它们转换为整数数据类型，以便可以进行运算。

要将字符串转换为整数，我们将输入传递给 int()，像这样：

print("我正在想一个 1 到 100 之间的数字。")

guess = int(input("你猜的数字是多少？"))

现在用户输入的任何内容都将被转换为 Python 可以操作的整数。

#### 使用条件语句检查是否猜对了

现在，*numberGame.py* 程序需要一种方法来检查用户猜测的数字是否正确。如果正确，我们将宣布猜测正确并结束游戏。否则，我们会告诉用户是应该猜更大还是更小。

我们使用 if 语句将输入与数字的内容进行比较，并使用 elif 和 else 来决定在每种情况下该做什么。将现有代码中的 *numberGame.py* 修改为 Listing 3-4 中的代码。

*number Game.py*

from random import randint

def numberGame():

#选择一个随机数字

#介于 1 和 100 之间

number = randint(1,100)

print("我正在想一个介于 1 和 100 之间的数字。")

guess = int(input("你的猜测是多少？"))

if number == guess:

print("正确！这个数字是", number)

elif number > guess:

print("不对。更大一些。")

else:

print("不对。更小一些。")

numberGame()

*Listing 3-4: 检查是否猜对了*

如果存储在 number 中的随机数等于存储在 guess 中的输入，我们会告诉用户他们的猜测是正确的，并打印出随机数。否则，我们会告诉用户他们是否需要猜更大或更小。如果他们猜的数字小于随机数，我们会告诉他们猜更大一些。如果他们猜的数字大于随机数，我们会告诉他们猜更小一些。

这是到目前为止的输出示例：

我正在想一个介于 1 和 100 之间的数字。

你的猜测是多少？50

不对。更大一些。

很好，但目前我们的程序到此为止，无法让用户继续猜测。我们可以使用循环来修复这个问题。

#### 使用循环再次猜测！

为了让用户可以再次猜测，我们可以创建一个循环，使程序持续要求更多的猜测，直到用户猜对为止。我们使用 while 循环不断循环，直到 guess 等于 number，然后程序会打印成功消息并跳出循环。用 Listing 3-4 中的代码替换 Listing 3-5 中的代码。

*number Game.py*

from random import randint

def numberGame():

#选择一个随机数字

#介于 1 和 100 之间

number = randint(1,100)

print("我正在想一个介于 1 和 100 之间的数字。")

guess = int(input("你的猜测是多少？"))

当猜测时：

if number == guess:

print("正确！这个数字是", number)

break

elif number > guess:

print("不对。更大一些。")

else:

print("不对。更小一些。")

guess = int(input("你的猜测是多少？"))

numberGame()

*Listing 3-5: 使用循环允许用户再次猜测*

在这个例子中，while guess 意味着“只要变量 guess 包含一个值”。首先，我们检查它选择的随机数是否等于猜测。如果是，程序会打印出猜测是正确的并跳出循环。如果数字大于猜测，程序会提示用户猜大一点。否则，它会打印出用户需要猜小一点。然后程序会接受下一个猜测并重新开始循环，允许用户猜多次直到得到正确答案。最后，在定义完函数后，我们写上 numberGame()来调用这个函数，这样程序就可以运行它。

#### 猜测提示

保存 *numberGame.py* 程序并运行它。每次你做出错误的猜测时，你的下一次猜测应该正好位于你的第一次猜测和范围内最接近的端点之间。例如，如果你开始时猜 50，而程序告诉你猜大一点，那么你的下一次猜测应该是 50 和范围顶部的 100 之间的中点，也就是猜 75。

这是到达正确数字的最有效方法，因为每次猜测都会消除一半可能的数字，无论猜测是太高还是太低。让我们看看猜一个 1 到 100 之间的数字需要多少次猜测。图 3-4 展示了一个示例。

![image](img/f047-01.jpg)

*图 3-4：数字猜测游戏的输出*

这次用了六次猜测。

让我们看看你可以将 100 乘以 0.5 多少次，直到得到一个小于 1 的数字：

>>> 100*0.5

50.0

>>> 50*0.5

25.0

>>> 25*0.5

12.5

>>> 12.5*0.5

6.25

>>> 6.25*0.5

3.125

>>> 3.125*0.5

1.5625

>>> 1.5625*0.5

0.78125

需要七次才能得到小于 1 的数字，因此平均来说，猜一个 1 到 100 之间的数字大约需要六到七次。这是因为每次猜测都会排除我们范围中的一半数字。这看起来可能不仅仅是一个数字猜测游戏的策略，但我们可以利用这个想法来找到一个非常准确的平方根值，接下来我们就这么做。

### 寻找平方根

你可以使用数字猜测游戏策略来逼近平方根。正如你所知道的，某些平方根可能是整数（比如 100 的平方根是 10）。但更多的平方根是*无理数*，它们是无止境、无重复的小数。在坐标几何中，当你需要找到多项式的根时，这种数字经常出现。

那么，我们怎么能利用这个数字猜测游戏的策略来找到平方根的准确值呢？你可以简单地使用平均法来计算平方根，精确到八位或九位小数。事实上，你的计算器或计算机使用类似数字猜测策略的迭代方法，来计算精确到 10 位小数的平方根！

#### 应用数字猜测游戏逻辑

例如，假设你不知道 60 的平方根。首先，你像在数字猜测游戏中一样，将选项缩小到一个范围。你知道 7 的平方是 49，8 的平方是 64，所以 60 的平方根一定在 7 和 8 之间。使用 average()函数，你可以计算 7 和 8 的平均值，得到 7.5，这就是你的第一次猜测。

>>> average(7,8)

7.5

为了检查 7.5 是否是正确的猜测，你可以将 7.5 平方，看看是否等于 60：

>>> 7.5**2

56.25

如你所见，7.5 的平方是 56.25。在我们的数字猜测游戏中，我们会被告知猜大一点，因为 56.25 小于 60。

因为我们需要猜大一点，所以我们知道 60 的平方根应该在 7.5 和 8 之间，于是我们取它们的平均值并输入新的猜测，像这样：

>>> average(7.5, 8)

7.75

现在我们检查 7.75 的平方，看它是否等于 60：

>>> 7.75**2

60.0625

太高了！所以平方根一定在 7.5 和 7.75 之间。

#### 编写 squareRoot() 函数

我们可以使用清单 3-6 中的代码来自动化这个过程。打开一个新的 Python 文件，并将其命名为 *squareRoot.py*。

*squareRoot.py*

def average(a,b):

return (a + b)/2

def squareRoot(num,low,high):

'''通过以下方式找到 num 的平方根

玩数字猜谜游戏

通过在范围内进行猜测的策略

范围从“低”到“高”'''

for i in range(20):

guess = average(low,high)

if guess**2 == num:

print(guess)

elif guess**2 > num: #"猜小一点。"

high = guess

else: #"猜大一点。"

low = guess

print(guess)

squareRoot(60,7,8)

*清单 3-6：编写 squareRoot() 函数*

这里，squareRoot()函数接受三个参数：num（我们想求平方根的数字）、low（num 的最小值限制）和 high（num 的最大值限制）。如果你猜的数字的平方等于 num，我们就打印出这个值并跳出循环。这种情况可能出现在整数的情况下，但不适用于无理数。记住，无理数是不会终止的！

接下来，程序会检查你猜的数字的平方是否大于目标数字，如果是，你应该猜小一点。我们通过将高值替换为猜测值，将范围缩小为从低值到猜测值。另一种可能性是猜测值太低，这时我们将范围缩小为从猜测值到高值，通过将低值替换为猜测值。

程序会按照我们设定的次数（在本例中为 20 次）重复这个过程，然后打印出近似的平方根。请记住，任何小数，无论长度多长，都只能近似一个无理数。但是我们仍然可以得到一个非常好的近似值！

在最后一行，我们调用 squareRoot() 函数，传入我们想要求平方根的数字，以及我们知道平方根一定在其中的低值和高值范围。我们的输出应该是这样的：

7.745966911315918

我们可以通过将其平方来找出我们的近似值有多接近：

>>> 7.745966911315918**2

60.00000339120106

这已经非常接近 60 了！是不是很惊讶，我们通过猜测和平均就能如此准确地计算出无理数？

练习 3-2：寻找平方根

找出这些数字的平方根：

+   200

+   1000

+   50000（提示：你知道平方根应该在 1 和 500 之间，对吧？）

### 摘要

在本章中，你学习了一些实用的工具，如算术运算符、列表、输入和布尔值，以及一个至关重要的编程概念——条件语句。这个概念的核心是我们可以让计算机自动、瞬时且反复地比较值并为我们做出选择，这非常强大。每种编程语言都有一种方法来实现这一点，在 Python 中我们使用 if、elif 和 else 语句。正如你将在本书中看到的，你将基于这些工具来解决更复杂的任务，以探索数学。

在下一章，你将练习迄今为止学到的工具，以快速高效地解决代数问题。你将使用数字猜测策略来解决具有多个解的复杂代数方程！你还将编写一个图形程序，以便更好地估算方程的解，并使你的数学探索更具视觉化！
