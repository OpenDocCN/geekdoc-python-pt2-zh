## 2

用列表和循环让枯燥的算术变得有趣

*“你是说我明天还得再去一遍？”—艾丹·法雷尔在第一天上学后*

![image](img/fintro-01.jpg)

大多数人在想到数学时，首先会想到算术：加法、减法、乘法和除法。尽管使用计算器和计算机做算术非常简单，但它仍然可能涉及许多重复性的任务。例如，使用计算器加 20 个不同的数字时，你必须输入+运算符 19 次！

本章中，你将学习如何使用 Python 自动化一些繁琐的算术部分。首先，你将了解数学运算符和 Python 中可以使用的不同数据类型。接着，你将学习如何使用变量存储和计算值。你还将学习如何使用列表和循环来重复代码。最后，你将结合这些编程概念，编写函数，自动执行复杂的计算。你将发现，Python 比任何你可以买到的计算器都更强大——最棒的是，它是免费的！

### 基本运算符

在交互式 Python shell 中做算术很简单：你只需输入表达式，按回车键即可进行计算。表 2-1 展示了一些最常见的数学运算符。

**表 2-1：** Python 中的常见数学运算符

| **运算符** | **语法** |
| --- | --- |
| 加法 | + |
| 减法 | – |
| 乘法 | * |
| 除法 | / |
| 指数 | ** |

打开你的 Python shell，并试着运行清单 2-1 中的一些基本算术。

>>> 23 + 56  #加法

79

>>> 45 * 89  #乘法使用星号

4005

>>> 46 / 13  #除法使用正斜杠

3.5384615384615383

>>> 2 ** 4   #2 的四次方

16

*清单 2-1：尝试一些基本的数学运算符*

结果应该显示为输出。你可以使用空格使代码更具可读性（6 + 5），也可以不使用空格（6+5），但在进行算术时，Python 不会因此有所不同。

请记住，Python 2 中的除法有点复杂。例如，Python 2 会将 46/13 当作整数运算，结果给你一个整数（3），而不是像清单 2-1 中那样返回小数值。由于你下载的是 Python 3，因此不会遇到这个问题。但我们稍后看到的图形包使用的是 Python 2，所以在进行除法时，我们必须确保要求返回小数。

#### 变量操作

你还可以对变量使用运算符。在第一章中，你学习了如何在定义函数时使用变量。就像代数中的变量一样，编程中的变量允许通过存储中间结果，将复杂的计算分解成多个阶段，这些结果可以在后续阶段再次使用。清单 2-2 展示了如何使用变量来存储数字并对其进行运算，无论它们的值是什么。

>>> x = 5

>>> x = x + 2

>>> length = 12

>>> x + length

19

*示例 2-2：将结果存储在变量中*

在这里，我们将值 5 赋给 x 变量，然后将其增加 2，因此 x 变成 7。接着，我们将值 12 赋给变量 length。当我们将 x 和 length 相加时，实际上是在加 7 + 12，因此结果是 19。

#### 使用运算符编写 average() 函数

让我们练习使用运算符来求一系列数字的平均值。正如你在数学课上学到的，求平均值的方法是将所有数字相加，然后除以数字的个数。例如，如果你的数字是 10 和 20，你就将 10 和 20 相加，然后将和除以 2，如下所示：

(10 + 20) / 2 = 15

如果你的数字是 9、15 和 23，你将它们加起来，然后将和除以 3：

(9 + 15 + 23) / 3 = 47 / 3 = 15.67

手动做这个可能会很麻烦，但用代码做就简单了。让我们开始编写一个名为 *arithmetic.py* 的 Python 文件，并编写一个函数来求两个数字的平均值。你应该能够运行该函数，并将两个数字作为参数传入，且不需要使用运算符，直接输出平均值，像这样：

>>> average(10,20)

15.0

让我们尝试一下。

#### 注意运算顺序！

我们的 average() 函数将两个数字 a 和 b 转换为它们和的一半，然后通过 return 关键字返回该值。以下是我们函数的代码：

*arithmetic.py*

def average(a,b):

return a + b / 2

我们定义了一个叫做 average() 的函数，要求输入两个数字 a 和 b。我们写下函数应返回这两个数字之和除以 2。然而，当我们在 shell 中测试函数时，得到了错误的输出：

>>> average(10,20)

20.0

这是因为我们在编写函数时没有考虑到*运算顺序*。正如你从数学课上可能记得的，乘法和除法优先于加法和减法，因此在这种情况下，除法会先进行。所以，这个函数先将 b 除以 2，然后*再*加上 a。那么我们该如何修复这个问题呢？

#### 使用运算符时的括号

我们需要使用括号告诉 Python 先加这两个数字，然后再除：

*arithmetic.py*

def average(a,b):

return (a + b) / 2

现在，函数应该先将 a 和 b 相加，再除以 2。下面是在 shell 中运行该函数时发生的情况：

>>> average(10,20)

15.0

如果你手动进行这个计算，可以看到输出是正确的！试试使用不同的数字来调用 average() 函数。

### Python 中的数据类型

在继续进行数字运算之前，让我们先了解一下 Python 中的一些基本数据类型。不同的数据类型具有不同的功能，你不能对所有数据类型执行相同的操作，因此了解每种数据类型的工作方式是非常重要的。

#### 整数和浮点数

你常见的 Python 数据类型有整数和浮点数。*整数*是没有小数部分的数字，*浮点数*是包含小数的数字。你可以使用 `float()` 和 `int()` 函数，分别将整数转换为浮点数，反之亦然，像这样：

>>> x = 3

>>> x

3

>>> y = float(x)

>>> y

3.0

>>> z = int(y)

>>> z

3

在这个例子中，我们使用 x = 3 将值 3 赋给变量 x。然后我们使用 float(x) 将 x 转换为浮点数，并将结果（3.0）赋给变量 y。最后，我们将 y 转换为整数，并将结果（3）赋给变量 z。这展示了你如何在浮点数和整数之间轻松转换。

#### 字符串

*字符串* 是有序的字母数字字符，可以是由字母组成的词，或者是数字。你可以通过将字符用单引号（''）或双引号（""）括起来来定义字符串，如下所示：

>>> a = "hello"

>>> a + a

'hellohello'

>>> 4*a

'hellohellohellohello'

这里，我们将字符串 "hello" 存储在变量 a 中。当我们将变量 a 与自身相加时，我们得到一个新的字符串，'hellohello'，它是两个 hello 的组合。请记住，你不能将字符串与数字数据类型（整数和浮点数）相加。如果你尝试将整数 2 和字符串 "hello" 相加，你会收到如下错误信息：

>>> b = 2

>>> b

2

>>> d = "hello"

>>> b + d

追溯（最近一次调用）：  

文件 "<pyshell#34>"，第 1 行，在 <module> 中

b + d

TypeError: 对 '+' 运算符的操作数类型不支持：'int' 和 'str'

然而，如果一个数字是字符串（或者被引号括起来），你可以将它与另一个字符串相加，如下所示：

>>> b = '123'

>>> c = '4'

>>> b + c

'1234'

>>> 'hello' + ' 123'

'hello 123'

在这个例子中，'123' 和 '4' 都是由数字组成的字符串，而不是数字数据类型。因此，当你将这两个字符串相加时，得到的是一个更长的字符串（'1234'），它是这两个字符串的组合。你也可以对字符串 'hello' 和 '123' 做同样的操作，尽管一个是字母组成，另一个是数字组成。将字符串连接起来形成一个新的字符串叫做 *连接*。

你还可以通过将字符串乘以一个整数来重复该字符串，如下所示：

>>> name = "Marcia"

>>> 3 * name

'MarciaMarciaMarcia'

但是你不能将字符串与另一个字符串进行减法、乘法或除法。输入以下内容到命令行中，看看会发生什么：

>>> noun = 'dog'

>>> verb = 'bark'

>>> noun * verb

追溯（最近一次调用）：  

文件 "<pyshell#6>"，第 1 行，在 <module> 中

noun * verb

TypeError: 无法将字符串类型与非整数类型相乘

正如你所看到的，当你尝试将 'dog' 和 'bark' 相乘时，出现了一个错误，提示你不能将两个字符串数据类型相乘。

#### 布尔值

*布尔值* 是表示真/假的值，意味着它们只能是“真”或“假”，没有中间状态。在 Python 中，布尔值必须大写，并且通常用于比较两个值。要比较值，你可以使用大于（>）和小于（<）符号，像这样：

>>> 3 > 2

True

因为 3 大于 2，这个表达式返回 True。但检查两个值是否相等需要两个等号（==），因为一个等号只是将一个值赋给变量。以下是一个示例：

>>> b

>>> b == 5

True

>>> b == 6

False

首先，我们使用一个等号将值 5 赋给变量 b。然后我们使用两个等号来检查 b 是否等于 5，这将返回 True。

#### 检查数据类型

您可以通过使用 type() 函数和变量来始终检查您正在处理的数据类型。Python 方便地告诉您变量中的值是什么数据类型。例如，让我们将一个布尔值赋给一个变量，就像这样：

>>> a = True

>>> type(a)

<class 'bool'>

当您将变量 a 传递给 type()函数时，Python 告诉您 a 中的值是布尔值。

尝试检查整数的数据类型：

>>> b = 2

>>> type(b)

<class 'int'>

以下检查 0.5 是否为浮点数：

>>> c = 0.5

>>> type(c)

<class 'float'>

此示例确认引号内的字母数字符号是一个字符串：

>>> name = "Steve"

>>> type(name)

<class 'str'>

现在您知道了 Python 中的不同数据类型以及如何检查您正在处理的值的数据类型，让我们开始自动化简单的算术任务。

### 使用列表存储值

到目前为止，我们使用变量来保存单个值。*列表*是一种可以保存多个值的变量类型，对于自动化重复任务非常有用。要在 Python 中声明列表，您只需创建列表的名称，像变量一样使用=命令，然后使用方括号[]将要放入列表中的项目括起来，用逗号分隔每个项目，像这样：

>>> a = [1,2,3]

>>> a

[1, 2, 3]

通常，创建一个空列表是很有用的，这样你就可以稍后添加值，比如数字、坐标和对象。要做到这一点，只需像通常那样创建列表，但不要添加任何值，如下所示：

>>> b = []

>>> b

[]

这将创建一个名为 b 的空列表，您可以在其中填充不同的值。让我们看看如何向列表添加内容。

#### 向列表添加项目

要向列表添加项目，请使用 append()函数，如下所示：

>>> b.append(4)

>>> b

[4]

首先，键入要添加到的列表（b）的名称，然后是一个句点，然后在括号内使用 append()来命名要添加的项目。您可以看到列表现在仅包含数字 4。

您还可以像这样向不为空的列表添加项目：

>>> b.append(5)

>>> b

[4, 5]

>>> b.append(True)

>>> b

[4, 5, True]

添加到现有列表中的项目将显示在列表末尾。如您所见，列表不仅限于数字。在这里，我们将布尔值 True 添加到包含数字 4 和 5 的列表中。

单个列表也可以包含多种数据类型。例如，您可以像这样将文本添加为字符串：

>>> b.append("hello")

>>> b

[4, 5, True, 'hello']

要添加字符串，您需要在文本周围包含双引号或单引号。否则，Python 将寻找一个名为 hello 的变量，这可能存在也可能不存在，从而导致错误或意外行为。现在列表 b 中有四个项目：两个数字、一个布尔值和一个字符串。

#### 操作列表

像字符串一样，你可以对列表使用加法和乘法运算符，但不能直接将数字与列表相加。相反，你需要通过连接来追加它。

例如，你可以像这样使用 + 操作符将两个列表相加：

>>> c = [7,True]

>>> d = [8,'Python']

>>> c + d  #将两个列表相加

[7, True, 8, 'Python']

我们也可以像这样将列表与数字相乘：

>>> 2 * d  #将列表与数字相乘

[8, 'Python', 8, 'Python']

如你所见，将数字 2 乘以列表 d 会将原始列表中的项数量加倍。

但是当我们尝试使用 + 操作符将一个数字和一个列表相加时，会出现一个叫做 TypeError 的错误：

>>> d + 2  #你不能将列表和整数相加

Traceback (most recent call last):

File "<pyshell#22>", line 1, in <module>

d + 2

TypeError: 只能将列表（而不是 "int"）与列表连接

这是因为你不能使用加号将数字与列表相加。虽然你可以将两个列表相加，向列表中追加项，甚至将列表乘以一个数字，但你只能将一个列表与另一个列表连接。

#### 从列表中移除项

从列表中移除项非常简单：你可以使用 remove() 函数，并将你想移除的项作为参数，如下所示。确保准确地引用你要删除的项，否则 Python 将无法理解要删除什么。

>>> b = [4,5,True,'hello']

>>> b.remove(5)

>>> b

[4, True, 'hello']

在这个例子中，b.remove(5) 从列表中移除了 5，但注意其余的项保持原有顺序。保持顺序这一点在后续会变得非常重要。

### 在循环中使用列表

在数学中，通常需要对多个数字执行相同的操作。例如，一本代数书可能会定义一个函数，并要求你将多个不同的数字代入该函数。你可以通过将这些数字存储在列表中，然后使用你在第一章中学到的 for 循环，在列表的每一项上执行相同的操作来实现。记住，当你重复执行某个操作时，这叫做 *迭代*。迭代器是 for i in range(10) 中的变量 i，我们在之前的程序中用过，但它不一定非要叫做 i；它可以被称为你想要的任何名字，正如这个例子中所示：

>>> a = [12,"apple",True,0.25]

>>> for thing in a:

print(thing)

12

apple

True

0.25

在这个例子中，迭代器被称为 thing，它将 print() 函数应用到列表 a 中的每一项。注意，项是按顺序打印的，每一项都在新的一行。要在同一行打印所有内容，你需要在 print() 函数中添加一个 end 参数，并传入一个空字符串，像这样：

>>> for thing in a:

print(thing, end='')

12appleTrue0.25

这会将所有项目打印在同一行，但所有值会连在一起，导致很难区分它们。end 参数的默认值是换行符，正如你在前面的例子中看到的那样，但你可以通过在引号中插入任何字符或标点符号来插入自己想要的分隔符。这里我添加了逗号：

>>> a = [12,"apple",True,0.25]

>>> for thing in a:

print(thing, end=',')

12,apple,True,0.25,

现在每个项目都由逗号分隔，这样更容易阅读。

#### 通过列表索引访问单个项目

你可以通过指定列表的名称并在方括号中输入索引来引用列表中的任何元素。*索引*是项目在列表中的位置或编号。列表的第一个索引是 0。索引使我们能够使用有意义的名称存储一系列值，并在程序中轻松访问它们。试试这段代码，看看索引的实际效果：

>>> name_list = ['Abe','Bob','Chloe','Daphne']

>>> score_list = [55,63,72,54]

>>> print(name_list[0], score_list[0])

Abe 55

索引也可以是变量或迭代器，如下所示：

>>> n = 2

>>> print(name_list[n], score_list[n+1])

Chloe 54

>>> for i in range(4):

print(name_list[i], score_list[i])

Abe 55

Bob 63

Chloe 72

Daphne 54

#### 使用 enumerate() 访问索引和值

要同时获取列表中项目的索引和值，你可以使用一个方便的函数叫做 enumerate()。它是这样工作的：

>>> name_list = ['Abe','Bob','Chloe','Daphne']

>>> for i, name in enumerate(name_list):

print(name,"has index",i)

Abe 的索引是 0

Bob 的索引是 1

Chloe 的索引是 2

Daphne 的索引是 3

这里，name 是列表中项目的值，而 i 是索引。使用 enumerate() 时需要记住的重要一点是，索引在前，值在后。稍后我们会看到，当我们将对象放入列表中并访问每个对象及其精确位置时，这一点非常重要。

#### 索引从零开始

在 第一章中，你学到过 range(n) 函数会生成一个从 0 开始并一直到（但不包含）n 的数字序列。同样，列表的索引也从 0 开始，而不是 1，所以第一个元素的索引是 0。试试下面的代码，看看它是如何工作的：

>>> b = [4,True,'hello']

>>> b[0]

4

>>> b[2]

'hello'

这里，我们创建了一个名为 b 的列表，然后让 Python 显示列表 b 中索引为 0 的项目，也就是第一个位置。因此我们得到 4。当我们请求列表 b 中索引为 2 的项目时，我们得到 'hello'。

#### 访问列表项目的范围

你可以在括号内使用 range (:) 语法来访问列表中一系列的元素。例如，要返回从列表的第二个项目到第六个项目，可以使用以下语法：

>>> myList = [1,2,3,4,5,6,7]

>>> myList[1:6]

[2, 3, 4, 5, 6]

需要注意的是，1:6 的范围语法包含该范围内的*第一个*索引 1，但*不包含*最后一个索引 6。这意味着范围 1:6 实际上会给我们返回索引为 1 到 5 的项目。

如果你没有指定范围的结束索引，Python 默认使用列表的长度。它默认返回从第一个索引到列表末尾的所有元素。例如，你可以使用以下语法访问列表 b 从第二个元素（索引 1）到列表末尾的所有元素：

>>> b[1:]

[True, 'hello']

如果你没有指定起始位置，Python 默认从列表中的第一个项目开始，并且不会包括结束索引，如下所示：

>>> b[:1]

[4]

在这个例子中，b[:1] 包含了第一个项目（索引 0），但不包括索引为 1 的项目。一个非常有用的知识是，即使你不知道列表有多长，也可以使用负数来访问列表中的最后几个项目。要访问最后一个项目，你可以使用 -1，要访问倒数第二个项目，你可以使用 -2，像这样：

>>> b[-1]

'hello'

>>> b[-2]

True

当你使用别人创建的列表或处理非常长的列表时，知道如何访问最后几个元素会非常有用，这样你就不需要记住所有的索引位置。

#### 查找项目的索引

如果你知道某个值在列表中，但不知道它的索引，你可以通过给出列表名，接着使用 `index` 函数，并将你要查找的值作为参数放在括号内，来查找它的位置。在命令行中创建列表 c，如下所示，并尝试以下操作：

>>> c = [1,2,3,'hello']

>>> c.index(1)

0

>>> c.index('hello')

3

>>> c.index(4)

Traceback (most recent call last):

文件 "<pyshell#85>"，第 1 行，在 <module> 中

b.index(4)

ValueError: 4 不在列表中

你可以看到，查询值 1 返回了索引 0，因为它是列表中的第一个项目。当你查询 'hello' 的索引时，返回的是 3。然而，最后一次尝试会导致错误信息。从错误信息的最后一行可以看出，错误的原因是我们要找的值 4 不在列表中，所以 Python 无法返回它的索引。

要检查一个项目是否存在于列表中，使用 `in` 关键字，如下所示：

>>> c = [1,2,3,'hello']

>>> 4 in c

False

>>> 3 in c

True

这里，如果项目在列表中，Python 会返回 True，如果项目不在列表中，则返回 False。

#### 字符串也使用索引

你在学习列表索引时学到的所有内容同样适用于字符串。一个字符串有一个长度，字符串中的所有字符都有索引。请输入以下内容到命令行，看看它是如何工作的：

>>> d = 'Python'

>>> len(d) # 'Python' 中有多少个字符？

6

>>> d[0]

'P'

>>> d[1]

'y'

>>> d[-1]

'n'

>>> d[2:]

'thon'

>>> d[:5]

'Pytho'

>>> d[1:4]

'yth'

这里，你可以看到字符串 'Python' 由六个字符组成。每个字符都有一个索引，你可以使用与列表相同的语法来访问它们。

### 求和

当你在一个循环中添加多个数字时，跟踪这些数字的运行总和是很有用的。保持这样的运行总和是一个重要的数学概念，叫做 *求和*。

在数学课上，你经常看到求和符号与大写希腊字母 *S*（表示和）关联。符号如下所示：

![Image](img/e032-01.jpg)

求和符号表示你从最小值（在 sigma 下方列出）开始，直到最大值（在 sigma 上方列出），将 *n* 替换为 *i*。与 Python 的 range(n) 不同，求和符号包括最大值。

#### 创建 RUNNING_SUM 变量

要在 Python 中编写求和程序，我们可以创建一个名为 running_sum 的变量（sum 已经是 Python 内置的函数）。我们将其初始值设置为零，然后每次添加一个值时递增 running_sum 变量。为此，我们再次使用 += 符号。在命令行中输入以下内容以查看示例：

>>> running_sum = 0

>>> running_sum += 3

>>> running_sum

3

>>> running_sum += 5

>>> running_sum

8

你学会了如何使用 += 命令作为快捷方式：使用 running_sum += 3 与 running_sum = running_sum + 3 是等效的。让我们通过多次递增 running_sum 来测试一下。为此，请在 *arithmetic.py* 程序中添加以下代码：

*arithmetic.py*

running_sum = 0

➊ for i in range(10):

➋    running_sum += 3

print(running_sum)

我们首先创建一个初始值为 0 的 running_sum 变量，然后使用 range(10) 运行 10 次 for 循环 ➊。循环的缩进部分在每次运行循环时将 3 加到 running_sum 的值上 ➋。当循环执行 10 次后，Python 会跳转到代码的最后一行，这一行是打印语句，用于显示 10 次循环结束时 running_sum 的值。

从中，你可能能够推算出最终的总和，以下是输出：

30

换句话说，10 乘以 3 等于 30，所以输出是合理的！

#### 编写 MYSUM() 函数

让我们将求和程序扩展为一个名为 mySum() 的函数，它接受一个整数作为参数，并返回从 1 到指定数字的所有数字之和，如下所示：

>>> mySum(10)

55

首先，我们声明 running_sum 的值，然后在循环中递增它：

*arithmetic.py*

def mySum(num):

running_sum = 0

for i in range(1,num+1):

running_sum += i

return running_sum

为了定义 mySum() 函数，我们从 0 开始运行总和。然后我们为 i 设置一个值范围，从 1 到 num。请注意，range(1,num) 不包括 num 本身！接着我们在每次循环后将 i 加到 running_sum 中。当循环完成时，应该返回 running_sum 的值。

在命令行中用更大的数字运行该函数。它应该能够快速返回从 1 到该数字的所有数字之和：

>>> mySum(100)

5050

非常方便！要解决我们之前提到的更复杂的 sigma 问题，只需将循环从 0 改为 20（包括 20），并在每次循环中加上 i 的平方加 1：

*arithmetic.py*

def mySum2(num):

running_sum = 0

for i in range(num+1):

running_sum += i**2 + 1

return running_sum

我修改了循环，使其从 0 开始，就像西格玛表示法所指示的那样：

![Image](img/e033-01.jpg)

当我们运行这个时，我们得到如下结果：

>>> mySum2(20)

2891

练习 2-1：求和

找出从 1 到 100 的所有数字的和。那从 1 到 1,000 呢？你看到了什么规律吗？

### 求一组数字的平均值

现在你掌握了一些新技能，让我们改进我们的平均函数。我们可以编写一个函数，利用列表来计算任何数字列表的平均值，而无需我们指定数字的数量。

在数学课上，你学到要找出一组数字的平均值，你需要将这些数字的总和除以数字的数量。在 Python 中，你可以使用一个名为 sum()的函数来将列表中的所有数字加起来，像这样：

>>> sum([8,11,15])

34

现在我们只需要找出列表中元素的个数。在本章前面编写的 average()函数中，我们知道只有两个数字。但如果有更多呢？幸运的是，我们可以使用 len()函数来计算列表中元素的数量。以下是一个示例：

>>> len([8,11,15])

3

如你所见，你只需输入函数并将列表作为参数传入。这意味着我们可以同时使用 sum()和 len()函数，通过将列表的总和除以列表的长度来找到列表中项的平均值。使用这些内置关键字，我们可以创建一个简洁的平均函数版本，代码如下：

*arithmetic.py*

def average3(numList):

return sum(numList)/len(numList)

当你在命令行中调用该函数时，你应该会得到以下输出：

>>> average3([8,11,15])

11.333333333333334

这个版本的平均函数的好处是，它既适用于短列表，也适用于长列表的数字！

练习 2-2：求平均值

找出以下列表中数字的平均值：

d = [53, 28, 54, 84, 65, 60, 22, 93, 62, 27, 16, 25, 74, 42, 4, 42,

15, 96, 11, 70, 83, 97, 75]

### 总结

在本章中，你学习了整数、浮点数和布尔值等数据类型。你学会了创建列表，添加和删除列表中的元素，并使用索引找到列表中的特定项。然后，你学会了如何使用循环、列表和变量来解决算术问题，比如计算一组数字的平均值和保持累积和。

在下一章，你将学习条件语句，这是你学习本书其余部分时需要掌握的另一个重要编程概念。
