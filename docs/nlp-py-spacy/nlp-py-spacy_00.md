## **简介**

![Image](../Images/fm0xv.jpg)

现在，当你打电话给银行或互联网服务提供商时，可能会在电话另一端听到类似以下内容：“你好，我是你的数字助手。请提问。”如今，机器人可以使用自然语言与人类对话，而且它们变得越来越智能。然而，仍然很少有人理解这些机器人是如何工作的，或者他们如何在自己的项目中使用这些技术。

自然语言处理（NLP）——一种帮助机器理解并回应人类语言的人工智能分支——是任何数字助手产品核心技术的关键。本书将为你提供开始创建自己 NLP 应用所需的技能。在本书结束时，你将了解如何将 NLP 方法应用于现实世界问题，例如分析句子、捕捉文本意义、创作原创文本，甚至构建你自己的聊天机器人。

### **使用 Python 进行自然语言处理**

如果你想开发一个 NLP 应用，你可以从众多工具和技术中进行选择。本书中的所有示例都使用 Python 代码实现，并采用 Python 的 spaCy NLP 库。以下是你可能希望选择 Python 和 spaCy 进行 NLP 开发的一些有力理由。

Python 是一种高级编程语言，具有以下特点：

**简易性** 如果你是编程新手，Python 是一个非常好的入门语言，因为它极其容易学习。由于其简洁性，Python 使你能够编写其他人容易理解的代码。例如，Python 的简易性帮助聊天机器人开发者与那些没有太多编程经验的语言学家进行合作。

**普及性** Python 是最受欢迎的编程语言之一。绝大多数广泛使用的 API 都有 Python 的包装器，你可以通过 pip 安装工具轻松安装。通过 pip 安装 Python 包装器的能力简化了获取你在 NLP 应用中可能需要使用的第三方工具的过程。

**在 AI 生态系统中的重要地位** 在 AI 生态系统中，有许多可用的 Python 库。这些库的存在简化了你开发 NLP 应用程序的过程，让你可以在多个库中进行选择，以最适合的方式解决特定任务。

### **spaCy 库**

本书使用了 spaCy，这是一款流行的 Python 库，包含了处理自然语言文本所需的语言数据和算法。正如本书中所介绍的，spaCy 易于使用，因为它提供了表示自然语言文本元素（如句子和单词）的容器对象。这些对象又具有表示语言学特征的属性，例如词性。截止目前，spaCy 提供了适用于英语、德语、希腊语、西班牙语、法语、意大利语、立陶宛语、挪威博克马尔语、荷兰语、葡萄牙语以及多种语言组合的预训练模型。此外，spaCy 提供了内置的可视化工具，可以通过编程调用，生成句子的句法结构图或文档中的命名实体图。

spaCy 库本身也原生支持其他流行的 Python NLP 库所不具备的高级 NLP 特性。例如，spaCy 原生支持词向量（详见[第 5 章](../Text/ch05.xhtml#ch05)），而不像自然语言工具包（NLTK）。使用后者时，您需要使用像 Gensim 这样的第三方工具，这是 word2vec 算法的 Python 实现。

使用 spaCy，您可以自定义现有模型或单个模型组件，也可以从头开始训练自己的模型，以满足您的应用需求（您将在[第 10 章](../Text/ch10.xhtml#ch10)学习如何实现）。您还可以将由其他流行的*机器学习（ML）*库（如 TensorFlow、Keras、scikit-learn 和 PyTorch）训练的统计模型连接到 spaCy。此外，spaCy 可以与 Python 的 AI 生态系统中的其他库无缝协作，例如，您可以在聊天机器人应用程序中利用计算机视觉，就像您将在[第 12 章](../Text/ch12.xhtml#ch12)中实现的那样。

### **谁应该阅读本书？**

本书适合那些有兴趣学习如何在实践中使用 NLP 的人。特别是，对于那些想为企业或单纯为了娱乐开发聊天机器人的人，本书可能会很有趣。无论您是否具备 NLP 或编程的背景或经验，您都能跟随本书中的代码示例，因为每个示例都包括了详细的过程解释。

有一定的 Python 基础将会有所帮助，因为本书不会涵盖 Python 语法的基础内容。此外，示例假设读者具有一定的英语语法和句法基础。附录部分是一些不太常见的语言学概念的参考。如果您对 NLP 概念有较好的理解，并且具备一些基本编程能力，那么这些示例将更易于理解。

### **本书内容有哪些？**

*Python与spaCy的自然语言处理* 从对处理和分析自然语言数据所使用的NLP技术的基本元素和方法的简要介绍开始。接着，它介绍了越来越复杂的技术，这些技术可以帮助你处理自然语言对计算机处理和分析所带来的复杂挑战。每一章的“尝试一下”部分将帮助你巩固刚刚学到的内容。

下面是每一章的内容：

**[第1章](../Text/ch01.xhtml#ch01): [自然语言处理如何工作](../Text/ch01.xhtml#ch01)** 简要介绍了NLP技术的基本元素。它描述了生成NLP库（如spaCy）数据的机器学习技术，包括统计语言建模和用于解决NLP问题的统计神经网络模型。接着，介绍了NLP应用开发者所面临的任务和挑战。

**[第2章](../Text/ch02.xhtml#ch02): [文本处理管道](../Text/ch02.xhtml#ch02)** 解释了spaCy是什么，以及它的设计目的，并展示了如何快速上手。它涵盖了工作环境的设置以及如何使用文本处理管道进行编码，管道是一系列基本的NLP操作，用于确定话语的意义和意图。

**[第3章](../Text/ch03.xhtml#ch03): [与容器对象协作及定制spaCy](../Text/ch03.xhtml#ch03)** 介绍了spaCy的架构，重点讲解了库中提供的核心数据结构。通过跟随示例，你将获得使用spaCy关键对象的实际经验。你还将学会如何定制管道组件，以满足应用需求。

**[第4章](../Text/ch04.xhtml#ch04): [提取和使用语言特征](../Text/ch04.xhtml#ch04)** 讲解了如何提取语言特征，例如依存标签、词性标签和命名实体。你将学会生成并沿着句子的依存树向上遍历，探索句法关系。通过这一过程，你将学会如何编程与聊天机器人用户继续对话、压缩长文本以及完成其他有用的任务。

**[第5章](../Text/ch05.xhtml#ch05): [使用词向量](../Text/ch05.xhtml#ch05)** 解释了spaCy的模型如何将自然语言单词映射到实数向量，从而实现与单词的数学运算。你将学会如何使用spaCy的相似度方法，通过比较容器对象的词向量来确定它们意义的接近程度。

**[第6章](../Text/ch06.xhtml#ch06): [寻找模式和遍历依赖树](../Text/ch06.xhtml#ch06)** 深入探讨了意义提取、句法依赖解析、名词短语提取和实体识别的细节。你将完成从原始文本中提取意义所需的所有步骤，使用词序列模式和遍历依赖树。本章介绍了spaCy的Matcher工具来寻找模式，并讨论了在某些情况下你可能仍需要依赖上下文来确定适当的处理方法。

**[第7章](../Text/ch07.xhtml#ch07): [可视化](../Text/ch07.xhtml#ch07)** 讨论了如何利用spaCy内置的displaCy可视化工具，你可以用它在浏览器中可视化句法依赖关系和命名实体。可视化能够帮助你立即识别数据中的模式。

**[第8章](../Text/ch08.xhtml#ch08): [意图识别](../Text/ch08.xhtml#ch08)** 演示了意图提取，这是聊天机器人开发中常见的任务。你将学习如何从文本数据中提取意义，这通常是一个具有挑战性的任务，但在Python中只需几行代码即可完成。

**[第9章](../Text/ch09.xhtml#ch09): [将用户输入存储到数据库中](../Text/ch09.xhtml#ch09)** 教你如何自动从用户输入中提取关键词并将其存储到关系型数据库中，之后你可以使用这些数据来填写订单表格或其他商业文档。

**[第10章](../Text/ch10.xhtml#ch10): [训练模型](../Text/ch10.xhtml#ch10)** 讲解如何训练spaCy的命名实体识别器和句法依赖解析器，以满足你应用中spaCy默认模型未涵盖的需求。内容详细介绍了如何使用新的示例训练一个已经预训练的模型，以及如何从零开始训练一个空白模型。

**[第11章](../Text/ch11.xhtml#ch11): [部署你自己的聊天机器人](../Text/ch11.xhtml#ch11)** 带你了解如何将你的聊天机器人应用部署到流行的即时通讯服务Telegram上，以便它能够通过互联网与用户互动。

**[第12章](../Text/ch12.xhtml#ch12): [实现Web数据和处理图像](../Text/ch12.xhtml#ch12)** 展示了你的聊天机器人如何使用spaCy及Python AI生态系统中的其他库，从维基百科中提取问题的答案，并对用户提交的图像做出反应。

**[附录](../Text/app01.xhtml#app01): [语言学基础](../Text/app01.xhtml#app01)** 包含一本简要的语言学语法和句法元素指南，书中最常讨论的内容。没有语言学背景的读者可以将其作为参考。
